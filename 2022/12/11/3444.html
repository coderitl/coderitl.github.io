<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <title>权限通用项目 | coder-itl</title>
  <meta name="author" content="coder-itl">
  <meta name="copyright" content="coder-itl">
  <meta name="format-detection" content="telephone=no">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="权限通用项目Maven-聚合工程 guigu-auth-parent: 根目录,管理子模块  common:公共类父模块 common-log: 系统操作日志模块 common-util: 核心工具类 service-util: service模块工具类 spring-security业务模块   model: 实体类模块 service-system: 系统权限模块     目录结构">
  <meta property="og:type" content="article">
  <meta property="og:title" content="权限通用项目">
  <meta property="og:url" content="https://coderitl.github.io/2022/12/11/3444.html">
  <meta property="og:site_name" content="coder-itl">
  <meta property="og:description" content="权限通用项目Maven-聚合工程 guigu-auth-parent: 根目录,管理子模块  common:公共类父模块 common-log: 系统操作日志模块 common-util: 核心工具类 service-util: service模块工具类 spring-security业务模块   model: 实体类模块 service-system: 系统权限模块     目录结构">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:image" content="https://cdn.jsdelivr.net/gh/coderitl/hiddenContent@v1.0.4/re-4.jpg">
  <meta property="article:published_time" content="2022-12-11T02:49:39.000Z">
  <meta property="article:modified_time" content="2023-06-22T11:51:59.478Z">
  <meta property="article:author" content="coder-itl">
  <meta property="article:tag" content="coder-itl,Java,HTML+CSS,Hexo,MYSQL">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/coderitl/hiddenContent@v1.0.4/re-4.jpg">
  <link rel="shortcut icon" href="https://img-blog.csdnimg.cn/f44f454681b440f3a8ae5f086d3c07d9.png">
  <link rel="canonical" href="https://coderitl.github.io/2022/12/11/3444.html">
  <link rel="preconnect" href="//cdn.jsdelivr.net">
  <link rel="preconnect" href="//busuanzi.ibruce.info">
  <link rel="stylesheet" href="/css/index.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'">
  <script>
    const GLOBAL_CONFIG = {
      root: '/',
      algolia: undefined,
      localSearch:
      {
        "path": "/search.xml",
        "preload": false,
        "languages":
        {
          "hits_empty": "找不到您查询的内容：${query}"
        }
      },
      translate: undefined,
      noticeOutdate: undefined,
      highlight:
      {
        "plugin": "highlighjs",
        "highlightCopy": true,
        "highlightLang": false,
        "highlightHeightLimit": false
      },
      copy:
      {
        success: '复制成功',
        error: '复制错误',
        noSupport: '浏览器不支持'
      },
      relativeDate:
      {
        homepage: false,
        post: false
      },
      runtime: '',
      date_suffix:
      {
        just: '刚刚',
        min: '分钟前',
        hour: '小时前',
        day: '天前',
        month: '个月前'
      },
      copyright: undefined,
      lightbox: 'fancybox',
      Snackbar: undefined,
      source:
      {
        justifiedGallery:
        {
          js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
          css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
        }
      },
      isPhotoFigcaption: false,
      islazyload: true,
      isAnchor: false,
      percent:
      {
        toc: true,
        rightside: false,
      }
    }

  </script>
  <script id="config-diff">
    var GLOBAL_CONFIG_SITE = {
      title: '权限通用项目',
      isPost: true,
      isHome: false,
      isHighlightShrink: false,
      isToc: true,
      postUpdate: '2023-06-22 19:51:59'
    }

  </script><noscript>
    <style type="text/css">
      #nav
      {
        opacity: 1
      }

      .justified-gallery img
      {
        opacity: 1
      }

      #recent-posts time,
      #post-meta time
      {
        display: inline !important
      }

    </style>
  </noscript>
  <script>
    (win =>
    {
      win.saveToLocal = {
        set: function setWithExpiry(key, value, ttl)
        {
          if (ttl === 0) return
          const now = new Date()
          const expiryDay = ttl * 86400000
          const item = {
            value: value,
            expiry: now.getTime() + expiryDay,
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
        get: function getWithExpiry(key)
        {
          const itemStr = localStorage.getItem(key)
          if (!itemStr)
          {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = new Date()
          if (now.getTime() > item.expiry)
          {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
      win.getScript = url => new Promise((resolve, reject) =>
      {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function ()
        {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(script)
      })
      win.getCSS = url => new Promise((resolve, reject) =>
      {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        link.onload = () => resolve()
        link.onerror = () => reject()
        document.head.appendChild(link)
      })
      win.activateDarkMode = function ()
      {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null)
        {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function ()
      {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null)
        {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
      if (t === 'dark') activateDarkMode()
      else if (t === 'light') activateLightMode()
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined)
      {
        if (asideStatus === 'hide')
        {
          document.documentElement.classList.add('hide-aside')
        }
        else
        {
          document.documentElement.classList.remove('hide-aside')
        }
      }
      const detectApple = () =>
      {
        if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent))
        {
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)

  </script>
  <link rel="stylesheet" href="/css/modify.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css" media="defer" onload="this.media='all'">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/coderitl/FileJsDeliver@v1.1.12/css/gitcalendar.css" media="defer" onload="this.media='all'">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/coderitl/FileJsDeliver@v1.1.13/swiper/swiper.min.css" media="defer" onload="this.media='all'">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/coderitl/FileJsDeliver@v1.1.13/swiper/swiperstyle.css" media="defer" onload="this.media='all'">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/animate-css/animate.css@3.7.2/animate.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css" media="defer">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/coderitl/globalfont@v0.0.4/my.css">
  <link rel="stylesheet" href="/css/my.css">
  <meta name="referrer" content="no-referrer"><!-- hexo injector head_end start -->
  <style>
    body hanla:after
    {
      content: ' ';
      display: inline;
      font-family: inherit;
      font-size: 0.45em;
    }

    html code hanla,
    html pre hanla,
    html kbd hanla,
    html samp hanla,
    html ruby hanla,
    html .tag-list-item hanla
    {
      display: none;
    }

    html ol>hanla,
    html ul>hanla
    {
      display: none;
    }

  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css">
  <style>
    #recent-posts>.recent-post-item>.recent-post-info>.article-meta-wrap>.tags:before
    {
      content: "\A";
      white-space: pre;
    }

    #recent-posts>.recent-post-item>.recent-post-info>.article-meta-wrap>.tags>.article-meta__separator
    {
      display: none
    }

  </style>
  <link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'">
  <link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'">
  <link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'">
  <link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'">
  <link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'">
  <script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end -->
  <meta name="generator" content="Hexo 5.4.2">
  <link rel="alternate" href="/atom.xml" title="coder-itl" type="application/atom+xml">
</head>

<body>
  <div id="loading-box">
    <div class="loading-left-bg"></div>
    <div class="loading-right-bg"></div>
    <div class="spinner-box">
      <div class="configure-border-1">
        <div class="configure-core"></div>
      </div>
      <div class="configure-border-2">
        <div class="configure-core"></div>
      </div>
      <div class="loading-word">加载中...</div>
    </div>
  </div>
  <script>
    const preloader = {
      endLoading: () =>
      {
        document.body.style.overflow = 'auto';
        document.getElementById('loading-box').classList.add("loaded")
      },
      initLoading: () =>
      {
        document.body.style.overflow = '';
        document.getElementById('loading-box').classList.remove("loaded")
      }
    }
    window.addEventListener('load', () =>
    {
      preloader.endLoading()
    })
    if (true)
    {
      document.addEventListener('pjax:send', () =>
      {
        preloader.initLoading()
      })
      document.addEventListener('pjax:complete', () =>
      {
        preloader.endLoading()
      })
    }

  </script>
  <div id="web_bg"></div>
  <div id="sidebar">
    <div id="menu-mask"></div>
    <div id="sidebar-menus">
      <div class="avatar-img is-center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://i.328888.xyz/2023/03/19/MJUXa.jpeg" onerror="onerror=null;src='https://i.328888.xyz/2023/03/20/P3kfC.gif'" alt="avatar"></div>
      <div class="sidebar-site-data site-data is-center"><a href="/archives/">
          <div class="headline">
            <hanla></hanla>文章<hanla></hanla>
          </div>
          <div class="length-num">119</div>
        </a><a href="/tags/">
          <div class="headline">
            <hanla></hanla>标签<hanla></hanla>
          </div>
          <div class="length-num">21</div>
        </a><a href="/categories/">
          <div class="headline">
            <hanla></hanla>分类<hanla></hanla>
          </div>
          <div class="length-num">13</div>
        </a></div>
      <hr>
      <div class="menus_items">
        <div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div>
        <div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div>
        <div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div>
        <div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div>
        <div class="menus_item"><a class="site-page" href="/Timeline/"><i class="fa-fw fab fa-docker"></i><span> 日志</span></a></div>
        <div class="menus_item"><a class="site-page" href="/Java-%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/"><i class="fa-fw fas fa-link"></i><span> 学习路线</span></a></div>
        <div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于<hanla></hanla></span></a></div>
      </div>
    </div>
  </div>
  <div class="post" id="body-wrap">
    <header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/coderitl/hiddenContent@v1.0.4/re-4.jpg')">
      <nav id="nav"><span id="blog-info"><a href="/" title="coder-itl"><span class="site-name">coder-itl</span></a></span>
        <div id="menus">
          <div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div>
          <div class="menus_items">
            <div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div>
            <div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div>
            <div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div>
            <div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div>
            <div class="menus_item"><a class="site-page" href="/Timeline/"><i class="fa-fw fab fa-docker"></i><span> 日志</span></a></div>
            <div class="menus_item"><a class="site-page" href="/Java-%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/"><i class="fa-fw fas fa-link"></i><span> 学习路线</span></a></div>
            <div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div>
          </div>
          <div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div>
        </div>
      </nav>
      <div id="post-info">
        <h1 class="post-title">权限通用项目</h1>
        <div id="post-meta">
          <div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于<hanla></hanla></span><time class="post-meta-date-created" datetime="2022-12-11T02:49:39.000Z" title="发表于 2022-12-11 10:49:39">2022-12-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于<hanla></hanla></span><time class="post-meta-date-updated" datetime="2023-06-22T11:51:59.478Z" title="更新于 2023-06-22 19:51:59">2023-06-22</time></span></div>
          <div class="meta-secondline"><span class="post-meta-separator">|</span><span id="" data-flag-title="权限通用项目"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div>
        </div>
      </div>
    </header>
    <main class="layout" id="content-inner">
      <div id="post"><div class="top-img" style="background-image: url('https://cdn.jsdelivr.net/gh/coderitl/hiddenContent@v1.0.4/re-4.jpg');"></div>
        <article class="post-content" id="article-container">
          <meta name="referrer" content="no-referrer">
          <h3 id="权限通用项目"><a href="#权限通用项目" class="headerlink" title="权限通用项目"></a>
            <hanla></hanla>权限通用项目<hanla></hanla>
          </h3>
          <h4 id="Maven-聚合工程"><a href="#Maven-聚合工程" class="headerlink" title="Maven-聚合工程"></a>Maven-聚合工程</h4>
          <ul>
            <li>
              <p><code>guigu-auth-parent</code>: 根目录,<hanla></hanla>管理子模块</p>
              <ul>
                <li><code>common</code>:<hanla></hanla>公共类父模块<ul>
                    <li><code>common-log</code>: 系统操作日志模块</li>
                    <li><code>common-util</code>: 核心工具类</li>
                    <li><code>service-util</code>: <code>service</code>
                      <hanla></hanla>模块工具类
                    </li>
                    <li><code>spring-security</code>
                      <hanla></hanla>业务模块
                    </li>
                  </ul>
                </li>
                <li><code>model</code>: 实体类模块</li>
                <li><code>service-system</code>: 系统权限模块</li>
              </ul>
              <table>
                <thead>
                  <tr>
                    <th align="center">目录结构</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/3b9909c11d7f4198bcc161aaee315238.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
          </ul>
          <h4 id="Knife4j"><a href="#Knife4j" class="headerlink" title="Knife4j"></a>Knife4j</h4>
          <ul>
            <li>
              <p>文档</p>
              <blockquote>
                <p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://doc.xiaominfo.com/">https://doc.xiaominfo.com/</a></p>
              </blockquote>
            </li>
            <li>
              <p>是什么</p>
              <blockquote>
                <p> <code>Knife4j</code>
                  <hanla></hanla>是一个集<hanla></hanla><code>Swagger2</code> 和 <code>OpenAPI3</code> 为一体的增强解决方案
                </p>
              </blockquote>
            </li>
            <li>
              <p>快速开始</p>
              <ol>
                <li>
                  <p>第一步：创建<hanla></hanla><code>Spring Boot</code>
                    <hanla></hanla>项目,<hanla></hanla>并且在<hanla></hanla><code>pom.xml</code>
                    <hanla></hanla>中引入<hanla></hanla><code>Knife4j</code>
                    <hanla></hanla>的依赖包，<code>Maven</code>
                    <hanla></hanla>坐标如下
                  </p>
                  <figure class="highlight xml">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment"><!--引入<hanla></hanla>Knife4j<hanla></hanla>的官方<hanla></hanla>start<hanla></hanla>包,Swagger2<hanla></hanla>基于<hanla></hanla>Springfox2.10.5<hanla></hanla>项目--></span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>knife4j-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.10.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>创建<hanla></hanla><code>Swagger</code>
                    <hanla></hanla>配置依赖，代码如下：
                  </p>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">package</span> com.example.system.config;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ParameterBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.PathSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.schema.ModelRef;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.ApiInfo;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.Contact;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.service.Parameter;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.DocumentationType;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2WebMvc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * knife4j 配置信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2WebMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Knife4jConfig</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Docket <span class="title function_">adminApiConfig</span><span class="params">()</span> {</span><br><span class="line">        List&lt;Parameter&gt; pars = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">ParameterBuilder</span> <span class="variable">tokenPar</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ParameterBuilder</span>();</span><br><span class="line">        tokenPar.name(<span class="string">"token"</span>)</span><br><span class="line">                <span class="comment">// 描述字段支持 Markdown 语法</span></span><br><span class="line">                .description(<span class="string">"用户<hanla></hanla>token"</span>)</span><br><span class="line">                .defaultValue(<span class="string">""</span>)</span><br><span class="line">                .modelRef(<span class="keyword">new</span> <span class="title class_">ModelRef</span>(<span class="string">"string"</span>))</span><br><span class="line">                .parameterType(<span class="string">"header"</span>)</span><br><span class="line">                .required(<span class="literal">false</span>)</span><br><span class="line">                .build();</span><br><span class="line">        pars.add(tokenPar.build());</span><br><span class="line">        <span class="comment">// 指定使用 Swagger2 规范</span></span><br><span class="line">        <span class="type">Docket</span> <span class="variable">adminApi</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2)</span><br><span class="line">                <span class="comment">// 分组名称</span></span><br><span class="line">                .groupName(<span class="string">"adminApi"</span>)</span><br><span class="line">                .apiInfo(adminApiInfo())</span><br><span class="line">                .select()</span><br><span class="line">                <span class="comment">// 这里指定 Controller 扫描包路径</span></span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">"com.example"</span>))</span><br><span class="line">                .paths(PathSelectors.regex(<span class="string">"/admin/.*"</span>))</span><br><span class="line">                .build()</span><br><span class="line">                .globalOperationParameters(pars);</span><br><span class="line">        <span class="keyword">return</span> adminApi;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> ApiInfo <span class="title function_">adminApiInfo</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ApiInfoBuilder</span>()</span><br><span class="line">                .title(<span class="string">"后台管理系统-API<hanla></hanla>文档"</span>)</span><br><span class="line">                .description(<span class="string">"本文档描述了后台管理系统微服务接口定义"</span>)</span><br><span class="line">                .version(<span class="string">"1.0"</span>)</span><br><span class="line">                .contact(<span class="keyword">new</span> <span class="title class_">Contact</span>(<span class="string">"coder-itl"</span>, <span class="string">"http://coderitl.github.io"</span>, <span class="string">"3327511395@qq.com"</span>))</span><br><span class="line">                .build();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p><code>Controller</code>
                    <hanla></hanla>添加注解
                  </p>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">package</span> com.example.system.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.model.system.SysRole;</span><br><span class="line"><span class="keyword">import</span> com.example.system.service.SysRoleService;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Api(tags = "角色管理")</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/admin/system/sysRole")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysRoleController</span> {</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysRoleService sysRoleService;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = "获取全部角色列表")</span></span><br><span class="line">    <span class="meta">@GetMapping("/findAll")</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;SysRole&gt; <span class="title function_">findAll</span><span class="params">()</span> {</span><br><span class="line">        log.info(<span class="string">"findAll:.............................."</span>);</span><br><span class="line">        List&lt;SysRole&gt; list = sysRoleService.list();</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 逻辑删除</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@DeleteMapping("/remove/{id}")</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">removeRole</span><span class="params">(<span class="meta">@PathVariable("id")</span> Long id)</span> {</span><br><span class="line">        log.info(<span class="string">"PathVariable Id value:{}"</span>, id);</span><br><span class="line">        <span class="keyword">return</span> sysRoleService.removeById(id);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>启动，访问</p>
                  <blockquote>
                    <p><a target="_blank" rel="external nofollow noopener noreferrer" href="http://localhost:8080/doc.html(%E8%AF%A5%E6%8E%A5%E5%8F%A3%E9%A1%B9%E7%9B%AE%E7%9A%84%E7%AB%AF%E5%8F%A3)">http://localhost:8080/doc.html(该接口项目的端口)</a></p>
                  </blockquote>
                </li>
              </ol>
            </li>
          </ul>
          <h4 id="定义统一返回结果对象"><a href="#定义统一返回结果对象" class="headerlink" title="定义统一返回结果对象"></a>定义统一返回结果对象</h4>
          <ul>
            <li>
              <p>创建<code>统一返回结果状态信息类</code></p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">package</span> com.example.common.result;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 统一返回结果状态信息类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">ResultCodeEnum</span> {</span><br><span class="line">    SUCCESS(<span class="number">200</span>, <span class="string">"成功"</span>),</span><br><span class="line">    FAIL(<span class="number">201</span>, <span class="string">"失败"</span>),</span><br><span class="line">    SERVICE_ERROR(<span class="number">2012</span>, <span class="string">"服务异常"</span>),</span><br><span class="line">    DATA_ERROR(<span class="number">204</span>, <span class="string">"数据异常"</span>),</span><br><span class="line">    ILLEGAL_REQUEST(<span class="number">205</span>, <span class="string">"非法请求"</span>),</span><br><span class="line">    REPEAT_SUBMIT(<span class="number">206</span>, <span class="string">"重复提交"</span>),</span><br><span class="line">    ARGUMENT_VALID_ERROR(<span class="number">210</span>, <span class="string">"参数校验异常"</span>),</span><br><span class="line">    </span><br><span class="line">    LOGIN_AUTH(<span class="number">208</span>, <span class="string">"未登陆"</span>),</span><br><span class="line">    PERMISSION(<span class="number">209</span>, <span class="string">"没有权限"</span>),</span><br><span class="line">    ACCOUNT_ERROR(<span class="number">214</span>, <span class="string">"账号不正确"</span>),</span><br><span class="line">    PASSWORD_ERROR(<span class="number">215</span>, <span class="string">"密码不正确"</span>),</span><br><span class="line">    LOGIN_MOBLE_ERROR(<span class="number">216</span>, <span class="string">"账号不正确"</span>),</span><br><span class="line">    ACCOUNT_STOP(<span class="number">217</span>, <span class="string">"账号已停用"</span>),</span><br><span class="line">    NODE_ERROR(<span class="number">218</span>, <span class="string">"该节点下有子节点，不可以删除"</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">ResultCodeEnum</span><span class="params">(Integer code, String message)</span> {</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>全局统一返回结果类</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">package</span> com.example.common.result;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 全局统一返回结果类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Result</span>&lt;T&gt; {</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//<hanla></hanla>返回码</span></span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//<hanla></hanla>返回消息</span></span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//<hanla></hanla>返回数据</span></span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Result</span><span class="params">()</span> {</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 返回数据</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">build</span><span class="params">(T data)</span> {</span><br><span class="line">        Result&lt;T&gt; result = <span class="keyword">new</span> <span class="title class_">Result</span>&lt;T&gt;();</span><br><span class="line">        <span class="keyword">if</span> (data != <span class="literal">null</span>)</span><br><span class="line">            result.setData(data);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">build</span><span class="params">(T body, Integer code, String message)</span> {</span><br><span class="line">        Result&lt;T&gt; result = build(body);</span><br><span class="line">        result.setCode(code);</span><br><span class="line">        result.setMessage(message);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">build</span><span class="params">(T body, ResultCodeEnum resultCodeEnum)</span> {</span><br><span class="line">        Result&lt;T&gt; result = build(body);</span><br><span class="line">        result.setCode(resultCodeEnum.getCode());</span><br><span class="line">        result.setMessage(resultCodeEnum.getMessage());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">ok</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> Result.ok(<span class="literal">null</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 操作成功</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data baseCategory1List</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">ok</span><span class="params">(T data)</span> {</span><br><span class="line">        Result&lt;T&gt; result = build(data);</span><br><span class="line">        <span class="keyword">return</span> build(data, ResultCodeEnum.SUCCESS);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">fail</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="literal">null</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 操作失败</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result&lt;T&gt; <span class="title function_">fail</span><span class="params">(T data)</span> {</span><br><span class="line">        Result&lt;T&gt; result = build(data);</span><br><span class="line">        <span class="keyword">return</span> build(data, ResultCodeEnum.FAIL);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> Result&lt;T&gt; <span class="title function_">message</span><span class="params">(String msg)</span> {</span><br><span class="line">        <span class="built_in">this</span>.setMessage(msg);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> Result&lt;T&gt; <span class="title function_">code</span><span class="params">(Integer code)</span> {</span><br><span class="line">        <span class="built_in">this</span>.setCode(code);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>修改控制器</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">package</span> com.example.system.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.common.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.example.model.system.SysRole;</span><br><span class="line"><span class="keyword">import</span> com.example.system.service.SysRoleService;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Api(tags = "角色管理")</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/admin/system/sysRole")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysRoleController</span> {</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysRoleService sysRoleService;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = "获取全部角色列表")</span></span><br><span class="line">    <span class="meta">@GetMapping("/findAll")</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">findAll</span><span class="params">()</span> {</span><br><span class="line">        log.info(<span class="string">"findAll:.............................."</span>);</span><br><span class="line">        List&lt;SysRole&gt; list = sysRoleService.list();</span><br><span class="line">        <span class="keyword">return</span> Result.ok(list);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 逻辑删除</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ApiOperation(value = "逻辑删除")</span></span><br><span class="line">    <span class="meta">@DeleteMapping("/remove/{id}")</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">removeRole</span><span class="params">(<span class="meta">@PathVariable("id")</span> Long id)</span> {</span><br><span class="line">        log.info(<span class="string">"PathVariable Id value:{}"</span>, id);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">removeById</span> <span class="operator">=</span> sysRoleService.removeById(id);</span><br><span class="line">        <span class="keyword">if</span> (removeById) {</span><br><span class="line">            <span class="keyword">return</span> Result.ok();</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="keyword">return</span> Result.fail();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
          </ul>
          <h4 id="MybatisPlus-条件分页查询"><a href="#MybatisPlus-条件分页查询" class="headerlink" title="MybatisPlus-条件分页查询"></a>MybatisPlus-条件分页查询</h4>
          <ul>
            <li>
              <p>第一步: 配置分页插件,<hanla></hanla>通过配置类实现</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">package</span> com.example.system.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.DbType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.EnableTransactionManagement;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@MapperScan("com.example.system.mapper")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusConfig</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">addPaginationInnerInterceptor</span><span class="params">()</span> {</span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        <span class="comment">// 向 Mybatis 过滤器链中添加分页拦截器</span></span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>(DbType.MYSQL));</span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>第二步: 创建<hanla></hanla><code>Controller</code>
                <hanla></hanla>方法、创建<hanla></hanla><code>Service</code>
                <hanla></hanla>方法、创建<hanla></hanla><code>Mapper</code>
                <hanla></hanla>方法
              </p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// controller</span></span><br><span class="line"> <span class="meta">@ApiOperation("条件分页查询")</span></span><br><span class="line">    <span class="meta">@GetMapping("/{page}/{limit}")</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">findPageQueryRole</span><span class="params">(<span class="meta">@PathVariable("page")</span> Long page, <span class="meta">@PathVariable("limit")</span> Long limit, SysRoleQueryVo sysRoleQueryVo)</span> {</span><br><span class="line">        <span class="comment">// 创建 page 对象</span></span><br><span class="line">        Page&lt;SysRole&gt; pageparam = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(page, limit);</span><br><span class="line">        IPage&lt;SysRole&gt; pageModel = sysRoleService.queryPage(pageparam, sysRoleQueryVo);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(pageModel);</span><br><span class="line">    }</span><br><span class="line">    </span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// service &amp;&amp; serviceImpl</span></span><br><span class="line"><span class="comment">// 条件分页查询<hanla></hanla></span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> IPage&lt;SysRole&gt; <span class="title function_">queryPage</span><span class="params">(Page&lt;SysRole&gt; pageparam, SysRoleQueryVo sysRoleQueryVo)</span> {</span><br><span class="line">    IPage&lt;SysRole&gt; pageModel = baseMapper.queryPage(pageparam, sysRoleQueryVo);</span><br><span class="line">    <span class="keyword">return</span> pageModel;</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// mapper</span></span><br><span class="line">IPage&lt;SysRole&gt; <span class="title function_">queryPage</span><span class="params">(Page&lt;SysRole&gt; pageparam, <span class="meta">@Param("vo")</span> SysRoleQueryVo sysRoleQueryVo)</span>;</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>第三步: 创建<hanla></hanla><code>mapper</code>
                <hanla></hanla>的<hanla></hanla><code>xml</code>
                <hanla></hanla>配置文件.<hanla></hanla>编写<hanla></hanla><code>sql</code>
                <hanla></hanla>语句实现
              </p>
              <figure class="highlight xml">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">        <span class="string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.example.system.mapper.SysRoleMapper"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- public IPage&lt;SysRole&gt; selectPage(Page&lt;SysRole&gt; pageparam, SysRoleQueryVo sysRoleQueryVo); --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"roleMap"</span> <span class="attr">type</span>=<span class="string">"com.example.model.system.SysRole"</span> <span class="attr">autoMapping</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">    <span class="comment"><!-- 用于<hanla></hanla>select<hanla></hanla>查询公用抽取的列 --></span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"columns"</span>&gt;</span></span><br><span class="line">        id,role_name,role_code,description,create_time,update_time,is_deleted</span><br><span class="line">    <span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryPage"</span> <span class="attr">resultMap</span>=<span class="string">"roleMap"</span>&gt;</span></span><br><span class="line">        select</span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"columns"</span>/&gt;</span></span><br><span class="line">        from sys_role</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"vo.roleName != null and vo.roleName != ''"</span>&gt;</span></span><br><span class="line">                and role_name like CONCAT('%',#{vo.roleName},'%')</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            and is_deleted = 0</span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">        order by id desc</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>第四步: 修改配置文件关于<hanla></hanla><code>mapper</code>
                <hanla></hanla>路径映射
              </p>
              <figure class="highlight yml">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:com/example/mapper/*Mapper.xml</span></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
          </ul>
          <h4 id="统一异常处理"><a href="#统一异常处理" class="headerlink" title="统一异常处理"></a>统一异常处理</h4>
          <h5 id="全局异常处理"><a href="#全局异常处理" class="headerlink" title="全局异常处理"></a>全局异常处理</h5>
          <ul>
            <li>
              <p>只要出现异常,<hanla></hanla>就执行这个处理</p>
            </li>
            <li>
              <p>实现</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandle</span> {</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">error</span><span class="params">(Exception e)</span> {</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> Result.fail().message(<span class="string">"执行了全局异常处理"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <table>
                <thead>
                  <tr>
                    <th align="center">全局异常捕获处理</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/8d6abba432094ba2b7ec3e239cc78208.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
          </ul>
          <h5 id="特定异常处理"><a href="#特定异常处理" class="headerlink" title="特定异常处理"></a>特定异常处理</h5>
          <ul>
            <li>
              <p>针对特定异常处理</p>
            </li>
            <li>
              <p>实现</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">package</span> com.example.system.exception;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.common.result.Result;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandle</span> {</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">error</span><span class="params">(Exception e)</span> {</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> Result.fail().message(<span class="string">"执行了全局异常处理"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// 特定异常处理</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(ArithmeticException.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">error</span><span class="params">(ArithmeticException e)</span> {</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> Result.fail().message(<span class="string">"执行了特定异常"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <table>
                <thead>
                  <tr>
                    <th align="center">处理特定异常</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/b4e81b8437ed4ec8a7983cf0c32f0b45.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
          </ul>
          <h5 id="自定义异常处理"><a href="#自定义异常处理" class="headerlink" title="自定义异常处理"></a>自定义异常处理</h5>
          <ul>
            <li>
              <p>自己编写异常类,<hanla></hanla>手动抛出异常</p>
            </li>
            <li>
              <p>实现</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">coderItlException</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span> {</span><br><span class="line">    <span class="comment">// 状态码</span></span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line">    <span class="comment">// 消息</span></span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">package</span> com.example.system.exception;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.common.result.Result;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandle</span> {</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">error</span><span class="params">(Exception e)</span> {</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> Result.fail().message(<span class="string">"执行了全局异常处理"</span>);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(ArithmeticException.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">error</span><span class="params">(ArithmeticException e)</span> {</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> Result.fail().message(<span class="string">"执行了特定异常"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// 自定义异常处理</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(coderItlException.class)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">error</span><span class="params">(coderItlException e)</span> {</span><br><span class="line">        <span class="keyword">return</span> Result.fail().code(e.getCode()).message(e.getMessage());</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// 在需要的地方主动抛出异常<hanla></hanla></span></span><br><span class="line"><span class="keyword">try</span> {</span><br><span class="line">    System.out.println(<span class="number">1</span> / <span class="number">0</span>);</span><br><span class="line">} <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">coderItlException</span>(<span class="number">10010</span>, <span class="string">"执行了自定义异常"</span>);</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <table>
                <thead>
                  <tr>
                    <th align="center">执行自定义异常</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/e53c94f2c21a4f458c7ca1d0d678a18a.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
          </ul>
          <h4 id="代码生成器使用"><a href="#代码生成器使用" class="headerlink" title="代码生成器使用"></a>代码生成器使用</h4>
          <ul>
            <li>
              <p>添加依赖</p>
              <figure class="highlight xml">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">&lt;!-- mybatis-plus 3.4.1 使用旧版本 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.velocity<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>velocity-engine-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>创建测试</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">package</span> com.example.system;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.DbType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.AutoGenerator;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.DataSourceConfig;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.GlobalConfig;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.PackageConfig;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.StrategyConfig;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CodeGet</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1、创建代码生成器</span></span><br><span class="line">        <span class="type">AutoGenerator</span> <span class="variable">mpg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AutoGenerator</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2、全局配置</span></span><br><span class="line">        <span class="comment">// 全局配置</span></span><br><span class="line">        <span class="type">GlobalConfig</span> <span class="variable">gc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GlobalConfig</span>();</span><br><span class="line">        <span class="comment">// 使用时需要修改</span></span><br><span class="line">        gc.setOutputDir(<span class="string">"E:\\auth-parent\\service-system"</span> + <span class="string">"/src/main/java"</span>);</span><br><span class="line">        </span><br><span class="line">        gc.setServiceName(<span class="string">"%sService"</span>);    <span class="comment">//<hanla></hanla>去掉<hanla></hanla>Service<hanla></hanla>接口的首字母<hanla></hanla>I</span></span><br><span class="line">        gc.setAuthor(<span class="string">"coder-itl"</span>);</span><br><span class="line">        gc.setOpen(<span class="literal">false</span>);</span><br><span class="line">        mpg.setGlobalConfig(gc);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3、数据源配置</span></span><br><span class="line">        <span class="type">DataSourceConfig</span> <span class="variable">dsc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataSourceConfig</span>();</span><br><span class="line">        <span class="comment">// 数据库名称需要修改</span></span><br><span class="line">        dsc.setUrl(<span class="string">"jdbc:mysql://localhost:3306/guigu-auth?serverTimezone=GMT%2B8&amp;useSSL=false"</span>);</span><br><span class="line">        dsc.setDriverName(<span class="string">"com.mysql.cj.jdbc.Driver"</span>);</span><br><span class="line">        dsc.setUsername(<span class="string">"root"</span>);</span><br><span class="line">        dsc.setPassword(<span class="string">"root"</span>);</span><br><span class="line">        dsc.setDbType(DbType.MYSQL);</span><br><span class="line">        mpg.setDataSource(dsc);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4、包配置</span></span><br><span class="line">        <span class="type">PackageConfig</span> <span class="variable">pc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PackageConfig</span>();</span><br><span class="line">        pc.setParent(<span class="string">"com.example"</span>);</span><br><span class="line">        pc.setModuleName(<span class="string">"system"</span>); <span class="comment">// 模块名</span></span><br><span class="line">        pc.setController(<span class="string">"controller"</span>);</span><br><span class="line">        pc.setService(<span class="string">"service"</span>);</span><br><span class="line">        pc.setMapper(<span class="string">"mapper"</span>);</span><br><span class="line">        mpg.setPackageInfo(pc);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 5、策略配置</span></span><br><span class="line">        <span class="type">StrategyConfig</span> <span class="variable">strategy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StrategyConfig</span>();</span><br><span class="line">        <span class="comment">// 要生成的表</span></span><br><span class="line">        strategy.setInclude(<span class="string">"sys_user"</span>);</span><br><span class="line">        </span><br><span class="line">        strategy.setNaming(NamingStrategy.underline_to_camel);<span class="comment">// 数据库表映射到实体的命名策略</span></span><br><span class="line">        </span><br><span class="line">        strategy.setColumnNaming(NamingStrategy.underline_to_camel);<span class="comment">// 数据库表字段映射到实体的命名策略</span></span><br><span class="line">        strategy.setEntityLombokModel(<span class="literal">true</span>); <span class="comment">// lombok 模型 @Accessors(chain = true) setter 链式操作</span></span><br><span class="line">        </span><br><span class="line">        strategy.setRestControllerStyle(<span class="literal">true</span>); <span class="comment">//restful api<hanla></hanla>风 格控制器</span></span><br><span class="line">        strategy.setControllerMappingHyphenStyle(<span class="literal">true</span>); <span class="comment">// url<hanla></hanla>中驼峰转连字符</span></span><br><span class="line">        </span><br><span class="line">        mpg.setStrategy(strategy);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 6、执行</span></span><br><span class="line">        mpg.execute();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <table>
                <thead>
                  <tr>
                    <th align="center">实现效果<hanla></hanla>(局部修改)</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/fac77bed9d1d4c2a8e6be3cb9db42807.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
          </ul>
          <h4 id="Token"><a href="#Token" class="headerlink" title="Token"></a>Token</h4>
          <ul>
            <li>
              <p>介绍</p>
              <blockquote>
                <p><code>JWT</code>
                  <hanla></hanla>是<hanla></hanla><code>JSON Web Token</code>
                  <hanla></hanla>的缩写，即<hanla></hanla><code>JSON Web</code>
                  <hanla></hanla>令牌，是一种自包含令牌。 是为了在网络应用环境间传递声明而执行的一种基于<hanla></hanla><code>JSON</code>
                  <hanla></hanla>的开放标准。
                </p>
                <p><code>JWT</code>
                  <hanla></hanla>的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源。比如用在用户登录上。
                </p>
                <p><code>JWT</code>
                  <hanla></hanla>最重要的作用就是对<code> token</code>
                  <hanla></hanla>信息的防伪作用。
                </p>
              </blockquote>
            </li>
            <li>
              <p>有效载荷</p>
              <figure class="highlight js">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="attr">iss</span>: jwt<hanla></hanla>签发者<hanla></hanla></span><br><span class="line"><span class="attr">sub</span>: 主题<hanla></hanla></span><br><span class="line"><span class="attr">aud</span>: 接收<hanla></hanla>jwt<hanla></hanla>的一方<hanla></hanla></span><br><span class="line"><span class="attr">exp</span>: jwt<hanla></hanla>的过期时间，这个过期时间必须要大于签发时间<hanla></hanla></span><br><span class="line"><span class="attr">nbf</span>: 定义在什么时间之前，该<hanla></hanla>jwt<hanla></hanla>都是不可用的.</span><br><span class="line"><span class="attr">iat</span>: jwt<hanla></hanla>的签发时间<hanla></hanla></span><br><span class="line"><span class="attr">jti</span>: jwt<hanla></hanla>的唯一身份标识，主要用来作为一次性<hanla></hanla>token,<hanla></hanla>从而回避重放攻击。</span><br><span class="line"></span><br><span class="line"><span class="comment">// 除以上默认字段外，我们还可以自定义私有字段，如下例：</span></span><br><span class="line">{</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"Helen"</span>,</span><br><span class="line">  <span class="string">"role"</span>: <span class="string">"editor"</span>,</span><br><span class="line">  <span class="string">"avatar"</span>: <span class="string">"helen.jpg"</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请注意，默认情况下<hanla></hanla>JWT<hanla></hanla>是未加密的，任何人都可以解读其内容，因此不要构建隐私信息字段，存放保密信息，以防止信息泄露。JSON<hanla></hanla>对象也使用<hanla></hanla>Base64 URL<hanla></hanla>算法转换为字符串保存。</span></span><br><span class="line"></span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>使用步骤</p>
              <ul>
                <li>
                  <p>添加依赖</p>
                  <figure class="highlight xml">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.jsonwebtoken<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jjwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>创建工具类</p>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">package</span> com.example.common.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.jsonwebtoken.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 生成<hanla></hanla>JSON Web<hanla></hanla>令牌的工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JwtHelper</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">long</span> <span class="variable">tokenExpiration</span> <span class="operator">=</span> <span class="number">365</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">tokenSignKey</span> <span class="operator">=</span> <span class="string">"123456"</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">createToken</span><span class="params">(Long userId, String username)</span> {</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> Jwts.builder()</span><br><span class="line">                .setSubject(<span class="string">"AUTH-USER"</span>)</span><br><span class="line">                .setExpiration(<span class="keyword">new</span> <span class="title class_">Date</span>(System.currentTimeMillis() + tokenExpiration))</span><br><span class="line">                .claim(<span class="string">"userId"</span>, userId)</span><br><span class="line">                .claim(<span class="string">"username"</span>, username)</span><br><span class="line">                .signWith(SignatureAlgorithm.HS512, tokenSignKey)</span><br><span class="line">                .compressWith(CompressionCodecs.GZIP)</span><br><span class="line">                .compact();</span><br><span class="line">        <span class="keyword">return</span> token;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getUserId</span><span class="params">(String token)</span> {</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isEmpty(token)) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            </span><br><span class="line">            Jws&lt;Claims&gt; claimsJws = Jwts.parser().setSigningKey(tokenSignKey).parseClaimsJws(token);</span><br><span class="line">            <span class="type">Claims</span> <span class="variable">claims</span> <span class="operator">=</span> claimsJws.getBody();</span><br><span class="line">            <span class="type">String</span> <span class="variable">userId</span> <span class="operator">=</span> (String) claims.get(<span class="string">"userId"</span>);</span><br><span class="line">            <span class="keyword">return</span> userId;</span><br><span class="line">        } <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getUsername</span><span class="params">(String token)</span> {</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="comment">// StringUtils: 是 web 包下的</span></span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isEmpty(token)) <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">            </span><br><span class="line">            Jws&lt;Claims&gt; claimsJws = Jwts.parser().setSigningKey(tokenSignKey).parseClaimsJws(token);</span><br><span class="line">            <span class="type">Claims</span> <span class="variable">claims</span> <span class="operator">=</span> claimsJws.getBody();</span><br><span class="line">            <span class="keyword">return</span> (String) claims.get(<span class="string">"username"</span>);</span><br><span class="line">        } <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 测试</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> JwtHelper.createToken(<span class="string">"1"</span>, <span class="string">"admin"</span>); </span><br><span class="line">        System.out.println(token);</span><br><span class="line">        System.out.println(JwtHelper.getUserId(token));</span><br><span class="line">        System.out.println(JwtHelper.getUsername(token));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ul>
            </li>
            <li>
              <p><code>MD5</code>
                <hanla></hanla>加密工具类
              </p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">package</span> com.example.common.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">MD5</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encrypt</span><span class="params">(String strSrc)</span> {</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="type">char</span> hexChars[] = {<span class="string">'0'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'8'</span>,</span><br><span class="line">                    <span class="string">'9'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>, <span class="string">'f'</span>};</span><br><span class="line">            <span class="type">byte</span>[] bytes = strSrc.getBytes();</span><br><span class="line">            <span class="type">MessageDigest</span> <span class="variable">md</span> <span class="operator">=</span> MessageDigest.getInstance(<span class="string">"MD5"</span>);</span><br><span class="line">            md.update(bytes);</span><br><span class="line">            bytes = md.digest();</span><br><span class="line">            <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> bytes.length;</span><br><span class="line">            <span class="type">char</span>[] chars = <span class="keyword">new</span> <span class="title class_">char</span>[j * <span class="number">2</span>];</span><br><span class="line">            <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; bytes.length; i++) {</span><br><span class="line">                <span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> bytes[i];</span><br><span class="line">                chars[k++] = hexChars[b &gt;&gt;&gt; <span class="number">4</span> &amp; <span class="number">0xf</span>];</span><br><span class="line">                chars[k++] = hexChars[b &amp; <span class="number">0xf</span>];</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">String</span>(chars);</span><br><span class="line">        } <span class="keyword">catch</span> (NoSuchAlgorithmException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">"MD5<hanla></hanla>加密出错！！+"</span> + e);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
          </ul>
          <h4 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端<hanla></hanla>
          </h4>
          <h5 id="vue-admin-template"><a href="#vue-admin-template" class="headerlink" title="vue-admin-template"></a>vue-admin-template</h5>
          <ul>
            <li>
              <p>下载</p>
              <blockquote>
                <p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/PanJiaChen/vue-admin-template">https://github.com/PanJiaChen/vue-admin-template</a></p>
              </blockquote>
            </li>
            <li>
              <p>解压</p>
            </li>
            <li>
              <p>依赖下载</p>
              <figure class="highlight properties">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment"># 配置镜像<hanla></hanla></span></span><br><span class="line"><span class="attr">npm</span> <span class="string">config set registry  http://registry.npmmirror.com</span></span><br><span class="line"><span class="attr">yarn</span> <span class="string">config set registry http://registry.npmmirror.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 切换回默认镜像源 </span></span><br><span class="line"><span class="attr">npm</span> <span class="string">config set registryhttps://registry.npmjs.org</span></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight properties">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment"># npm</span></span><br><span class="line"><span class="attr">npm</span> <span class="string">install</span></span><br><span class="line"><span class="comment"># yarn</span></span><br><span class="line"><span class="attr">yarn</span> <span class="string">install</span></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>启动</p>
              <figure class="highlight properties">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment"># npm 启动<hanla></hanla></span></span><br><span class="line"><span class="attr">npm</span> <span class="string">run dev</span></span><br><span class="line"><span class="comment"># yarn 启动<hanla></hanla></span></span><br><span class="line"><span class="attr">yarn</span> <span class="string">run dev</span></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <table>
                <thead>
                  <tr>
                    <th align="center">通过<hanla></hanla><code>package.json</code>
                      <hanla></hanla>查看<hanla></hanla><code>scripts</code>
                      <hanla></hanla>确定启动命令
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/0e50f7ff6e684e44b6b71239907bdf41.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p>访问</p>
              <table>
                <thead>
                  <tr>
                    <th align="center">访问首页</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/81547ba603b9481eb4965e47605457d1.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p>依赖下载出错问题</p>
              <table>
                <thead>
                  <tr>
                    <th align="center">提示下载，直接下载无效</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/79119c2ded7447179ef7fc62f434aaf4.png"></td>
                  </tr>
                </tbody>
              </table>
              <ul>
                <li>
                  <p>解决方案</p>
                  <ul>
                    <li>
                      <p>先删除<hanla></hanla><code>node_modules</code></p>
                    </li>
                    <li>
                      <p>在下载如下依赖</p>
                      <figure class="highlight properties">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="attr">npm</span> <span class="string">install --save core-js</span></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                    <li>
                      <p>再次执行</p>
                      <figure class="highlight properties">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="comment"># /: 或者<hanla></hanla></span></span><br><span class="line"><span class="attr">npm</span> <span class="string">install / yarn install</span></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
          <h5 id="Vue-admin-template文件目录"><a href="#Vue-admin-template文件目录" class="headerlink" title="Vue-admin-template文件目录"></a>Vue-admin-template<hanla></hanla>文件目录</h5>
          <ul>
            <li>
              <p>文件信息</p>
              <figure class="highlight sh">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">|-dist 生产环境打包生成的打包项目</span><br><span class="line">|-mock 产生模拟数据</span><br><span class="line">|-public 包含会被自动打包到项目根路径的文件夹</span><br><span class="line">	|-index.html 唯一的页面</span><br><span class="line">|-src</span><br><span class="line">	|-api 包含接口请求函数模块</span><br><span class="line">		|-table.js  表格列表<hanla></hanla>mock<hanla></hanla>数据接口的请求函数</span><br><span class="line">		|-user.js  用户登陆相关<hanla></hanla>mock<hanla></hanla>数据接口的请求函数</span><br><span class="line">	|-assets 组件中需要使用的公用资源</span><br><span class="line">		|-404_images 404<hanla></hanla>页面的图片</span><br><span class="line">	|-components 非路由组件</span><br><span class="line">		|-SvgIcon svg<hanla></hanla>图标组件</span><br><span class="line">		|-Breadcrumb 面包屑组件<hanla></hanla>(头部水平方向的层级组件)</span><br><span class="line">		|-Hamburger 用来点击切换左侧菜单导航的图标组件</span><br><span class="line">	|-icons</span><br><span class="line">		|-svg 包含一些<hanla></hanla>svg<hanla></hanla>图片文件</span><br><span class="line">		|-index.js 全局注册<hanla></hanla>SvgIcon<hanla></hanla>组件,<hanla></hanla>加载所有<hanla></hanla>svg<hanla></hanla>图片并暴露所有<hanla></hanla>svg<hanla></hanla>文件名的数组</span><br><span class="line">	|-layout</span><br><span class="line">		|-components 组成整体布局的一些子组件</span><br><span class="line">		|-mixin 组件中可复用的代码</span><br><span class="line">		|-index.vue 后台管理的整体界面布局组件</span><br><span class="line">	|-router</span><br><span class="line">		|-index.js 路由器</span><br><span class="line">	|-store</span><br><span class="line">		|-modules</span><br><span class="line">			|-app.js 管理应用相关数据</span><br><span class="line">			|-settings.js 管理设置相关数据</span><br><span class="line">			|-user.js 管理后台登陆用户相关数据</span><br><span class="line">		|-getters.js 提供子模块相关数据的<hanla></hanla>getters<hanla></hanla>计算属性</span><br><span class="line">		|-index.js vuex<hanla></hanla>的<hanla></hanla>store</span><br><span class="line">	|-styles</span><br><span class="line">		|-xxx.scss 项目组件需要使用的一些样式<hanla></hanla>(使用<hanla></hanla>scss)</span><br><span class="line">	|-utils 一些工具函数</span><br><span class="line">		|-auth.js 操作登陆用户的<hanla></hanla>token cookie</span><br><span class="line">		|-get-page-title.js 得到要显示的网页<hanla></hanla>title</span><br><span class="line">		|-request.js axios<hanla></hanla>二次封装的模块</span><br><span class="line">		|-validate.js 检验相关工具函数</span><br><span class="line">		|-index.js 日期和请求参数处理相关工具函数</span><br><span class="line">	|-views 路由组件文件夹</span><br><span class="line">		|-dashboard 首页</span><br><span class="line">		|-login 登陆</span><br><span class="line">	|-App.vue 应用根组件</span><br><span class="line">	|-main.js 入口<hanla></hanla>js</span><br><span class="line">	|-permission.js 使用全局守卫实现路由权限控制的模块</span><br><span class="line">	|-settings.js 包含应用设置信息的模块</span><br><span class="line">|-.env.development 指定了开发环境的代理服务器前缀路径</span><br><span class="line">|-.env.production 指定了生产环境的代理服务器前缀路径</span><br><span class="line">|-.eslintignore eslint<hanla></hanla>的忽略配置</span><br><span class="line">|-.eslintrc.js eslint<hanla></hanla>的检查配置</span><br><span class="line">|-.gitignore git<hanla></hanla>的忽略配置</span><br><span class="line">|-.npmrc 指定<hanla></hanla>npm<hanla></hanla>的淘宝镜像和<hanla></hanla>sass<hanla></hanla>的下载地址</span><br><span class="line">|-babel.config.js babel<hanla></hanla>的配置</span><br><span class="line">|-jsconfig.json 用于<hanla></hanla>vscode<hanla></hanla>引入路径提示的配置</span><br><span class="line">|-package.json 当前项目包信息</span><br><span class="line">|-package-lock.json 当前项目依赖的第三方包的精确信息</span><br><span class="line">|-vue.config.js webpack<hanla></hanla>相关配置<hanla></hanla>(如: 代理服务器)</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
          </ul>
          <h5 id="登录退出改造"><a href="#登录退出改造" class="headerlink" title="登录退出改造"></a>登录退出改造</h5>
          <ul>
            <li>
              <p>通过<hanla></hanla><code>network</code>
                <hanla></hanla>查看到登录后发起的请求
              </p>
              <ul>
                <li>
                  <p><code>login</code></p>
                  <figure class="highlight json">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// POST</span></span><br><span class="line"><span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"code"</span><span class="punctuation">:</span><span class="number">20000</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"data"</span><span class="punctuation">:</span><span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"token"</span><span class="punctuation">:</span><span class="string">"admin-token"</span></span><br><span class="line">    <span class="punctuation">}</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p><code>info</code></p>
                  <figure class="highlight json">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// GET</span></span><br><span class="line"><span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"code"</span><span class="punctuation">:</span><span class="number">20000</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"data"</span><span class="punctuation">:</span><span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"roles"</span><span class="punctuation">:</span><span class="punctuation">[</span></span><br><span class="line">            <span class="string">"admin"</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"introduction"</span><span class="punctuation">:</span><span class="string">"I am a super administrator"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"avatar"</span><span class="punctuation">:</span><span class="string">"https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"name"</span><span class="punctuation">:</span><span class="string">"Super Admin"</span></span><br><span class="line">    <span class="punctuation">}</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">分析</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/1b7adbbb462440ed83240e9c7800f1db.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
              </ul>
            </li>
            <li>
              <p>通过上述分析,<hanla></hanla>后端模拟实现</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">package</span> com.example.system.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.common.result.Result;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.Api;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiOperation;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Api(tags = "用户登录接口")</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping("/admin/system/index")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexController</span> {</span><br><span class="line">    <span class="meta">@ApiOperation("用户登录")</span></span><br><span class="line">    <span class="meta">@PostMapping("/login")</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">login</span><span class="params">()</span> {</span><br><span class="line">        Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">"token"</span>, <span class="string">"admin-token"</span>);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(map);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ApiOperation("用户信息")</span></span><br><span class="line">    <span class="meta">@GetMapping("/info")</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">info</span><span class="params">()</span> {</span><br><span class="line">        Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">"roles"</span>, <span class="string">"[admin]"</span>);</span><br><span class="line">        map.put(<span class="string">"introduction"</span>, <span class="string">"I am a super administrator"</span>);</span><br><span class="line">        map.put(<span class="string">"avatar"</span>, <span class="string">"https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif"</span>);</span><br><span class="line">        map.put(<span class="string">"name"</span>, <span class="string">"Super Admin"</span>);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(map);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>配置后端路径<hanla></hanla><code>IP</code>+ 端口号</p>
              <ul>
                <li>
                  <p>修改<hanla></hanla><code>vue.config.js</code></p>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// before: require('./mock/mock-server.js')</span></span><br><span class="line"><span class="attr">proxy</span>: {</span><br><span class="line">  <span class="string">'/dev-api'</span>: { <span class="comment">// 匹配所有以 '/dev-api'开头的请求路径</span></span><br><span class="line">    <span class="attr">target</span>: <span class="string">'http://localhost:8800'</span>,</span><br><span class="line">    <span class="attr">changeOrigin</span>: <span class="literal">true</span>, <span class="comment">// 支持跨域</span></span><br><span class="line">    <span class="attr">pathRewrite</span>: { <span class="comment">// 重写路径: 去掉路径中开头的'/dev-api'</span></span><br><span class="line">      <span class="string">'^/dev-api'</span>: <span class="string">''</span></span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>修改<hanla></hanla><code>src/utils</code>
                    <hanla></hanla>里面的<hanla></hanla><code>request.js</code>
                    <hanla></hanla>文件
                  </p>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"></span><br><span class="line"><span class="comment">// if the custom code is not 20000, it is judged as an error.</span></span><br><span class="line"><span class="keyword">if</span> (res.<span class="property">code</span> !== <span class="number">20000</span>) {</span><br><span class="line">    <span class="title class_">Message</span>({</span><br><span class="line">        <span class="attr">message</span>: res.<span class="property">message</span> || <span class="string">'Error'</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">'error'</span>,</span><br><span class="line">        <span class="attr">duration</span>: <span class="number">5</span> * <span class="number">1000</span></span><br><span class="line">    })</span><br><span class="line"><span class="comment">// 20000 修改为自己所需要的值信息</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ul>
            </li>
            <li>
              <p>修改登录接口和提交方式</p>
              <figure class="highlight js">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// src/api/user.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">login</span>(<span class="params">data</span>) {</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">    <span class="comment">// 后端提供的接口</span></span><br><span class="line">    <span class="attr">url</span>: <span class="string">"/admin/system/index/login"</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">"post"</span>,</span><br><span class="line">    data,</span><br><span class="line">  });</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getInfo</span>(<span class="params">token</span>) {</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">    <span class="attr">url</span>: <span class="string">"/admin/system/index/info"</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">"get"</span>,</span><br><span class="line">    <span class="attr">params</span>: { token },</span><br><span class="line">  });</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>退出实现</p>
              <ul>
                <li>
                  <p>实现一: 后端实现，前端调用接口</p>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="meta">@ApiOperation("用户退出")</span></span><br><span class="line"><span class="meta">@PostMapping("/logout")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">logout</span><span class="params">()</span> {</span><br><span class="line">    <span class="keyword">return</span> Result.ok();</span><br><span class="line">}</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// src/api/user</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">logout</span>(<span class="params"></span>) {</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">    <span class="attr">url</span>: <span class="string">"/admin/system/index/logout"</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">"post"</span>,</span><br><span class="line">  });</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>实现二: 修改前端信息<hanla></hanla><code>src/store/modules/user.js</code></p>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="title function_">login</span>(<span class="params">{ commit }, userInfo</span>) {</span><br><span class="line">    <span class="keyword">const</span> { username, password } = userInfo</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> {</span><br><span class="line">        <span class="keyword">const</span> { data } = response</span><br><span class="line">        <span class="title function_">commit</span>(<span class="string">'SET_TOKEN'</span>, data.<span class="property">token</span>)</span><br><span class="line">        <span class="title function_">setToken</span>(data.<span class="property">token</span>)</span><br><span class="line">        <span class="title function_">resolve</span>()</span><br><span class="line">    })</span><br><span class="line">  },</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ul>
            </li>
          </ul>
          <h5 id="角色列表实现"><a href="#角色列表实现" class="headerlink" title="角色列表实现"></a>角色列表实现</h5>
          <ul>
            <li>
              <p>实现步骤</p>
              <ol>
                <li>
                  <p>添加角色管理路由</p>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"></span><br><span class="line"><span class="comment">/* sysRole start */</span></span><br><span class="line">{</span><br><span class="line">    <span class="attr">path</span>: <span class="string">"/system"</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="title class_">Layout</span>,</span><br><span class="line">            <span class="attr">redirect</span>: <span class="string">"/system/sysUser"</span>,</span><br><span class="line">                <span class="attr">name</span>: <span class="string">"System"</span>,</span><br><span class="line">                    <span class="attr">meta</span>: { <span class="attr">title</span>: <span class="string">"系统管理"</span>, <span class="attr">icon</span>: <span class="string">"el-icon-s-help"</span> },</span><br><span class="line">                        <span class="attr">children</span>: [</span><br><span class="line">                            {</span><br><span class="line">                                <span class="attr">path</span>: <span class="string">"sysUser"</span>,</span><br><span class="line">                                <span class="attr">name</span>: <span class="string">"SysUser"</span>,</span><br><span class="line">                                <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">"@/views/system/sysUser/list"</span>),</span><br><span class="line">                                <span class="attr">meta</span>: { <span class="attr">title</span>: <span class="string">"用户管理"</span>, <span class="attr">icon</span>: <span class="string">"tree"</span> },</span><br><span class="line">                            },</span><br><span class="line">                            {</span><br><span class="line">                                <span class="attr">path</span>: <span class="string">"sysRole"</span>,</span><br><span class="line">                                <span class="attr">name</span>: <span class="string">"SysRole"</span>,</span><br><span class="line">                                <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">"@/views/system/sysRole/list"</span>),</span><br><span class="line">                                <span class="attr">meta</span>: { <span class="attr">title</span>: <span class="string">"角色管理"</span>, <span class="attr">icon</span>: <span class="string">"table"</span> },</span><br><span class="line">                            },</span><br><span class="line">                        ],</span><br><span class="line">},</span><br><span class="line">    <span class="comment">/* sysRole end */</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>创建路由对应的页面</p>
                  <figure class="highlight html">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"app-container"</span>&gt;</span><hanla></hanla>角色列表<hanla></hanla><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> {}</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">根据路由创建页面</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/f99557c9acff4a68ad9d33ee76d07cd5.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p>在<hanla></hanla><code>api</code>
                    <hanla></hanla>目录创建<hanla></hanla><code>js</code>
                    <hanla></hanla>文件,<hanla></hanla>定义角色管理接口
                  </p>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">"@/utils/request"</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">API_PATH</span> = <span class="string">"/admin/system/sysRole/"</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line">  <span class="comment">// 分页查询</span></span><br><span class="line">  <span class="title function_">getPageList</span>(<span class="params">page, limit, searchObj</span>) {</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">      <span class="attr">url</span>: <span class="string">`<span class="subst">${API_PATH}</span>/<span class="subst">${page}</span>/<span class="subst">${limit}</span>`</span>,</span><br><span class="line">      <span class="attr">method</span>: <span class="string">"get"</span>,</span><br><span class="line">      <span class="attr">params</span>: searchObj,</span><br><span class="line">    });</span><br><span class="line">  },</span><br><span class="line">};</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>在具体功能页面调用<hanla></hanla><code>api</code>
                    <hanla></hanla>定义的方法获取接口返回数据
                  </p>
                  <figure class="highlight html">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 引入定义接口的 js 文件<hanla></hanla></span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">'@/api/role/role'</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> {</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">data</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> {</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">list</span>: [], <span class="comment">// 角色列表</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">total</span>: <span class="number">0</span>, <span class="comment">// 总记录数</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">page</span>: <span class="number">1</span>, <span class="comment">// 当前页</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">limit</span>: <span class="number">3</span>, <span class="comment">// 每页显示记录数</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">searchObj</span>: {}, <span class="comment">// 条件查询封装对象</span></span></span><br><span class="line"><span class="language-javascript">    }</span></span><br><span class="line"><span class="language-javascript">  },</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 页面渲染之前执行</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">created</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="title function_">fetchData</span>()</span></span><br><span class="line"><span class="language-javascript">  },</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: {</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 条件分页查询列表,pageNum=1 代表默认值</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">async</span> <span class="title function_">fetchData</span>(<span class="params">pageNum = <span class="number">1</span></span>) {</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 页数赋值</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">page</span> = pageNum</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 发起 ajax 调用</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> { <span class="attr">data</span>: res } = <span class="keyword">await</span> api.<span class="title function_">getPageList</span>(</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">page</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">limit</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">searchObj</span></span></span><br><span class="line"><span class="language-javascript">      )</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 角色列表赋值</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">list</span> = res.<span class="property">records</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">total</span> = res.<span class="property">total</span></span></span><br><span class="line"><span class="language-javascript">    },</span></span><br><span class="line"><span class="language-javascript">  },</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">数据模型</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/3ec98736cb4047d7967c63ccaaf3397b.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p>把接口返回的数据进行处理,<hanla></hanla>使用<hanla></hanla><code>ElementUI</code>
                    <hanla></hanla>显示
                  </p>
                  <figure class="highlight html">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"app-container"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 表格 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-loading</span>=<span class="string">"listLoading"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:data</span>=<span class="string">"list"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">stripe</span></span></span><br><span class="line"><span class="tag">      <span class="attr">border</span></span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">"width: 100%; margin-top: 10px"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">"序号"</span> <span class="attr">width</span>=<span class="string">"70"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">          {{ (page - 1) * limit + scope.$index + 1 }}</span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"roleName"</span> <span class="attr">label</span>=<span class="string">"角色名称"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"roleCode"</span> <span class="attr">label</span>=<span class="string">"角色编码"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"createTime"</span> <span class="attr">label</span>=<span class="string">"创建时间"</span> <span class="attr">width</span>=<span class="string">"160"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">"操作"</span> <span class="attr">width</span>=<span class="string">"200"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">"primary"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">icon</span>=<span class="string">"el-icon-edit"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">size</span>=<span class="string">"mini"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">"edit(scope.row.id)"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">title</span>=<span class="string">"修改"</span></span></span><br><span class="line"><span class="tag">          /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">"danger"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">icon</span>=<span class="string">"el-icon-delete"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">size</span>=<span class="string">"mini"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">"removeDataById(scope.row.id)"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">title</span>=<span class="string">"删除"</span></span></span><br><span class="line"><span class="tag">          /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 引入定义接口的 js 文件<hanla></hanla></span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">'@/api/role/role'</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> {</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">data</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> {</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">list</span>: [], <span class="comment">// 角色列表</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">total</span>: <span class="number">0</span>, <span class="comment">// 总记录数</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">page</span>: <span class="number">1</span>, <span class="comment">// 当前页</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">limit</span>: <span class="number">3</span>, <span class="comment">// 每页显示记录数</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">searchObj</span>: {}, <span class="comment">// 条件查询封装对象</span></span></span><br><span class="line"><span class="language-javascript">    }</span></span><br><span class="line"><span class="language-javascript">  },</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 页面渲染之前执行</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">created</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="title function_">fetchData</span>()</span></span><br><span class="line"><span class="language-javascript">  },</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: {</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 条件分页查询列表,pageNum=1 代表默认值</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">async</span> <span class="title function_">fetchData</span>(<span class="params">pageNum = <span class="number">1</span></span>) {</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 页数赋值</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">page</span> = pageNum</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 发起 ajax 调用</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> { <span class="attr">data</span>: res } = <span class="keyword">await</span> api.<span class="title function_">getPageList</span>(</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">page</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">limit</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">searchObj</span></span></span><br><span class="line"><span class="language-javascript">      )</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 角色列表赋值</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">list</span> = res.<span class="property">records</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">total</span> = res.<span class="property">total</span></span></span><br><span class="line"><span class="language-javascript">    },</span></span><br><span class="line"><span class="language-javascript">  },</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ol>
            </li>
            <li>
              <p><code>SysRole</code>
                <hanla></hanla>页面实现
              </p>
              <table>
                <thead>
                  <tr>
                    <th align="center">角色管理页面</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/8af0c6db6cb8400b905886899b2e6b3d.png" alt="在这里插入图片描述"></td>
                  </tr>
                </tbody>
              </table>
              <figure class="highlight html">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"app-container"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--查询表单--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"search-div"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">label-width</span>=<span class="string">"70px"</span> <span class="attr">size</span>=<span class="string">"small"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-row</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">"24"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"角色名称"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-input</span></span></span><br><span class="line"><span class="tag">                <span class="attr">style</span>=<span class="string">"width: 100%"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">v-model</span>=<span class="string">"searchObj.roleName"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">placeholder</span>=<span class="string">"角色名称"</span></span></span><br><span class="line"><span class="tag">              &gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-row</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-row</span> <span class="attr">style</span>=<span class="string">"display: flex"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">"primary"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">icon</span>=<span class="string">"el-icon-search"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">size</span>=<span class="string">"mini"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">"fetchData()"</span></span></span><br><span class="line"><span class="tag">            &gt;</span><hanla></hanla>搜索<hanla></hanla></span><br><span class="line">          &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">icon</span>=<span class="string">"el-icon-refresh"</span> <span class="attr">size</span>=<span class="string">"mini"</span> @<span class="attr">click</span>=<span class="string">"resetData"</span></span></span><br><span class="line"><span class="tag">            &gt;</span><hanla></hanla>重置<hanla></hanla></span><br><span class="line">          &gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-row</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 表格 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-loading</span>=<span class="string">"listLoading"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:data</span>=<span class="string">"list"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">stripe</span></span></span><br><span class="line"><span class="tag">      <span class="attr">border</span></span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">"width: 100%; margin-top: 10px"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">"序号"</span> <span class="attr">width</span>=<span class="string">"70"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">          {{ (page - 1) * limit + scope.$index + 1 }}</span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"roleName"</span> <span class="attr">label</span>=<span class="string">"角色名称"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"roleCode"</span> <span class="attr">label</span>=<span class="string">"角色编码"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"createTime"</span> <span class="attr">label</span>=<span class="string">"创建时间"</span> <span class="attr">width</span>=<span class="string">"160"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">"操作"</span> <span class="attr">width</span>=<span class="string">"200"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">"primary"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">icon</span>=<span class="string">"el-icon-edit"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">size</span>=<span class="string">"mini"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">"edit(scope.row.id)"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">title</span>=<span class="string">"修改"</span></span></span><br><span class="line"><span class="tag">          /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">"danger"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">icon</span>=<span class="string">"el-icon-delete"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">size</span>=<span class="string">"mini"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">"removeDataById(scope.row.id)"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">title</span>=<span class="string">"删除"</span></span></span><br><span class="line"><span class="tag">          /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 分页组件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:current-page</span>=<span class="string">"page"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:total</span>=<span class="string">"total"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:page-size</span>=<span class="string">"limit"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">"padding: 30px 0; text-align: center"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">layout</span>=<span class="string">"total, prev, pager, next, jumper"</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">current-change</span>=<span class="string">"fetchData"</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 引入定义接口的 js 文件<hanla></hanla></span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">'@/api/role/role'</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> {</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">data</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> {</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">listLoading</span>: <span class="literal">true</span>, <span class="comment">// 是否显示加载图标</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">list</span>: [], <span class="comment">// 角色列表</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">total</span>: <span class="number">0</span>, <span class="comment">// 总记录数</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">page</span>: <span class="number">1</span>, <span class="comment">// 当前页</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">limit</span>: <span class="number">3</span>, <span class="comment">// 每页显示记录数</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">searchObj</span>: {}, <span class="comment">// 条件查询封装对象</span></span></span><br><span class="line"><span class="language-javascript">    }</span></span><br><span class="line"><span class="language-javascript">  },</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 页面渲染之前执行</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">created</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="title function_">fetchData</span>()</span></span><br><span class="line"><span class="language-javascript">  },</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: {</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 条件分页查询列表,pageNum=1 代表默认值</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">async</span> <span class="title function_">fetchData</span>(<span class="params">pageNum = <span class="number">1</span></span>) {</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 页数赋值</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">page</span> = pageNum</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 发起 ajax 调用</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> { <span class="attr">data</span>: res } = <span class="keyword">await</span> api.<span class="title function_">getPageList</span>(</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">page</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">limit</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">searchObj</span></span></span><br><span class="line"><span class="language-javascript">      )</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">listLoading</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 角色列表赋值</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">list</span> = res.<span class="property">records</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">total</span> = res.<span class="property">total</span></span></span><br><span class="line"><span class="language-javascript">    },</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 重置</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">resetData</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 清空表单</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">searchObj</span> = {}</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 显示所有数据</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="title function_">fetchData</span>()</span></span><br><span class="line"><span class="language-javascript">    },</span></span><br><span class="line"><span class="language-javascript">  },</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>角色删除</p>
              <ul>
                <li>
                  <p>前端请求接口定义</p>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// api</span></span><br><span class="line"><span class="comment">// 根据 id 删除</span></span><br><span class="line">  <span class="title function_">removeById</span>(<span class="params">id</span>) {</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">      <span class="attr">url</span>: <span class="string">`<span class="subst">${API_PATH}</span>/remove/<span class="subst">${id}</span>`</span>,</span><br><span class="line">      <span class="attr">method</span>: <span class="string">"delete"</span>,</span><br><span class="line">    });</span><br><span class="line">  },</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>事件</p>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// 根据 id 删除<hanla></hanla></span></span><br><span class="line"><span class="title function_">removeDataById</span>(<span class="params">id</span>) {</span><br><span class="line">    <span class="comment">// debugger</span></span><br><span class="line">    <span class="variable language_">this</span>.$confirm(<span class="string">'此操作将永久删除该角色, 是否继续?'</span>, <span class="string">'提示'</span>, {</span><br><span class="line">        <span class="attr">confirmButtonText</span>: <span class="string">'确定'</span>,</span><br><span class="line">        <span class="attr">cancelButtonText</span>: <span class="string">'取消'</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">'warning'</span>,</span><br><span class="line">    })</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function">() =&gt;</span> {</span><br><span class="line">        <span class="comment">// promise</span></span><br><span class="line">        <span class="comment">// 点击确定，远程调用<hanla></hanla>ajax</span></span><br><span class="line">        <span class="keyword">return</span> api.<span class="title function_">removeById</span>(id)</span><br><span class="line">    })</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> {</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">fetchData</span>(<span class="variable language_">this</span>.<span class="property">page</span>)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(response.<span class="property">message</span> || <span class="string">'删除成功'</span>)</span><br><span class="line">    })</span><br><span class="line">},</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p><code>Javascript</code>
                    <hanla></hanla>处理数值问题
                  </p>
                  <ul>
                    <li>由于<hanla></hanla><code>Javascript</code>
                      <hanla></hanla>对数值的精度问题，可能导致错误
                    </li>
                    <li>解决方案: 修改实体类中数据类型</li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>
              <p>添加角色实现</p>
              <ul>
                <li>
                  <p>添加按钮</p>
                  <figure class="highlight html">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tools-div"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"success"</span> <span class="attr">icon</span>=<span class="string">"el-icon-plus"</span> <span class="attr">size</span>=<span class="string">"mini"</span> @<span class="attr">click</span>=<span class="string">"add"</span>&gt;</span><hanla></hanla>添 加<hanla></hanla><span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// 放在全局样式<hanla></hanla></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.search-div</span> {</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>:<span class="number">10px</span>;<span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#EBEEF5</span>;<span class="attribute">border-radius</span>:<span class="number">3px</span>;</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.tools-div</span> {</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin-top</span>: <span class="number">10px</span>;<span class="attribute">padding</span>:<span class="number">10px</span>;<span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#EBEEF5</span>;<span class="attribute">border-radius</span>:<span class="number">3px</span>;</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p><code>api</code></p>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// 添加角色<hanla></hanla></span></span><br><span class="line"><span class="title function_">saveRole</span>(<span class="params">role</span>) {</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">        <span class="attr">url</span>: <span class="string">`<span class="subst">${API_PATH}</span>/save`</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">"post"</span>,</span><br><span class="line">        <span class="comment">// 后端存在 @RequestBody 注解时,<hanla></hanla>需要前端传递 json 数据</span></span><br><span class="line">        <span class="attr">data</span>: role,</span><br><span class="line">    });</span><br><span class="line">},</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p><code>element-ui</code>
                    <hanla></hanla>弹窗
                  </p>
                  <figure class="highlight html">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">title</span>=<span class="string">"添加<hanla></hanla>/<hanla></hanla>修改"</span> <span class="attr">:visible.sync</span>=<span class="string">"dialogVisible"</span> <span class="attr">width</span>=<span class="string">"40%"</span> &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">ref</span>=<span class="string">"dataForm"</span> <span class="attr">:model</span>=<span class="string">"sysRole"</span> <span class="attr">label-width</span>=<span class="string">"150px"</span> <span class="attr">size</span>=<span class="string">"small"</span> <span class="attr">style</span>=<span class="string">"padding-right: 40px;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"角色名称"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"sysRole.roleName"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"角色编码"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"sysRole.roleCode"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">"footer"</span> <span class="attr">class</span>=<span class="string">"dialog-footer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">"dialogVisible = false"</span> <span class="attr">size</span>=<span class="string">"small"</span> <span class="attr">icon</span>=<span class="string">"el-icon-refresh-right"</span>&gt;</span><hanla></hanla>取 消<hanla></hanla><span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"primary"</span> <span class="attr">icon</span>=<span class="string">"el-icon-check"</span> @<span class="attr">click</span>=<span class="string">"saveOrUpdate()"</span> <span class="attr">size</span>=<span class="string">"small"</span>&gt;</span><hanla></hanla>确 定<hanla></hanla><span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>事件</p>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// 初始值<hanla></hanla></span></span><br><span class="line"><span class="attr">sysRole</span>: {}, <span class="comment">// 封装添加的表单数据<hanla></hanla></span></span><br><span class="line"><span class="attr">dialogVisible</span>: <span class="literal">false</span>, <span class="comment">// 添加角色弹框<hanla></hanla></span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// 添加添加按钮出现弹窗<hanla></hanla></span></span><br><span class="line"><span class="title function_">add</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">dialogVisible</span> = <span class="literal">true</span></span><br><span class="line">    <span class="comment">// 清空原始数据,<hanla></hanla>便于添加</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">sysRole</span> = {}</span><br><span class="line">},</span><br><span class="line">    <span class="comment">// 添加或更新事件</span></span><br><span class="line">    <span class="title function_">saveOrUpdate</span>(<span class="params"></span>) {</span><br><span class="line">        <span class="comment">// 判断添加是修改还是更新</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">sysRole</span>.<span class="property">id</span>) {</span><br><span class="line">            <span class="comment">// 添加</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">saveRole</span>()</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">updateRole</span>()</span><br><span class="line">        }</span><br><span class="line">    },</span><br><span class="line">        <span class="comment">// 添加角色事件</span></span><br><span class="line">        <span class="title function_">saveRole</span>(<span class="params"></span>) {</span><br><span class="line">            api.<span class="title function_">saveRole</span>(<span class="variable language_">this</span>.<span class="property">sysRole</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> {</span><br><span class="line">                <span class="comment">// 1. 出现成功或失败的提示信息</span></span><br><span class="line">                <span class="variable language_">this</span>.$message({</span><br><span class="line">                    <span class="attr">type</span>: <span class="string">'success'</span>,</span><br><span class="line">                    <span class="attr">message</span>: <span class="string">'添加成功'</span>,</span><br><span class="line">                })</span><br><span class="line">                <span class="comment">// 2. 关闭弹窗</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">dialogVisible</span> = <span class="literal">false</span></span><br><span class="line">                <span class="comment">// 3. 刷新数据</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">fetchData</span>()</span><br><span class="line">            })</span><br><span class="line">        },</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ul>
            </li>
            <li>
              <p>编辑按钮事件</p>
              <figure class="highlight js">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// 根据 id 删除<hanla></hanla></span></span><br><span class="line"><span class="title function_">removeDataById</span>(<span class="params">id</span>) {</span><br><span class="line">    <span class="comment">// debugger</span></span><br><span class="line">    <span class="variable language_">this</span>.$confirm(<span class="string">'此操作将永久删除该角色, 是否继续?'</span>, <span class="string">'提示'</span>, {</span><br><span class="line">        <span class="attr">confirmButtonText</span>: <span class="string">'确定'</span>,</span><br><span class="line">        <span class="attr">cancelButtonText</span>: <span class="string">'取消'</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">'warning'</span>,</span><br><span class="line">    }).<span class="title function_">then</span>(<span class="function">() =&gt;</span> {</span><br><span class="line">        <span class="comment">// promise</span></span><br><span class="line">        <span class="comment">// 点击确定，远程调用 ajax</span></span><br><span class="line">        api.<span class="title function_">removeById</span>(id).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> {</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(res.<span class="property">message</span> || <span class="string">'删除成功'</span>)</span><br><span class="line">        })</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">fetchData</span>(<span class="variable language_">this</span>.<span class="property">page</span>)</span><br><span class="line">    })</span><br><span class="line">},</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>更新按钮事件</p>
              <figure class="highlight js">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// 更新角色事件<hanla></hanla></span></span><br><span class="line"><span class="title function_">updateRole</span>(<span class="params"></span>) {</span><br><span class="line">    api.<span class="title function_">update</span>(<span class="variable language_">this</span>.<span class="property">sysRole</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> {</span><br><span class="line">        <span class="comment">// 1. 出现成功或失败的提示信息</span></span><br><span class="line">        <span class="variable language_">this</span>.$message({</span><br><span class="line">            <span class="attr">type</span>: <span class="string">'success'</span>,</span><br><span class="line">            <span class="attr">message</span>: <span class="string">'更新成功'</span>,</span><br><span class="line">        })</span><br><span class="line">        <span class="comment">// 2. 关闭弹窗</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">dialogVisible</span> = <span class="literal">false</span></span><br><span class="line">        <span class="comment">// 3. 刷新数据</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">fetchData</span>()</span><br><span class="line">    })</span><br><span class="line">},</span><br><span class="line">    <span class="comment">// 修改-回显数据</span></span><br><span class="line">    <span class="title function_">edit</span>(<span class="params">id</span>) {</span><br><span class="line">        <span class="comment">// 显示弹窗</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">dialogVisible</span> = <span class="literal">true</span></span><br><span class="line">        <span class="comment">// 修改数据</span></span><br><span class="line">        api.<span class="title function_">getRoleId</span>(id).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> {</span><br><span class="line">            <span class="comment">// 将获取到的数据赋值,<hanla></hanla>通过双向绑定回显数据</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">sysRole</span> = res.<span class="property">data</span></span><br><span class="line">        })</span><br><span class="line">    },</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <table>
                <thead>
                  <tr>
                    <th align="center">添加<hanla></hanla>/<hanla></hanla>修改弹窗</th>
                    <th align="center">编辑回显数据</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/a8cc9d8c25a04079b53b8186368835ef.png"></td>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/5fa62ec2dad4422bae1870cd9c07539a.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p>批量删除</p>
              <ul>
                <li>
                  <p>定义<hanla></hanla><code>api</code></p>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// 根据 id 批量删除</span></span><br><span class="line">  <span class="title function_">batchRemove</span>(<span class="params">idList</span>) {</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">      <span class="attr">url</span>: <span class="string">`<span class="subst">${API_PATH}</span>/batchRemove`</span>,</span><br><span class="line">      <span class="attr">method</span>: <span class="string">"delete"</span>,</span><br><span class="line">      <span class="attr">data</span>: idList,</span><br><span class="line">    });</span><br><span class="line">  },</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>前后端参数数据模型</p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">数据模型</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/d1385eb70ecb4f83b09823569eeef985.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p>复选框实现</p>
                  <figure class="highlight html">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line">// 在 table 表头内第一行添加<hanla></hanla></span><br><span class="line"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">type</span>=<span class="string">"selection"</span> /&gt;</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">添加位置</th>
                        <th align="center">实现效果</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/f5030297d5ab40199fff71ab97e835e4.png"></td>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/1549c6fed7004751bd8cbeb25e1f7d73.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p>复选框事件</p>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// el-table 添加</span></span><br><span class="line">    &lt;el-table</span><br><span class="line">      v-loading=<span class="string">"listLoading"</span></span><br><span class="line">      :data=<span class="string">"list"</span></span><br><span class="line">      stripe</span><br><span class="line">      border</span><br><span class="line">      style=<span class="string">"width: 100%; margin-top: 10px"</span></span><br><span class="line">      @selection-change=<span class="string">"handleSelectionChange"</span></span><br><span class="line">    &gt;</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// 初始值<hanla></hanla></span></span><br><span class="line"><span class="attr">selectValue</span>: [], <span class="comment">// 复选框选择内容封装 </span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// 复选框发生变化<hanla></hanla>(选中时)<hanla></hanla>时执行<hanla></hanla></span></span><br><span class="line"><span class="title function_">handleSelectionChange</span>(<span class="params">selection</span>) {</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">selectValue</span> = selection</span><br><span class="line">},</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>批量删除</p>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// 批量删除实现<hanla></hanla></span></span><br><span class="line"><span class="title function_">batchRemove</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="comment">// 判断是否可以删除</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">selectValue</span>.<span class="property">length</span> == <span class="number">0</span>) {</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">warning</span>(<span class="string">'请选择要删除的记录'</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.$confirm(<span class="string">'此操作将永久删除该角色, 是否继续?'</span>, <span class="string">'提示'</span>, {</span><br><span class="line">        <span class="attr">confirmButtonText</span>: <span class="string">'确定'</span>,</span><br><span class="line">        <span class="attr">cancelButtonText</span>: <span class="string">'取消'</span>,</span><br><span class="line">        <span class="attr">type</span>: <span class="string">'warning'</span>,</span><br><span class="line">    }).<span class="title function_">then</span>(<span class="function">() =&gt;</span> {</span><br><span class="line">        <span class="comment">// promise</span></span><br><span class="line">        <span class="keyword">var</span> idList = []</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">selectValue</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> {</span><br><span class="line">            idList.<span class="title function_">push</span>(item.<span class="property">id</span>)</span><br><span class="line">        })</span><br><span class="line">        <span class="comment">// 点击确定，远程调用 ajax</span></span><br><span class="line">        api.<span class="title function_">batchRemove</span>(idList).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> {</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(res.<span class="property">message</span> || <span class="string">'批量删除成功'</span>)</span><br><span class="line">            <span class="comment">// 刷新页面数据</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">fetchData</span>(<span class="variable language_">this</span>.<span class="property">page</span>)</span><br><span class="line">        })</span><br><span class="line">    })</span><br><span class="line">},</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ul>
            </li>
          </ul>
          <h5 id="用户管理模块"><a href="#用户管理模块" class="headerlink" title="用户管理模块"></a>用户管理模块</h5>
          <ul>
            <li>
              <p>条件分页查询用户</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// 条件分页查询用户<hanla></hanla></span></span><br><span class="line"><span class="meta">@GetMapping("/{page}/{limit}")</span></span><br><span class="line"><span class="meta">@ApiOperation(value = "用户列表")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">list</span><span class="params">(<span class="meta">@PathVariable</span> Long page, <span class="meta">@PathVariable</span> Long limit, SysUserQueryVo sysUserQueryVo)</span> {</span><br><span class="line">    Page&lt;SysUser&gt; pageParam = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(page, limit);</span><br><span class="line">    IPage&lt;SysUser&gt; pageModel = sysUserService.queryUserPage(pageParam, sysUserQueryVo);</span><br><span class="line">    <span class="keyword">return</span> Result.ok(pageModel);</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight xml">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.example.system.mapper.SysUserMapper"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- IPage&lt;SysUser&gt; queryUserPage(Page pageParam, SysUserQueryVo sysUserQueryVo); --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"sysUserMap"</span> <span class="attr">type</span>=<span class="string">"com.example.model.system.SysUser"</span> <span class="attr">autoMapping</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"columns"</span>&gt;</span></span><br><span class="line">        id ,</span><br><span class="line">                username ,</span><br><span class="line">                password ,</span><br><span class="line">                name ,</span><br><span class="line">                phone ,</span><br><span class="line">                head_url ,</span><br><span class="line">                dept_id ,</span><br><span class="line">                post_id ,</span><br><span class="line">                description ,</span><br><span class="line">                status ,</span><br><span class="line">                create_time ,</span><br><span class="line">                update_time ,</span><br><span class="line">                is_deleted</span><br><span class="line">    <span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserPage"</span> <span class="attr">resultMap</span>=<span class="string">"sysUserMap"</span>&gt;</span></span><br><span class="line">        select</span><br><span class="line">        <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"columns"</span>/&gt;</span></span><br><span class="line">        from sys_user</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"vo.keyword != null and vo.keyword != ''"</span>&gt;</span></span><br><span class="line">                and (username like CONCAT('%',#{vo.keyword},'%') or name like CONCAT('%',#{vo.keyword},'%') or phone</span><br><span class="line">                like CONCAT('%',#{vo.keyword},'%'))</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"vo.createTimeBegin != null and vo.createTimeBegin != ''"</span>&gt;</span></span><br><span class="line">                and create_time &gt;= #{vo.createTimeBegin}</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"vo.createTimeEnd != null and vo.createTimeEnd != ''"</span>&gt;</span></span><br><span class="line">                and create_time <span class="symbol">&amp;lt;</span>= #{vo.createTimeEnd}</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            and is_deleted = 0</span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line">        order by id desc</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>用户添加</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// 用户添加<hanla></hanla></span></span><br><span class="line"><span class="meta">@PostMapping("/save")</span></span><br><span class="line"><span class="meta">@ApiOperation(value = "添加用户")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> SysUser sysUser)</span> {</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">isSuccess</span> <span class="operator">=</span> sysUserService.save(sysUser);</span><br><span class="line">    <span class="keyword">if</span> (isSuccess) {</span><br><span class="line">        <span class="keyword">return</span> Result.ok();</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">return</span> Result.fail();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight js">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="title function_">save</span>(<span class="params">role</span>) {</span><br><span class="line">   <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">     <span class="attr">url</span>: <span class="string">`<span class="subst">${api_name}</span>/save`</span>,</span><br><span class="line">     <span class="attr">method</span>: <span class="string">"post"</span>,</span><br><span class="line">     <span class="attr">data</span>: role,</span><br><span class="line">   });</span><br><span class="line"> },</span><br><span class="line">  </span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>用户修改</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// 用户修改<hanla></hanla></span></span><br><span class="line"><span class="comment">// 1. 1 根据 id 查询<hanla></hanla></span></span><br><span class="line"><span class="meta">@GetMapping("/get/{id}")</span></span><br><span class="line"><span class="meta">@ApiOperation(value = "根据<hanla></hanla>id<hanla></hanla>查询用户")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">getUserById</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span> {</span><br><span class="line">    <span class="type">SysUser</span> <span class="variable">sysUser</span> <span class="operator">=</span> sysUserService.getById(id);</span><br><span class="line">    <span class="keyword">return</span> Result.ok(sysUser);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1.2 更新<hanla></hanla></span></span><br><span class="line"><span class="meta">@PutMapping("/update")</span></span><br><span class="line"><span class="meta">@ApiOperation(value = "更新用户")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> SysUser sysUser)</span> {</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">isSuccess</span> <span class="operator">=</span> sysUserService.updateById(sysUser);</span><br><span class="line">    <span class="keyword">if</span> (isSuccess) {</span><br><span class="line">        <span class="keyword">return</span> Result.ok();</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">return</span> Result.fail();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight js">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"></span><br><span class="line"><span class="title function_">getById</span>(<span class="params">id</span>) {</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">        <span class="attr">url</span>: <span class="string">`<span class="subst">${api_name}</span>/get/<span class="subst">${id}</span>`</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">"get"</span>,</span><br><span class="line">    });</span><br><span class="line">},</span><br><span class="line">    <span class="title function_">update</span>(<span class="params">role</span>) {</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">            <span class="attr">url</span>: <span class="string">`<span class="subst">${api_name}</span>/update`</span>,</span><br><span class="line">            <span class="attr">method</span>: <span class="string">"put"</span>,</span><br><span class="line">            <span class="attr">data</span>: role,</span><br><span class="line">        });</span><br><span class="line">    },</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>用户删除</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// 用户删除<hanla></hanla></span></span><br><span class="line"><span class="meta">@DeleteMapping("/remove/{id}")</span></span><br><span class="line"><span class="meta">@ApiOperation(value = "删除用户")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">removeById</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span> {</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">isSuccess</span> <span class="operator">=</span> sysUserService.removeById(id);</span><br><span class="line">    <span class="keyword">if</span> (isSuccess) {</span><br><span class="line">        <span class="keyword">return</span> Result.ok();</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">return</span> Result.fail();</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight js">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="title function_">removeById</span>(<span class="params">id</span>) {</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">        <span class="attr">url</span>: <span class="string">`<span class="subst">${api_name}</span>/remove/<span class="subst">${id}</span>`</span>,</span><br><span class="line">        <span class="attr">method</span>: <span class="string">"delete"</span>,</span><br><span class="line">    });</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>为用户分配角色</p>
              <blockquote>
                <p>一个用户可以有多个角色</p>
                <p>一个角色可以有多个用户</p>
              </blockquote>
              <table>
                <thead>
                  <tr>
                    <th align="center">关系描述</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/3fd02322f0dd43ea87f88343c78da3e2.png"></td>
                  </tr>
                </tbody>
              </table>
              <ul>
                <li>
                  <p>接口分析</p>
                  <ol>
                    <li>进入分配页面: 获取已分配角色与全部角色,<hanla></hanla>进行页面展示<ul>
                        <li>查询用户已经分配的角色和全部角色，页面显示</li>
                      </ul>
                    </li>
                    <li>保存分配角色: 删除之前分配的角色和保存现在分配的角色<ul>
                        <li>删除之前已经分配的角色</li>
                        <li>保存新分配的角色</li>
                      </ul>
                    </li>
                  </ol>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// <span class="doctag">TODO:</span> 2022-12-15 16:54 添加角色分配接口<hanla></hanla></span></span><br><span class="line"><span class="meta">@ApiOperation("根据用户获取角色数据")</span></span><br><span class="line"><span class="meta">@GetMapping("/toAssign/{userId}")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">toAssign</span><span class="params">(<span class="meta">@PathVariable</span> String userId)</span> {</span><br><span class="line">    Map&lt;String, Object&gt; roleMap = sysRoleService.getRolesByUserId(userId);</span><br><span class="line">    <span class="keyword">return</span> Result.ok(roleMap);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// <span class="doctag">TODO:</span> 用户重新分配角色<hanla></hanla></span></span><br><span class="line"><span class="meta">@ApiOperation("用户分配<hanla></hanla>(重新)<hanla></hanla>角色")</span></span><br><span class="line"><span class="meta">@PostMapping("/doAssign")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">doAssign</span><span class="params">(<span class="meta">@RequestBody</span> AssginRoleVo assginRoleVo)</span> {</span><br><span class="line">    <span class="comment">// 给用户分配角色</span></span><br><span class="line">    sysRoleService.doAssign(assginRoleVo);</span><br><span class="line">    <span class="keyword">return</span> Result.ok();</span><br><span class="line">}</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">package</span> com.example.system.service.impl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysRoleServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;SysRoleMapper, SysRole&gt; <span class="keyword">implements</span> <span class="title class_">SysRoleService</span> {</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserRoleMapper sysUserRoleMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 条件分页查询</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> IPage&lt;SysRole&gt; <span class="title function_">queryPage</span><span class="params">(Page&lt;SysRole&gt; pageparam, SysRoleQueryVo sysRoleQueryVo)</span> {</span><br><span class="line">        IPage&lt;SysRole&gt; pageModel = baseMapper.queryPage(pageparam, sysRoleQueryVo);</span><br><span class="line">        <span class="keyword">return</span> pageModel;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> 难点一</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">getRolesByUserId</span><span class="params">(String userId)</span> {</span><br><span class="line">        <span class="comment">// 获取所有角色</span></span><br><span class="line">        List&lt;SysRole&gt; roleList = baseMapper.selectList(<span class="literal">null</span>);</span><br><span class="line">        <span class="comment">// 根据用户 id 查询,<hanla></hanla>也就是查询用户已经分配的角色</span></span><br><span class="line">        QueryWrapper&lt;SysUserRole&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.eq(<span class="string">"user_id"</span>, userId);</span><br><span class="line">        List&lt;SysUserRole&gt; userRoles = sysUserRoleMapper.selectList(wrapper);</span><br><span class="line">        <span class="comment">// 从 userRoles 集合中获取所有角色 id</span></span><br><span class="line">        List&lt;String&gt; userRoleIds = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        userRoles.forEach(userRole -&gt; {</span><br><span class="line">            <span class="type">String</span> <span class="variable">roleId</span> <span class="operator">=</span> userRole.getRoleId();</span><br><span class="line">            userRoleIds.add(roleId);</span><br><span class="line">        });</span><br><span class="line">        <span class="comment">// 封装到 map 集合</span></span><br><span class="line">        Map&lt;String, Object&gt; returnMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// 所有角色</span></span><br><span class="line">        returnMap.put(<span class="string">"allRoles"</span>, roleList);</span><br><span class="line">        <span class="comment">// 用户分配角色 id 集合</span></span><br><span class="line">        returnMap.put(<span class="string">"userRoleIds"</span>, userRoleIds);</span><br><span class="line">        <span class="keyword">return</span> returnMap;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 给用户分配角色</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doAssign</span><span class="params">(AssginRoleVo assginRoleVo)</span> {</span><br><span class="line">        <span class="comment">// 根据用户<hanla></hanla>id<hanla></hanla>删除之前分配角色</span></span><br><span class="line">        QueryWrapper&lt;SysUserRole&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.eq(<span class="string">"user_id"</span>, assginRoleVo.getUserId());</span><br><span class="line">        sysUserRoleMapper.delete(wrapper);</span><br><span class="line">        <span class="comment">// 获取所有角色 id,<hanla></hanla>添加角色用户关系表</span></span><br><span class="line">        <span class="comment">// 角色 id 列表</span></span><br><span class="line">        List&lt;String&gt; roleIdList = assginRoleVo.getRoleIdList();</span><br><span class="line">        <span class="keyword">for</span> (String roleId : roleIdList) {</span><br><span class="line">            <span class="type">SysUserRole</span> <span class="variable">sysUserRole</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SysUserRole</span>();</span><br><span class="line">            sysUserRole.setUserId(assginRoleVo.getUserId());</span><br><span class="line">            sysUserRole.setRoleId(roleId);</span><br><span class="line">            sysUserRoleMapper.insert(sysUserRole);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">分配角色</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/ab8a9b35d95a42f5b6ad4152a1aa485f.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
              </ul>
            </li>
          </ul>
          <h5 id="菜单管理模块"><a href="#菜单管理模块" class="headerlink" title="菜单管理模块"></a>菜单管理模块</h5>
          <ul>
            <li>
              <p>接口实现</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="meta">@ApiOperation("菜单列表<hanla></hanla>(树形显示)")</span></span><br><span class="line"><span class="meta">@GetMapping("findNodes")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">findNodes</span><span class="params">()</span> {</span><br><span class="line">    List&lt;SysMenu&gt; list = sysMenuService.findNodes();</span><br><span class="line">    <span class="keyword">return</span> Result.ok(list);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@ApiOperation("删除菜单")</span></span><br><span class="line"><span class="meta">@DeleteMapping("/remove/{id}")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">remove</span><span class="params">(<span class="meta">@PathVariable</span> String id)</span> {</span><br><span class="line">    sysMenuService.removeMenuById(id);</span><br><span class="line">    <span class="keyword">return</span> Result.ok();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加菜单<hanla></hanla></span></span><br><span class="line"><span class="meta">@ApiOperation("添加菜单")</span></span><br><span class="line"><span class="meta">@PostMapping("save")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> SysMenu sysMenu)</span> {</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">isSuccess</span> <span class="operator">=</span> sysMenuService.save(sysMenu);</span><br><span class="line">    <span class="keyword">if</span> (isSuccess) {</span><br><span class="line">        <span class="keyword">return</span> Result.ok().message(<span class="string">"添加成功"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> Result.fail().message(<span class="string">"添加失败"</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据 id 查询<hanla></hanla></span></span><br><span class="line"><span class="comment">// 添加菜单<hanla></hanla></span></span><br><span class="line"><span class="meta">@ApiOperation("根据 id 查询菜单")</span></span><br><span class="line"><span class="meta">@GetMapping("findNode/{id}")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">save</span><span class="params">(<span class="meta">@PathVariable</span> String id)</span> {</span><br><span class="line">    <span class="type">SysMenu</span> <span class="variable">sysMenu</span> <span class="operator">=</span> sysMenuService.getById(id);</span><br><span class="line">    <span class="keyword">return</span> Result.ok(sysMenu);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改<hanla></hanla></span></span><br><span class="line"><span class="meta">@ApiOperation("修改菜单")</span></span><br><span class="line"><span class="meta">@PostMapping("/update")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> SysMenu sysMenu)</span> {</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">isSuccess</span> <span class="operator">=</span> sysMenuService.updateById(sysMenu);</span><br><span class="line">    <span class="keyword">if</span> (isSuccess) {</span><br><span class="line">        <span class="keyword">return</span> Result.ok().message(<span class="string">"更新成功"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> Result.fail().message(<span class="string">"更新失败"</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">@ApiOperation("删除菜单")</span></span><br><span class="line"><span class="meta">@DeleteMapping("/remove/{id}")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">remove</span><span class="params">(<span class="meta">@PathVariable</span> String id)</span> {</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">isSuccess</span> <span class="operator">=</span> sysMenuService.removeById(id);</span><br><span class="line">    <span class="keyword">if</span> (isSuccess) {</span><br><span class="line">        <span class="keyword">return</span> Result.ok().message(<span class="string">"删除成功"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> Result.fail().message(<span class="string">"删除失败"</span>);</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.example.system.service.impl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 菜单表 服务实现类</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> coder-itl</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2022-12-17</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysMenuServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;SysMenuMapper, SysMenu&gt; <span class="keyword">implements</span> <span class="title class_">SysMenuService</span> {</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 菜单列表,<hanla></hanla>树形显示</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;SysMenu&gt; <span class="title function_">findNodes</span><span class="params">()</span> {</span><br><span class="line">        <span class="comment">// 获取所有菜单</span></span><br><span class="line">        List&lt;SysMenu&gt; sysMenuList = baseMapper.selectList(<span class="literal">null</span>);</span><br><span class="line">        <span class="comment">// 所有菜单数据转换为要求的数据格式</span></span><br><span class="line">        List&lt;SysMenu&gt; resultList = MenuHelper.buildTree(sysMenuList);</span><br><span class="line">        <span class="keyword">return</span> resultList;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除菜单</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeMenuById</span><span class="params">(String id)</span> {</span><br><span class="line">        <span class="comment">// 查询当前删除菜单下面是否有子菜单</span></span><br><span class="line">        <span class="comment">// 根据 id==parentId</span></span><br><span class="line">        QueryWrapper&lt;SysMenu&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.eq(<span class="string">"parent_id"</span>, id);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> baseMapper.selectCount(wrapper);</span><br><span class="line">        <span class="keyword">if</span> (count &gt; <span class="number">0</span>) {</span><br><span class="line">            <span class="comment">// 子菜单存在</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">coderItlException</span>(<span class="number">201</span>, <span class="string">"请先删除子菜单"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">// 调用删除</span></span><br><span class="line">        baseMapper.deleteById(id);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>前端路由</p>
              <figure class="highlight js">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">{</span><br><span class="line">        <span class="attr">name</span>: <span class="string">"sysMenu"</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="string">"sysMenu"</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">"@/views/system/sysMenu/list"</span>),</span><br><span class="line">        <span class="attr">meta</span>: {</span><br><span class="line">          <span class="attr">title</span>: <span class="string">"菜单管理"</span>,</span><br><span class="line">          <span class="attr">icon</span>: <span class="string">"el-icon-s-unfold"</span>,</span><br><span class="line">        },</span><br><span class="line">      },</span><br><span class="line">      {</span><br><span class="line">        <span class="attr">path</span>: <span class="string">"assignAuth"</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="keyword">import</span>(<span class="string">"@/views/system/sysRole/assignAuth"</span>),</span><br><span class="line">        <span class="attr">meta</span>: {</span><br><span class="line">          <span class="attr">activeMenu</span>: <span class="string">"/system/sysRole"</span>,</span><br><span class="line">          <span class="attr">title</span>: <span class="string">"角色授权"</span>,</span><br><span class="line">        },</span><br><span class="line">        <span class="attr">hidden</span>: <span class="literal">true</span>,</span><br><span class="line">      },</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>工具类</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">package</span> com.example.system.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.model.system.SysMenu;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MenuHelper</span> {</span><br><span class="line">    <span class="comment">// 构建树形结构</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;SysMenu&gt; <span class="title function_">buildTree</span><span class="params">(List&lt;SysMenu&gt; sysMenuList)</span> {</span><br><span class="line">        <span class="comment">// 创建集合封装最终数据</span></span><br><span class="line">        List&lt;SysMenu&gt; trees = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// 遍历所有菜单集合</span></span><br><span class="line">        <span class="keyword">for</span> (SysMenu sysMenu : sysMenuList) {</span><br><span class="line">            <span class="comment">// 找到递归入口</span></span><br><span class="line">            <span class="keyword">if</span> (sysMenu.getParentId().longValue() == <span class="number">0</span>) {</span><br><span class="line">                trees.add(findChildren(sysMenu, sysMenuList));</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> trees;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 从根节点进行递归查询,<hanla></hanla>查询是否存在子节点</span></span><br><span class="line"><span class="comment">     * 判断 id == parentId 是否相同,<hanla></hanla>如果相同是子节点,<hanla></hanla>进行数据封装</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sysMenu</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> treeNodes</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SysMenu <span class="title function_">findChildren</span><span class="params">(SysMenu sysMenu, List&lt;SysMenu&gt; treeNodes)</span> {</span><br><span class="line">        <span class="comment">// 数据初始化</span></span><br><span class="line">        sysMenu.setChildren(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;SysMenu&gt;());</span><br><span class="line">        <span class="comment">// 遍历递归查找</span></span><br><span class="line">        <span class="keyword">for</span> (SysMenu it : treeNodes) {</span><br><span class="line">            <span class="comment">// 获取当前菜单 id</span></span><br><span class="line">            <span class="comment">// String id = sysMenu.getId();</span></span><br><span class="line">            <span class="comment">// 数据类型转换处理</span></span><br><span class="line">            <span class="comment">// long lid = Long.parseLong(id);</span></span><br><span class="line">            <span class="comment">// 获取所有菜单的 parentId</span></span><br><span class="line">            <span class="comment">// Long parentId = it.getParentId();</span></span><br><span class="line">            <span class="comment">// 比对</span></span><br><span class="line">            <span class="keyword">if</span> (Long.parseLong(sysMenu.getId()) == it.getParentId()) {</span><br><span class="line">                <span class="keyword">if</span> (sysMenu.getChildren() == <span class="literal">null</span>) {</span><br><span class="line">                    sysMenu.setChildren(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;SysMenu&gt;());</span><br><span class="line">                }</span><br><span class="line">                <span class="comment">// 递归查找</span></span><br><span class="line">                sysMenu.getChildren().add(findChildren(it, treeNodes));</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> sysMenu;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>前端接口定义</p>
              <figure class="highlight js">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// sysMenu.js</span></span><br><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">'@/utils/request'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"><hanla></hanla>菜单管理相关的<hanla></hanla>API<hanla></hanla>请求函数<hanla></hanla></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> api_name = <span class="string">'/admin/system/sysMenu'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> {</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  获取权限<hanla></hanla>(菜单<hanla></hanla>/<hanla></hanla>功能)<hanla></hanla>列表</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="title function_">findNodes</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">      <span class="attr">url</span>: <span class="string">`<span class="subst">${api_name}</span>/findNodes`</span>,</span><br><span class="line">      <span class="attr">method</span>: <span class="string">'get'</span></span><br><span class="line">    })</span><br><span class="line">  },</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  删除</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="title function_">removeById</span>(<span class="params">id</span>) {</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">      <span class="attr">url</span>: <span class="string">`<span class="subst">${api_name}</span>/remove/<span class="subst">${id}</span>`</span>,</span><br><span class="line">      <span class="attr">method</span>: <span class="string">"delete"</span></span><br><span class="line">    })</span><br><span class="line">  },</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  保存</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="title function_">save</span>(<span class="params">sysMenu</span>) {</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">      <span class="attr">url</span>: <span class="string">`<span class="subst">${api_name}</span>/save`</span>,</span><br><span class="line">      <span class="attr">method</span>: <span class="string">"post"</span>,</span><br><span class="line">      <span class="attr">data</span>: sysMenu</span><br><span class="line">    })</span><br><span class="line">  },</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  更新</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="title function_">updateById</span>(<span class="params">sysMenu</span>) {</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>({</span><br><span class="line">      <span class="attr">url</span>: <span class="string">`<span class="subst">${api_name}</span>/update`</span>,</span><br><span class="line">      <span class="attr">method</span>: <span class="string">"put"</span>,</span><br><span class="line">      <span class="attr">data</span>: sysMenu</span><br><span class="line">    })</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>渲染</p>
              <table>
                <thead>
                  <tr>
                    <th align="center">页面渲染</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/b9adcb5168f9489b8de5d1f9549a880b.png"></td>
                  </tr>
                </tbody>
              </table>
              <figure class="highlight html">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"app-container"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 工具条 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tools-div"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"success"</span> <span class="attr">icon</span>=<span class="string">"el-icon-plus"</span> <span class="attr">size</span>=<span class="string">"mini"</span> @<span class="attr">click</span>=<span class="string">"add()"</span></span></span><br><span class="line"><span class="tag">        &gt;</span><hanla></hanla>添 加<hanla></hanla></span><br><span class="line">      &gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:data</span>=<span class="string">"sysMenuList"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">"width: 100%; margin-bottom: 20px; margin-top: 10px"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">row-key</span>=<span class="string">"id"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">border</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:default-expand-all</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:tree-props</span>=<span class="string">"{ children: 'children' }"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"name"</span> <span class="attr">label</span>=<span class="string">"菜单名称"</span> <span class="attr">width</span>=<span class="string">"160"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">"图标"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">:class</span>=<span class="string">"scope.row.icon"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"perms"</span> <span class="attr">label</span>=<span class="string">"权限标识"</span> <span class="attr">width</span>=<span class="string">"160"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"path"</span> <span class="attr">label</span>=<span class="string">"路由地址"</span> <span class="attr">width</span>=<span class="string">"120"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"component"</span> <span class="attr">label</span>=<span class="string">"组件路径"</span> <span class="attr">width</span>=<span class="string">"160"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"sortValue"</span> <span class="attr">label</span>=<span class="string">"排序"</span> <span class="attr">width</span>=<span class="string">"60"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">"状态"</span> <span class="attr">width</span>=<span class="string">"80"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-switch</span> <span class="attr">v-model</span>=<span class="string">"scope.row.status === 1"</span> <span class="attr">disabled</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-switch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">"createTime"</span> <span class="attr">label</span>=<span class="string">"创建时间"</span> <span class="attr">width</span>=<span class="string">"160"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">"操作"</span> <span class="attr">width</span>=<span class="string">"180"</span> <span class="attr">align</span>=<span class="string">"center"</span> <span class="attr">fixed</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">"scope"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">"success"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-if</span>=<span class="string">"scope.row.type !== 2"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">icon</span>=<span class="string">"el-icon-plus"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">size</span>=<span class="string">"mini"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">"add(scope.row)"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">title</span>=<span class="string">"添加下级节点"</span></span></span><br><span class="line"><span class="tag">          /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">"primary"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">icon</span>=<span class="string">"el-icon-edit"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">size</span>=<span class="string">"mini"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">"edit(scope.row)"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">title</span>=<span class="string">"修改"</span></span></span><br><span class="line"><span class="tag">          /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">"danger"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">icon</span>=<span class="string">"el-icon-delete"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">size</span>=<span class="string">"mini"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">click</span>=<span class="string">"removeDataById(scope.row.id)"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">title</span>=<span class="string">"删除"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:disabled</span>=<span class="string">"scope.row.children.length &gt; 0"</span></span></span><br><span class="line"><span class="tag">          /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">:title</span>=<span class="string">"dialogTitle"</span> <span class="attr">:visible.sync</span>=<span class="string">"dialogVisible"</span> <span class="attr">width</span>=<span class="string">"40%"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form</span></span></span><br><span class="line"><span class="tag">        <span class="attr">ref</span>=<span class="string">"dataForm"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:model</span>=<span class="string">"sysMenu"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">label-width</span>=<span class="string">"150px"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">size</span>=<span class="string">"small"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">"padding-right: 40px"</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"上级部门"</span> <span class="attr">v-if</span>=<span class="string">"sysMenu.id === ''"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"sysMenu.parentName"</span> <span class="attr">disabled</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"菜单类型"</span> <span class="attr">prop</span>=<span class="string">"type"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-radio-group</span> <span class="attr">v-model</span>=<span class="string">"sysMenu.type"</span> <span class="attr">:disabled</span>=<span class="string">"typeDisabled"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">:label</span>=<span class="string">"0"</span> <span class="attr">:disabled</span>=<span class="string">"type0Disabled"</span>&gt;</span><hanla></hanla>目录<hanla></hanla><span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">:label</span>=<span class="string">"1"</span> <span class="attr">:disabled</span>=<span class="string">"type1Disabled"</span>&gt;</span><hanla></hanla>菜单<hanla></hanla><span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">:label</span>=<span class="string">"2"</span> <span class="attr">:disabled</span>=<span class="string">"type2Disabled"</span>&gt;</span><hanla></hanla>按钮<hanla></hanla><span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-radio-group</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"菜单名称"</span> <span class="attr">prop</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"sysMenu.name"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"图标"</span> <span class="attr">prop</span>=<span class="string">"icon"</span> <span class="attr">v-if</span>=<span class="string">"sysMenu.type !== 2"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">"sysMenu.icon"</span> <span class="attr">clearable</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-option</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-for</span>=<span class="string">"item in iconList"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:key</span>=<span class="string">"item.class"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:label</span>=<span class="string">"item.class"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:value</span>=<span class="string">"item.class"</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"float: left"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">i</span> <span class="attr">:class</span>=<span class="string">"item.class"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 如果动态显示图标，这里添加判断 --&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"padding-left: 6px"</span>&gt;</span>{{ item.class }}<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"排序"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-input-number</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-model</span>=<span class="string">"sysMenu.sortValue"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">controls-position</span>=<span class="string">"right"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:min</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">          /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">prop</span>=<span class="string">"path"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-tooltip</span> <span class="attr">content</span>=<span class="string">"访问的路由地址，如：`sysUser`"</span> <span class="attr">placement</span>=<span class="string">"top"</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"el-icon-question"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-tooltip</span>&gt;</span></span><br><span class="line">            路由地址</span><br><span class="line">          <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"sysMenu.path"</span> <span class="attr">placeholder</span>=<span class="string">"请输入路由地址"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">prop</span>=<span class="string">"component"</span> <span class="attr">v-if</span>=<span class="string">"sysMenu.type !== 0"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-tooltip</span></span></span><br><span class="line"><span class="tag">              <span class="attr">content</span>=<span class="string">"访问的组件路径，如：`system/user/index`，默认在`views`目录下"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">placement</span>=<span class="string">"top"</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"el-icon-question"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-tooltip</span>&gt;</span></span><br><span class="line">            组件路径</span><br><span class="line">          <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">"sysMenu.component"</span> <span class="attr">placeholder</span>=<span class="string">"请输入组件路径"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">v-if</span>=<span class="string">"sysMenu.type === 2"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-input</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-model</span>=<span class="string">"sysMenu.perms"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">placeholder</span>=<span class="string">"请输入权限标识"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">maxlength</span>=<span class="string">"100"</span></span></span><br><span class="line"><span class="tag">          /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">"label"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-tooltip</span></span></span><br><span class="line"><span class="tag">              <span class="attr">content</span>=<span class="string">"控制器中定义的权限字符，如：@PreAuthorize(hasAuthority('bnt.sysRole.list'))"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">placement</span>=<span class="string">"top"</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"el-icon-question"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-tooltip</span>&gt;</span></span><br><span class="line">            权限字符</span><br><span class="line">          <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">"状态"</span> <span class="attr">prop</span>=<span class="string">"type"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-radio-group</span> <span class="attr">v-model</span>=<span class="string">"sysMenu.status"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">:label</span>=<span class="string">"1"</span>&gt;</span><hanla></hanla>正常<hanla></hanla><span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">:label</span>=<span class="string">"0"</span>&gt;</span><hanla></hanla>停用<hanla></hanla><span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-radio-group</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">"footer"</span> <span class="attr">class</span>=<span class="string">"dialog-footer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">"dialogVisible = false"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">"small"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">icon</span>=<span class="string">"el-icon-refresh-right"</span></span></span><br><span class="line"><span class="tag">          &gt;</span><hanla></hanla>取 消<hanla></hanla></span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">"primary"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">icon</span>=<span class="string">"el-icon-check"</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">"saveOrUpdate()"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">"small"</span></span></span><br><span class="line"><span class="tag">          &gt;</span><hanla></hanla>确 定<hanla></hanla></span><br><span class="line">        &gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> api <span class="keyword">from</span> <span class="string">'@/api/system/sysMenu'</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> defaultForm = {</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">id</span>: <span class="string">''</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">parentId</span>: <span class="string">''</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">name</span>: <span class="string">''</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">type</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">path</span>: <span class="string">''</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">component</span>: <span class="string">''</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">perms</span>: <span class="string">''</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">icon</span>: <span class="string">''</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">sortValue</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">status</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> {</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 定义数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">data</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> {</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">sysMenuList</span>: [],</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">expandKeys</span>: [], <span class="comment">// 需要自动展开的项</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">typeDisabled</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type0Disabled</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type1Disabled</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type2Disabled</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">dialogTitle</span>: <span class="string">''</span>,</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">dialogVisible</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">sysMenu</span>: defaultForm,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">saveBtnDisabled</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">iconList</span>: [</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-s-tools'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-s-custom'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-setting'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-user-solid'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-s-help'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-phone'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-s-unfold'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-s-operation'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-more-outline'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-s-check'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-tickets'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-s-goods'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-document-remove'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-warning'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-warning-outline'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-question'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">        {</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">class</span>: <span class="string">'el-icon-info'</span>,</span></span><br><span class="line"><span class="language-javascript">        },</span></span><br><span class="line"><span class="language-javascript">      ],</span></span><br><span class="line"><span class="language-javascript">    }</span></span><br><span class="line"><span class="language-javascript">  },</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//<hanla></hanla>当页面加载时获取数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">created</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">this</span>.<span class="title function_">fetchData</span>()</span></span><br><span class="line"><span class="language-javascript">  },</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="attr">methods</span>: {</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//<hanla></hanla>调用<hanla></hanla>api<hanla></hanla>层获取数据库中的数据</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">fetchData</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">'加载列表'</span>)</span></span><br><span class="line"><span class="language-javascript">      api.<span class="title function_">findNodes</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> {</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">sysMenuList</span> = response.<span class="property">data</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">sysMenuList</span>)</span></span><br><span class="line"><span class="language-javascript">      })</span></span><br><span class="line"><span class="language-javascript">    },</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//<hanla></hanla>根据<hanla></hanla>id<hanla></hanla>删除数据</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">removeDataById</span>(<span class="params">id</span>) {</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// debugger</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.$confirm(<span class="string">'此操作将永久删除该记录, 是否继续?'</span>, <span class="string">'提示'</span>, {</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">confirmButtonText</span>: <span class="string">'确定'</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">cancelButtonText</span>: <span class="string">'取消'</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="string">'warning'</span>,</span></span><br><span class="line"><span class="language-javascript">      })</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">then</span>(<span class="function">() =&gt;</span> {</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// promise</span></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 点击确定，远程调用<hanla></hanla>ajax</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> api.<span class="title function_">removeById</span>(id)</span></span><br><span class="line"><span class="language-javascript">        })</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> {</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="title function_">fetchData</span>()</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.$message({</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">type</span>: <span class="string">'success'</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">message</span>: response.<span class="property">message</span>,</span></span><br><span class="line"><span class="language-javascript">          })</span></span><br><span class="line"><span class="language-javascript">        })</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> {</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">info</span>(<span class="string">'取消删除'</span>)</span></span><br><span class="line"><span class="language-javascript">        })</span></span><br><span class="line"><span class="language-javascript">    },</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//<hanla></hanla>弹出添加或更新的表单</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">add</span>(<span class="params">row</span>) {</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">debugger</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">typeDisabled</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">dialogTitle</span> = <span class="string">'添加下级节点'</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">dialogVisible</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">sysMenu</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>({}, defaultForm)</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">sysMenu</span>.<span class="property">id</span> = <span class="string">''</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (row) {</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">sysMenu</span>.<span class="property">parentId</span> = row.<span class="property">id</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">sysMenu</span>.<span class="property">parentName</span> = row.<span class="property">name</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//this.sysMenu.component = 'ParentView'</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (row.<span class="property">type</span> === <span class="number">0</span>) {</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">sysMenu</span>.<span class="property">type</span> = <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">typeDisabled</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">type0Disabled</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">type1Disabled</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">type2Disabled</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">        } <span class="keyword">else</span> <span class="keyword">if</span> (row.<span class="property">type</span> === <span class="number">1</span>) {</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">sysMenu</span>.<span class="property">type</span> = <span class="number">2</span></span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">typeDisabled</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">        }</span></span><br><span class="line"><span class="language-javascript">      } <span class="keyword">else</span> {</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">dialogTitle</span> = <span class="string">'添加目录节点'</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">sysMenu</span>.<span class="property">type</span> = <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">sysMenu</span>.<span class="property">component</span> = <span class="string">'Layout'</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">sysMenu</span>.<span class="property">parentId</span> = <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">typeDisabled</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">      }</span></span><br><span class="line"><span class="language-javascript">    },</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//<hanla></hanla>编辑</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">edit</span>(<span class="params">row</span>) {</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">debugger</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">dialogTitle</span> = <span class="string">'修改菜单'</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">dialogVisible</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">sysMenu</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>({}, row)</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">typeDisabled</span> = <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">    },</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//<hanla></hanla>添加或更新</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">saveOrUpdate</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">sysMenu</span>.<span class="property">type</span> === <span class="number">0</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">sysMenu</span>.<span class="property">parentId</span> !== <span class="number">0</span>) {</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">sysMenu</span>.<span class="property">component</span> = <span class="string">'ParentView'</span></span></span><br><span class="line"><span class="language-javascript">      }</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">dataForm</span>.<span class="title function_">validate</span>(<span class="function">(<span class="params">valid</span>) =&gt;</span> {</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (valid) {</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="property">saveBtnDisabled</span> = <span class="literal">true</span> <span class="comment">// 防止表单重复提交</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">sysMenu</span>.<span class="property">id</span>) {</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="title function_">save</span>()</span></span><br><span class="line"><span class="language-javascript">          } <span class="keyword">else</span> {</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="title function_">update</span>()</span></span><br><span class="line"><span class="language-javascript">          }</span></span><br><span class="line"><span class="language-javascript">        }</span></span><br><span class="line"><span class="language-javascript">      })</span></span><br><span class="line"><span class="language-javascript">    },</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//<hanla></hanla>添加</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">save</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">      api.<span class="title function_">save</span>(<span class="variable language_">this</span>.<span class="property">sysMenu</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> {</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(response.<span class="property">message</span> || <span class="string">'操作成功'</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">dialogVisible</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">fetchData</span>(<span class="variable language_">this</span>.<span class="property">page</span>)</span></span><br><span class="line"><span class="language-javascript">      })</span></span><br><span class="line"><span class="language-javascript">    },</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//<hanla></hanla>更新</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">update</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">      api.<span class="title function_">updateById</span>(<span class="variable language_">this</span>.<span class="property">sysMenu</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> {</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">success</span>(response.<span class="property">message</span> || <span class="string">'操作成功'</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">dialogVisible</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">fetchData</span>()</span></span><br><span class="line"><span class="language-javascript">      })</span></span><br><span class="line"><span class="language-javascript">    },</span></span><br><span class="line"><span class="language-javascript">  },</span></span><br><span class="line"><span class="language-javascript">}</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>给角色分配权限</p>
              <ul>
                <li>接口分析<ol>
                    <li>进入分配页面: 获取全部菜单的以及菜单按钮，选中已选复选框,<hanla></hanla>进行页面展示</li>
                    <li>保存分配权限: 删除之前分配的权限和保存现在分配的权限</li>
                  </ol>
                </li>
              </ul>
            </li>
          </ul>
          <h5 id="权限管理"><a href="#权限管理" class="headerlink" title="权限管理"></a>权限管理</h5>
          <ul>
            <li>
              <p>菜单权限</p>
              <blockquote>
                <p>菜单权限就是对页面的控制,<hanla></hanla>就是有这个权限的用户才能访问这个页面,<hanla></hanla>没这个权限的用户就无法访问,<hanla></hanla>它是以整个页面为维度,<hanla></hanla>对权限的控制并没有那么细,<hanla></hanla>所以是一种<code>粗颗粒权限</code></p>
              </blockquote>
            </li>
            <li>
              <p>权限管理设计思路</p>
              <blockquote>
                <p>在用户管理、角色管理以及菜单管理，我们把菜单权限分配给角色，把角色分配给用户,<hanla></hanla>那么用户就拥有了角色的所有权限<hanla></hanla>(权限包括: 菜单权限和按钮权限)</p>
              </blockquote>
              <table>
                <thead>
                  <tr>
                    <th align="center">用户所拥有的角色</th>
                    <th align="center">角色所拥有的权限</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/dd7d2eb6d3d04c349f016f77bcb9e396.png"></td>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/d46d0d8df80d44b9ab9656477c41d2d4.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p>用户接口修改密码加密</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// 用户添加<hanla></hanla></span></span><br><span class="line"><span class="meta">@PostMapping("/save")</span></span><br><span class="line"><span class="meta">@ApiOperation(value = "添加用户")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> SysUser sysUser)</span> {</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> 将用户输入的密码进行 MD5 加密</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">encrypt</span> <span class="operator">=</span> MD5.encrypt(sysUser.getPassword());</span><br><span class="line">    sysUser.setPassword(encrypt);</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">isSuccess</span> <span class="operator">=</span> sysUserService.save(sysUser);</span><br><span class="line">    <span class="keyword">if</span> (isSuccess) {</span><br><span class="line">        <span class="keyword">return</span> Result.ok();</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="keyword">return</span> Result.fail();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>修改用户登录接口</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="meta">@ApiOperation("用户登录")</span></span><br><span class="line"><span class="meta">@PostMapping("/login")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">login</span><span class="params">(<span class="meta">@RequestBody</span> LoginVo loginVo)</span> {</span><br><span class="line">    <span class="comment">// 根据 username 查询数据</span></span><br><span class="line">    <span class="type">SysUser</span> <span class="variable">sysUser</span> <span class="operator">=</span> sysUserService.getUserInfobyUserName(loginVo.getUsername());</span><br><span class="line">    <span class="comment">// 如果查询为空</span></span><br><span class="line">    <span class="keyword">if</span> (sysUser == <span class="literal">null</span>) {</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">coderItlException</span>(<span class="number">20001</span>, <span class="string">"用户不存在"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// 判断密码是否一致</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> loginVo.getPassword();</span><br><span class="line">    <span class="type">String</span> <span class="variable">md5Password</span> <span class="operator">=</span> MD5.encrypt(password);</span><br><span class="line">    <span class="keyword">if</span> (!sysUser.getPassword().equals(md5Password)) {</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">coderItlException</span>(<span class="number">20001</span>, <span class="string">"密码不正确!"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// 判断用户是否可用</span></span><br><span class="line">    <span class="keyword">if</span> (sysUser.getStatus().intValue() == <span class="number">0</span>) {</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">coderItlException</span>(<span class="number">20001</span>, <span class="string">"用户已禁用!"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// 根据 userid 和 username 生成 token 字符串,<hanla></hanla>返回 map</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> JwtHelper.createToken(sysUser.getId(), sysUser.getUsername());</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">"token"</span>, token);</span><br><span class="line">    <span class="keyword">return</span> Result.ok(map);</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// dao 根据用户名查询<hanla></hanla></span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> SysUser <span class="title function_">getUserInfobyUserName</span><span class="params">(String username)</span> {</span><br><span class="line">    QueryWrapper&lt;SysUser&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">    wrapper.eq(<span class="string">"username"</span>, username);</span><br><span class="line">    <span class="type">SysUser</span> <span class="variable">sysUser</span> <span class="operator">=</span> sysUserMapper.selectOne(wrapper);</span><br><span class="line">    <span class="keyword">return</span> sysUser;</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>修改用户信息接口</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"></span><br><span class="line"><span class="meta">@ApiOperation("用户信息")</span></span><br><span class="line"><span class="meta">@GetMapping("/info")</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">info</span><span class="params">(HttpServletRequest request)</span> {</span><br><span class="line">    <span class="comment">// 获取请求头中的 token 字符串</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(<span class="string">"token"</span>);</span><br><span class="line">    <span class="comment">// 从 token 中获取<hanla></hanla>(用户名称<hanla></hanla>/id)</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> JwtHelper.getUsername(token);</span><br><span class="line">    <span class="comment">// 根据用户名称获取用户信息<hanla></hanla>(基本信息和菜单权限和按钮权限数据)</span></span><br><span class="line">    Map&lt;String, Object&gt; map = sysUserService.getUserInfo(username);</span><br><span class="line">    <span class="keyword">return</span> Result.ok(map);</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// dao</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">getUserInfo</span><span class="params">(String username)</span> {</span><br><span class="line">    <span class="comment">// 根据用户名查询用户基本信息</span></span><br><span class="line">    <span class="type">SysUser</span> <span class="variable">sysUser</span> <span class="operator">=</span> <span class="built_in">this</span>.getUserInfobyUserName(username);</span><br><span class="line">    <span class="comment">// 根据 userid<hanla></hanla>查询菜单权限值</span></span><br><span class="line">    List&lt;RouterVo&gt; routerVoList = sysMenuService.getUserMenuList(sysUser.getId());</span><br><span class="line">    <span class="comment">// 根据 userid 查询按钮权限值</span></span><br><span class="line">    List&lt;String&gt; permsList = sysMenuService.getUserButtonList(sysUser.getId());</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">"roles"</span>, <span class="string">"[admin]"</span>);</span><br><span class="line">    map.put(<span class="string">"name"</span>, <span class="string">"admin"</span>);</span><br><span class="line">    map.put(<span class="string">"avatar"</span>, <span class="string">"https://oss.aliyuncs.com/aliyun_id_photo_bucket/default_handsome.jpg"</span>);</span><br><span class="line">    map.put(<span class="string">"buttons"</span>, permsList);</span><br><span class="line">    map.put(<span class="string">"routers"</span>, routerVoList);</span><br><span class="line">    <span class="keyword">return</span> map;</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// 根据 userid 查询菜单权限值<hanla></hanla></span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;RouterVo&gt; <span class="title function_">getUserMenuList</span><span class="params">(String userId)</span> {</span><br><span class="line">    <span class="comment">// admin 是超级管理员,<hanla></hanla>可以操作所有内容</span></span><br><span class="line">    List&lt;SysMenu&gt; sysMenuList = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// 判断 userid 的值是 1(代表超级管理员),<hanla></hanla>查询所有权限数据</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="string">"1"</span>.equals((userId))) {</span><br><span class="line">        QueryWrapper&lt;SysMenu&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.eq(<span class="string">"status"</span>, <span class="number">1</span>);</span><br><span class="line">        wrapper.orderByAsc(<span class="string">"sort_value"</span>);</span><br><span class="line">        sysMenuList = baseMapper.selectList(wrapper);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="comment">// 如果 userid 不是 1,<hanla></hanla>是其他类型用户,<hanla></hanla>查询这个用户的权限</span></span><br><span class="line">        sysMenuList = baseMapper.findMenuListUserId(userId);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// 构建树形结构</span></span><br><span class="line">    List&lt;SysMenu&gt; sysMenuTreeList = MenuHelper.buildTree(sysMenuList);</span><br><span class="line">    <span class="comment">// 转换成前端路由要求的格式数据</span></span><br><span class="line">    List&lt;RouterVo&gt; routerVoList = RouterHelper.buildRouters(sysMenuTreeList);</span><br><span class="line">    <span class="keyword">return</span> routerVoList;</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// 根据 userid 查询按钮权限值<hanla></hanla></span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getUserButtonList</span><span class="params">(String userId)</span> {</span><br><span class="line">    List&lt;SysMenu&gt; sysMenuList = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// 判断是否是管理员</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="string">"1"</span>.equals(userId)) {</span><br><span class="line">        sysMenuList = baseMapper.selectList(<span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;SysMenu&gt;().eq(<span class="string">"status"</span>, <span class="number">1</span>));</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        sysMenuList = baseMapper.findMenuListUserId(userId);</span><br><span class="line">    }</span><br><span class="line">    List&lt;String&gt; permissionList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (SysMenu sysMenu : sysMenuList) {</span><br><span class="line">        <span class="keyword">if</span> (sysMenu.getType().intValue() == <span class="number">2</span>) {</span><br><span class="line">            <span class="type">String</span> <span class="variable">perms</span> <span class="operator">=</span> sysMenu.getPerms();</span><br><span class="line">            permissionList.add(perms);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// 返回按钮的权限</span></span><br><span class="line">    <span class="keyword">return</span> permissionList;</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>工具类</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// 构建动态路由<hanla></hanla></span></span><br><span class="line"><span class="keyword">package</span> com.example.system.utils;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.toolkit.CollectionUtils;</span><br><span class="line"><span class="keyword">import</span> com.example.model.system.SysMenu;</span><br><span class="line"><span class="keyword">import</span> com.example.model.vo.MetaVo;</span><br><span class="line"><span class="keyword">import</span> com.example.model.vo.RouterVo;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据菜单数据构建路由的工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RouterHelper</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据菜单构建路由</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> menus</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;RouterVo&gt; <span class="title function_">buildRouters</span><span class="params">(List&lt;SysMenu&gt; menus)</span> {</span><br><span class="line">        List&lt;RouterVo&gt; routers = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;RouterVo&gt;();</span><br><span class="line">        <span class="keyword">for</span> (SysMenu menu : menus) {</span><br><span class="line">            <span class="type">RouterVo</span> <span class="variable">router</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RouterVo</span>();</span><br><span class="line">            router.setHidden(<span class="literal">false</span>);</span><br><span class="line">            router.setAlwaysShow(<span class="literal">false</span>);</span><br><span class="line">            router.setPath(getRouterPath(menu));</span><br><span class="line">            router.setComponent(menu.getComponent());</span><br><span class="line">            router.setMeta(<span class="keyword">new</span> <span class="title class_">MetaVo</span>(menu.getName(), menu.getIcon()));</span><br><span class="line">            List&lt;SysMenu&gt; children = menu.getChildren();</span><br><span class="line">            <span class="comment">//<hanla></hanla>如果当前是菜单，需将按钮对应的路由加载出来，如：“角色授权”<hanla></hanla>按钮对应的路由在<hanla></hanla>“系统管理”<hanla></hanla>下面</span></span><br><span class="line">            <span class="keyword">if</span> (menu.getType().intValue() == <span class="number">1</span>) {</span><br><span class="line">                List&lt;SysMenu&gt; hiddenMenuList = children.stream().filter(item -&gt; !StringUtils.isEmpty(item.getComponent())).collect(Collectors.toList());</span><br><span class="line">                <span class="keyword">for</span> (SysMenu hiddenMenu : hiddenMenuList) {</span><br><span class="line">                    <span class="type">RouterVo</span> <span class="variable">hiddenRouter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RouterVo</span>();</span><br><span class="line">                    hiddenRouter.setHidden(<span class="literal">true</span>);</span><br><span class="line">                    hiddenRouter.setAlwaysShow(<span class="literal">false</span>);</span><br><span class="line">                    hiddenRouter.setPath(getRouterPath(hiddenMenu));</span><br><span class="line">                    hiddenRouter.setComponent(hiddenMenu.getComponent());</span><br><span class="line">                    hiddenRouter.setMeta(<span class="keyword">new</span> <span class="title class_">MetaVo</span>(hiddenMenu.getName(), hiddenMenu.getIcon()));</span><br><span class="line">                    routers.add(hiddenRouter);</span><br><span class="line">                }</span><br><span class="line">            } <span class="keyword">else</span> {</span><br><span class="line">                <span class="keyword">if</span> (!CollectionUtils.isEmpty(children)) {</span><br><span class="line">                    <span class="keyword">if</span> (children.size() &gt; <span class="number">0</span>) {</span><br><span class="line">                        router.setAlwaysShow(<span class="literal">true</span>);</span><br><span class="line">                    }</span><br><span class="line">                    router.setChildren(buildRouters(children));</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            routers.add(router);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> routers;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取路由地址</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> menu 菜单信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 路由地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getRouterPath</span><span class="params">(SysMenu menu)</span> {</span><br><span class="line">        <span class="type">String</span> <span class="variable">routerPath</span> <span class="operator">=</span> <span class="string">"/"</span> + menu.getPath();</span><br><span class="line">        <span class="keyword">if</span> (menu.getParentId().intValue() != <span class="number">0</span>) {</span><br><span class="line">            routerPath = menu.getPath();</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> routerPath;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>权限测试</p>
              <ul>
                <li>
                  <p>创建新用户，分配权限与角色</p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">添加新用户，分配权限</th>
                        <th align="center">对角色分配权限</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/6254cb8ab8474225ac383e9b97f89b0e.png"></td>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/72d499dd93b84ad6b8937bc518d42977.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p>修改前端页面</p>
                  <figure class="highlight html">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">&lt;!-- 工具条 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tools-div"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">type</span>=<span class="string">"success"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">icon</span>=<span class="string">"el-icon-plus"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">size</span>=<span class="string">"mini"</span></span></span><br><span class="line"><span class="tag">        @<span class="attr">click</span>=<span class="string">"add"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:disabled</span>=<span class="string">"$hasBP('bnt.sysUser.add') === false"</span></span></span><br><span class="line"><span class="tag">        &gt;</span><hanla></hanla>添 加<hanla></hanla></span><br><span class="line">      &gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- :disabled="$hasBP('bnt.sysUser.add') === false" --&gt;</span></span><br><span class="line"></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>登录查看</p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">实现客户端按钮的权限控制</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/f69f2f8a954847eda6d1358edf638c8b.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
              </ul>
            </li>
            <li>
              <p>前端权限对接</p>
              <ul>
                <li>
                  <p>修改<hanla></hanla><code>axios</code>
                    <hanla></hanla>对请求头<hanla></hanla><code>token</code>
                    <hanla></hanla>的设置
                  </p>
                  <figure class="highlight js">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line">service.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(</span><br><span class="line">    <span class="function">(<span class="params">config</span>) =&gt;</span> {</span><br><span class="line">        <span class="comment">// do something before request is sent</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (store.<span class="property">getters</span>.<span class="property">token</span>) {</span><br><span class="line">            <span class="comment">// let each request carry token</span></span><br><span class="line">            <span class="comment">// ['X-Token'] is a custom headers key</span></span><br><span class="line">            <span class="comment">// please modify it according to the actual situation</span></span><br><span class="line">            config.<span class="property">headers</span>[<span class="string">"token"</span>] = <span class="title function_">getToken</span>();</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> config;</span><br><span class="line">    },</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ul>
            </li>
          </ul>
          <h4 id="SpringSecurity"><a href="#SpringSecurity" class="headerlink" title="SpringSecurity"></a>SpringSecurity</h4>
          <ul>
            <li>
              <p>创建项目</p>
            </li>
            <li>
              <p>添加依赖</p>
              <figure class="highlight xml">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment"><!-- Spring Security<hanla></hanla>依赖 --></span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>用户认证流程</p>
              <table>
                <thead>
                  <tr>
                    <th align="center">用户认证流程</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/ee5b890d9dab451395de33b33269589b.png#pic_center"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p>用户认证</p>
              <ul>
                <li>
                  <p>自定义密码组件<hanla></hanla>(<code>采用 MD5</code>)</p>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">package</span> com.example.system.customer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.common.utils.MD5;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.crypto.password.PasswordEncoder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义密码组件<hanla></hanla></span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomerMD5Paddword</span> <span class="keyword">implements</span> <span class="title class_">PasswordEncoder</span> {</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encode</span><span class="params">(CharSequence charSequence)</span> {</span><br><span class="line">        <span class="comment">// MD5 是自定义的工具类</span></span><br><span class="line">        <span class="keyword">return</span> MD5.encrypt(charSequence.toString());</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">matches</span><span class="params">(CharSequence charSequence, String encodedPassword)</span> {</span><br><span class="line">        <span class="keyword">return</span> encodedPassword.equals(MD5.encrypt(charSequence.toString()));</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>自定义用户对象</p>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(description = "用户")</span></span><br><span class="line"><span class="meta">@TableName("sys_user")</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SysUser</span> <span class="keyword">extends</span> <span class="title class_">BaseEntity</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ApiModelProperty(value = "用户名")</span></span><br><span class="line">    <span class="meta">@TableField("username")</span></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ApiModelProperty(value = "密码")</span></span><br><span class="line">    <span class="meta">@TableField("password")</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ApiModelProperty(value = "姓名")</span></span><br><span class="line">    <span class="meta">@TableField("name")</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ApiModelProperty(value = "手机")</span></span><br><span class="line">    <span class="meta">@TableField("phone")</span></span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ApiModelProperty(value = "头像地址")</span></span><br><span class="line">    <span class="meta">@TableField("head_url")</span></span><br><span class="line">    <span class="keyword">private</span> String headUrl;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ApiModelProperty(value = "部门<hanla></hanla>id")</span></span><br><span class="line">    <span class="meta">@TableField("dept_id")</span></span><br><span class="line">    <span class="keyword">private</span> Long deptId;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ApiModelProperty(value = "岗位<hanla></hanla>id")</span></span><br><span class="line">    <span class="meta">@TableField("post_id")</span></span><br><span class="line">    <span class="keyword">private</span> Long postId;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ApiModelProperty(value = "描述")</span></span><br><span class="line">    <span class="meta">@TableField("description")</span></span><br><span class="line">    <span class="keyword">private</span> String description;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ApiModelProperty(value = "状态（1：正常 0：停用）")</span></span><br><span class="line">    <span class="meta">@TableField("status")</span></span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;SysRole&gt; roleList;</span><br><span class="line">    <span class="comment">//<hanla></hanla>岗位</span></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> String postName;</span><br><span class="line">    <span class="comment">//<hanla></hanla>部门</span></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> String deptName;</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">package</span> com.example.system.customer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.model.system.SysUser;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.GrantedAuthority;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomerUser</span> <span class="keyword">extends</span> <span class="title class_">User</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 我们自己的用户实体对象，要调取用户信息时直接获取这个实体对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> SysUser sysUser;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CustomerUser</span><span class="params">(SysUser sysUser, Collection&lt;? extends GrantedAuthority&gt; authorities)</span> {</span><br><span class="line">        <span class="built_in">super</span>(sysUser.getUsername(), sysUser.getPassword(), authorities);</span><br><span class="line">        <span class="built_in">this</span>.sysUser = sysUser;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> SysUser <span class="title function_">getSysUser</span><span class="params">()</span> {</span><br><span class="line">        <span class="keyword">return</span> sysUser;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSysUser</span><span class="params">(SysUser sysUser)</span> {</span><br><span class="line">        <span class="built_in">this</span>.sysUser = sysUser;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>创建方法根据用户名查询用户信息</p>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">package</span> com.example.system.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.model.system.SysUser;</span><br><span class="line"><span class="keyword">import</span> com.example.system.customer.CustomerUser;</span><br><span class="line"><span class="keyword">import</span> com.example.system.service.SysUserService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.UserDetails;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.UserDetailsService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.UsernameNotFoundException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDetailServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserDetailsService</span> {</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SysUserService sysUserService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> UserDetails <span class="title function_">loadUserByUsername</span><span class="params">(String username)</span> <span class="keyword">throws</span> UsernameNotFoundException {</span><br><span class="line">        <span class="type">SysUser</span> <span class="variable">sysUser</span> <span class="operator">=</span> sysUserService.getUserInfobyUserName(username);</span><br><span class="line">        <span class="keyword">if</span> (sysUser == <span class="literal">null</span>) {</span><br><span class="line">            <span class="comment">// UsernameNotFoundException: 是 security 中提供的</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UsernameNotFoundException</span>(<span class="string">"用户不存在"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (sysUser.getStatus().intValue() == <span class="number">0</span>) {</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">"用户已禁用!"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CustomerUser</span>(sysUser, Collections.emptyList());</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>自定义认证过滤器</p>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">package</span> com.example.system.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.common.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.example.common.result.ResultCodeEnum;</span><br><span class="line"><span class="keyword">import</span> com.example.common.utils.JwtHelper;</span><br><span class="line"><span class="keyword">import</span> com.example.model.vo.LoginVo;</span><br><span class="line"><span class="keyword">import</span> com.example.system.customer.CustomerUser;</span><br><span class="line"><span class="keyword">import</span> com.example.system.utils.ResponseUtil;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.authentication.AuthenticationManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.authentication.UsernamePasswordAuthenticationToken;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.Authentication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.util.matcher.AntPathRequestMatcher;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 登录过滤器，继承 UsernamePasswordAuthenticationFilter，对用户名密码进行登录校验</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TokenLoginFilter</span> <span class="keyword">extends</span> <span class="title class_">UsernamePasswordAuthenticationFilter</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TokenLoginFilter</span><span class="params">(AuthenticationManager authenticationManager)</span> {</span><br><span class="line">        <span class="built_in">this</span>.setAuthenticationManager(authenticationManager);</span><br><span class="line">        <span class="built_in">this</span>.setPostOnly(<span class="literal">false</span>);</span><br><span class="line">        <span class="comment">// 指定登录接口及提交方式，可以指定任意路径</span></span><br><span class="line">        <span class="built_in">this</span>.setRequiresAuthenticationRequestMatcher(<span class="keyword">new</span> <span class="title class_">AntPathRequestMatcher</span>(<span class="string">"/admin/system/index/login"</span>, <span class="string">"POST"</span>));</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 登录认证</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> req</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> res</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> AuthenticationException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Authentication <span class="title function_">attemptAuthentication</span><span class="params">(HttpServletRequest req, HttpServletResponse res)</span></span><br><span class="line">            <span class="keyword">throws</span> AuthenticationException {</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="type">LoginVo</span> <span class="variable">loginVo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>().readValue(req.getInputStream(), LoginVo.class);</span><br><span class="line">            </span><br><span class="line">            <span class="type">Authentication</span> <span class="variable">authenticationToken</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UsernamePasswordAuthenticationToken</span>(loginVo.getUsername(), loginVo.getPassword());</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.getAuthenticationManager().authenticate(authenticationToken);</span><br><span class="line">        } <span class="keyword">catch</span> (IOException e) {</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 登录成功</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> chain</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> auth</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">successfulAuthentication</span><span class="params">(HttpServletRequest request, HttpServletResponse response, FilterChain chain,</span></span><br><span class="line"><span class="params">                                            Authentication auth)</span> <span class="keyword">throws</span> IOException, ServletException {</span><br><span class="line">        <span class="type">CustomerUser</span> <span class="variable">customUser</span> <span class="operator">=</span> (CustomerUser) auth.getPrincipal();</span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> JwtHelper.createToken(customUser.getSysUser().getId(), customUser.getSysUser().getUsername());</span><br><span class="line">        </span><br><span class="line">        Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">"token"</span>, token);</span><br><span class="line">        ResponseUtil.out(response, Result.ok(map));</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 登录失败</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> e</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">unsuccessfulAuthentication</span><span class="params">(HttpServletRequest request, HttpServletResponse response,</span></span><br><span class="line"><span class="params">                                              AuthenticationException e)</span> <span class="keyword">throws</span> IOException, ServletException {</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (e.getCause() <span class="keyword">instanceof</span> RuntimeException) {</span><br><span class="line">            ResponseUtil.out(response, Result.build(<span class="literal">null</span>, <span class="number">204</span>, e.getMessage()));</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            ResponseUtil.out(response, Result.build(<span class="literal">null</span>, ResultCodeEnum.LOGIN_MOBLE_ERROR));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>返回信息工具类</p>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">// 响应工具类<hanla></hanla></span></span><br><span class="line"><span class="keyword">package</span> com.example.system.utils;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.common.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.HttpStatus;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResponseUtil</span> {</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">out</span><span class="params">(HttpServletResponse response, Result r)</span> {</span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        response.setStatus(HttpStatus.OK.value());</span><br><span class="line">        response.setContentType(MediaType.APPLICATION_JSON_UTF8_VALUE);</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            mapper.writeValue(response.getWriter(), r);</span><br><span class="line">        } <span class="keyword">catch</span> (IOException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>认证解析过滤器</p>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">package</span> com.example.system.filter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.common.result.Result;</span><br><span class="line"><span class="keyword">import</span> com.example.common.result.ResultCodeEnum;</span><br><span class="line"><span class="keyword">import</span> com.example.common.utils.JwtHelper;</span><br><span class="line"><span class="keyword">import</span> com.example.system.utils.ResponseUtil;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.authentication.UsernamePasswordAuthenticationToken;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.context.SecurityContextHolder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.filter.OncePerRequestFilter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 认证解析 token 过滤器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TokenAuthenticationFilter</span> <span class="keyword">extends</span> <span class="title class_">OncePerRequestFilter</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TokenAuthenticationFilter</span><span class="params">()</span> {</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doFilterInternal</span><span class="params">(HttpServletRequest request, HttpServletResponse response, FilterChain chain)</span></span><br><span class="line">            <span class="keyword">throws</span> IOException, ServletException {</span><br><span class="line">        log.info(<span class="string">"uri:"</span> + request.getRequestURI());</span><br><span class="line">        <span class="comment">// 如果是登录接口，直接放行</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">"/admin/system/index/login"</span>.equals(request.getRequestURI())) {</span><br><span class="line">            chain.doFilter(request, response);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line">        <span class="type">UsernamePasswordAuthenticationToken</span> <span class="variable">authentication</span> <span class="operator">=</span> getAuthentication(request);</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> != authentication) {</span><br><span class="line">            SecurityContextHolder.getContext().setAuthentication(authentication);</span><br><span class="line">            chain.doFilter(request, response);</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            ResponseUtil.out(response, Result.build(<span class="literal">null</span>, ResultCodeEnum.PERMISSION));</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> UsernamePasswordAuthenticationToken <span class="title function_">getAuthentication</span><span class="params">(HttpServletRequest request)</span> {</span><br><span class="line">        <span class="comment">// token 置于 header 里</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(<span class="string">"token"</span>);</span><br><span class="line">        logger.info(<span class="string">"token:"</span> + token);</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(token)) {</span><br><span class="line">            <span class="type">String</span> <span class="variable">useruame</span> <span class="operator">=</span> JwtHelper.getUsername(token);</span><br><span class="line">            log.info(<span class="string">"useruame:"</span> + useruame);</span><br><span class="line">            <span class="keyword">if</span> (!StringUtils.isEmpty(useruame)) {</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">UsernamePasswordAuthenticationToken</span>(useruame, <span class="literal">null</span>, Collections.emptyList());</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>配置用户认证全局信息</p>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">package</span> com.example.system.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.system.customer.CustomMd5PasswordEncoder;</span><br><span class="line"><span class="keyword">import</span> com.example.system.filter.TokenAuthenticationFilter;</span><br><span class="line"><span class="keyword">import</span> com.example.system.filter.TokenLoginFilter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.authentication.AuthenticationManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.builders.WebSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.http.SessionCreationPolicy;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.userdetails.UserDetailsService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EnableWebSecurity</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebSecurityConfig</span> <span class="keyword">extends</span> <span class="title class_">WebSecurityConfigurerAdapter</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDetailsService userDetailsService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CustomMd5PasswordEncoder customMd5PasswordEncoder;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> AuthenticationManager <span class="title function_">authenticationManager</span><span class="params">()</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.authenticationManager();</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">        <span class="comment">// 这是配置的关键，决定哪些接口开启防护，哪些接口绕过防护</span></span><br><span class="line">        http</span><br><span class="line">                <span class="comment">//<hanla></hanla>关闭<hanla></hanla>csrf</span></span><br><span class="line">                .csrf().disable()</span><br><span class="line">                <span class="comment">// 开启跨域以便前端调用接口</span></span><br><span class="line">                .cors().and()</span><br><span class="line">                .authorizeRequests()</span><br><span class="line">                <span class="comment">// 指定某些接口不需要通过验证即可访问。登陆接口肯定是不需要认证的</span></span><br><span class="line">                .antMatchers(<span class="string">"/admin/system/index/login"</span>).permitAll()</span><br><span class="line">                <span class="comment">// 这里意思是其它所有接口需要认证才能访问</span></span><br><span class="line">                .anyRequest().authenticated()</span><br><span class="line">                .and()</span><br><span class="line">                <span class="comment">//TokenAuthenticationFilter<hanla></hanla>放到<hanla></hanla>UsernamePasswordAuthenticationFilter<hanla></hanla>的前面，这样做就是为了除了登录的时候去查询数据库外，其他时候都用<hanla></hanla>token<hanla></hanla>进行认证。</span></span><br><span class="line">                .addFilterBefore(<span class="keyword">new</span> <span class="title class_">TokenAuthenticationFilter</span>(), UsernamePasswordAuthenticationFilter.class)</span><br><span class="line">                .addFilter(<span class="keyword">new</span> <span class="title class_">TokenLoginFilter</span>(authenticationManager()));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//<hanla></hanla>禁用<hanla></hanla>session</span></span><br><span class="line">        http.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(AuthenticationManagerBuilder auth)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">        <span class="comment">// 指定<hanla></hanla>UserDetailService<hanla></hanla>和加密器</span></span><br><span class="line">        auth.userDetailsService(userDetailsService).passwordEncoder(customMd5PasswordEncoder);</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置哪些请求不拦截</span></span><br><span class="line"><span class="comment">     * 排除<hanla></hanla>swagger<hanla></hanla>相关请求</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> web</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(WebSecurity web)</span> <span class="keyword">throws</span> Exception {</span><br><span class="line">        web.ignoring().antMatchers(<span class="string">"/favicon.ico"</span>, <span class="string">"/swagger-resources/**"</span>, <span class="string">"/webjars/**"</span>, <span class="string">"/v2/**"</span>, <span class="string">"/swagger-ui.html/**"</span>, <span class="string">"/doc.html"</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <blockquote>
                    <p>前后端分离项目，使用<hanla></hanla><code>jwt</code>
                      <hanla></hanla>生成<hanla></hanla><code>token</code> ，即用户状态保存在客户端中，前后端交互通过<hanla></hanla><code>api</code>
                      <hanla></hanla>接口 无<hanla></hanla><code>session</code>
                      <hanla></hanla>生成，所以我们不需要配置<hanla></hanla><code>formLogin</code>，<code>session</code>
                      <hanla></hanla>禁用
                    </p>
                  </blockquote>
                </li>
              </ul>
            </li>
            <li>
              <p>用户授权</p>
              <blockquote>
                <p> 在 <code>SpringSecurity</code>
                  <hanla></hanla>中，会使用默认的<hanla></hanla><code>FilterSecurityInterceptor</code>
                  <hanla></hanla>来进行权限校验。在<hanla></hanla><code>FilterSecurityInterceptor</code>
                  <hanla></hanla>中会从<hanla></hanla><code>SecurityContextHolder</code>
                  <hanla></hanla>获取其中的<hanla></hanla><code>Authentication</code>，然后获取其中的权限信息。判断当前用户是否拥有访问当前资源所需的权限。
                </p>
              </blockquote>
              <ul>
                <li>
                  <p>修改<hanla></hanla><code>loadUserByUsername</code>，查询用户权限操作数据返回</p>
                  <figure class="highlight java">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> UserDetails <span class="title function_">loadUserByUsername</span><span class="params">(String username)</span> <span class="keyword">throws</span> UsernameNotFoundException {</span><br><span class="line">    <span class="type">SysUser</span> <span class="variable">sysUser</span> <span class="operator">=</span> sysUserService.getUserInfobyUserName(username);</span><br><span class="line">    <span class="keyword">if</span> (sysUser == <span class="literal">null</span>) {</span><br><span class="line">        <span class="comment">// UsernameNotFoundException: 是 security 中提供的</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UsernameNotFoundException</span>(<span class="string">"用户不存在"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (sysUser.getStatus().intValue() == <span class="number">0</span>) {</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">"用户已禁用!"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// 根据 userid 查询操作权限数据</span></span><br><span class="line">    List&lt;String&gt; userPermsList = sysMenuService.getUserButtonList(sysUser.getId());</span><br><span class="line">    <span class="comment">// 转换成 security 要求的格式</span></span><br><span class="line">    List&lt;SimpleGrantedAuthority&gt; authorities = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (String perm : userPermsList) {</span><br><span class="line">        authorities.add(<span class="keyword">new</span> <span class="title class_">SimpleGrantedAuthority</span>(perm.trim()));</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CustomerUser</span>(sysUser, authorities);</span><br><span class="line">}</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>配置<hanla></hanla><code>Redis</code>，存储权限数据</p>
                </li>
                <li>
                  <p>修改过滤器</p>
                  <ul>
                    <li>认证过滤器</li>
                    <li>解析过滤器</li>
                  </ul>
                </li>
                <li>
                  <p>在项目配置<hanla></hanla><code>redis</code>，完成<hanla></hanla><code>Controller</code>
                    <hanla></hanla>相关代码
                  </p>
                </li>
              </ul>
            </li>
          </ul>
          <h4 id="日志模块"><a href="#日志模块" class="headerlink" title="日志模块"></a>日志模块</h4>
          <ul>
            <li>
              <p>获取日志工具类</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">package</span> com.example.system.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.HttpHeaders;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.server.reactive.ServerHttpRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.UnknownHostException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取<hanla></hanla>ip<hanla></hanla>地址</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IpUtil</span> {</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getIpAddress</span><span class="params">(HttpServletRequest request)</span> {</span><br><span class="line">        <span class="type">String</span> <span class="variable">ipAddress</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            ipAddress = request.getHeader(<span class="string">"x-forwarded-for"</span>);</span><br><span class="line">            <span class="keyword">if</span> (ipAddress == <span class="literal">null</span> || ipAddress.length() == <span class="number">0</span> || <span class="string">"unknown"</span>.equalsIgnoreCase(ipAddress)) {</span><br><span class="line">                ipAddress = request.getHeader(<span class="string">"Proxy-Client-IP"</span>);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span> (ipAddress == <span class="literal">null</span> || ipAddress.length() == <span class="number">0</span> || <span class="string">"unknown"</span>.equalsIgnoreCase(ipAddress)) {</span><br><span class="line">                ipAddress = request.getHeader(<span class="string">"WL-Proxy-Client-IP"</span>);</span><br><span class="line">            }</span><br><span class="line">            <span class="keyword">if</span> (ipAddress == <span class="literal">null</span> || ipAddress.length() == <span class="number">0</span> || <span class="string">"unknown"</span>.equalsIgnoreCase(ipAddress)) {</span><br><span class="line">                ipAddress = request.getRemoteAddr();</span><br><span class="line">                <span class="keyword">if</span> (ipAddress.equals(<span class="string">"127.0.0.1"</span>)) {</span><br><span class="line">                    <span class="comment">// 根据网卡取本机配置的<hanla></hanla>IP</span></span><br><span class="line">                    <span class="type">InetAddress</span> <span class="variable">inet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">                    <span class="keyword">try</span> {</span><br><span class="line">                        inet = InetAddress.getLocalHost();</span><br><span class="line">                        log.info(<span class="string">"inet: {}"</span>, inet.toString());</span><br><span class="line">                    } <span class="keyword">catch</span> (UnknownHostException e) {</span><br><span class="line">                        log.error(<span class="string">"UnknownHostException: {}"</span>, e);</span><br><span class="line">                    }</span><br><span class="line">                    ipAddress = inet.getHostAddress();</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">            <span class="comment">// 对于通过多个代理的情况，第一个<hanla></hanla>IP<hanla></hanla>为客户端真实<hanla></hanla>IP,<hanla></hanla>多个<hanla></hanla>IP<hanla></hanla>按照','分割</span></span><br><span class="line">            <span class="keyword">if</span> (ipAddress != <span class="literal">null</span> &amp;&amp; ipAddress.length() &gt; <span class="number">15</span>) { <span class="comment">// "***.***.***.***".length()</span></span><br><span class="line">                <span class="comment">// = 15</span></span><br><span class="line">                <span class="keyword">if</span> (ipAddress.indexOf(<span class="string">","</span>) &gt; <span class="number">0</span>) {</span><br><span class="line">                    ipAddress = ipAddress.substring(<span class="number">0</span>, ipAddress.indexOf(<span class="string">","</span>));</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        } <span class="keyword">catch</span> (Exception e) {</span><br><span class="line">            ipAddress = <span class="string">""</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> ipAddress;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getGatwayIpAddress</span><span class="params">(ServerHttpRequest request)</span> {</span><br><span class="line">        <span class="type">HttpHeaders</span> <span class="variable">headers</span> <span class="operator">=</span> request.getHeaders();</span><br><span class="line">        <span class="type">String</span> <span class="variable">ip</span> <span class="operator">=</span> headers.getFirst(<span class="string">"x-forwarded-for"</span>);</span><br><span class="line">        <span class="keyword">if</span> (ip != <span class="literal">null</span> &amp;&amp; ip.length() != <span class="number">0</span> &amp;&amp; !<span class="string">"unknown"</span>.equalsIgnoreCase(ip)) {</span><br><span class="line">            <span class="comment">// 多次反向代理后会有多个<hanla></hanla>ip<hanla></hanla>值，第一个<hanla></hanla>ip<hanla></hanla>才是真实<hanla></hanla>ip</span></span><br><span class="line">            <span class="keyword">if</span> (ip.indexOf(<span class="string">","</span>) != -<span class="number">1</span>) {</span><br><span class="line">                ip = ip.split(<span class="string">","</span>)[<span class="number">0</span>];</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (ip == <span class="literal">null</span> || ip.length() == <span class="number">0</span> || <span class="string">"unknown"</span>.equalsIgnoreCase(ip)) {</span><br><span class="line">            ip = headers.getFirst(<span class="string">"Proxy-Client-IP"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (ip == <span class="literal">null</span> || ip.length() == <span class="number">0</span> || <span class="string">"unknown"</span>.equalsIgnoreCase(ip)) {</span><br><span class="line">            ip = headers.getFirst(<span class="string">"WL-Proxy-Client-IP"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (ip == <span class="literal">null</span> || ip.length() == <span class="number">0</span> || <span class="string">"unknown"</span>.equalsIgnoreCase(ip)) {</span><br><span class="line">            ip = headers.getFirst(<span class="string">"HTTP_CLIENT_IP"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (ip == <span class="literal">null</span> || ip.length() == <span class="number">0</span> || <span class="string">"unknown"</span>.equalsIgnoreCase(ip)) {</span><br><span class="line">            ip = headers.getFirst(<span class="string">"HTTP_X_FORWARDED_FOR"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (ip == <span class="literal">null</span> || ip.length() == <span class="number">0</span> || <span class="string">"unknown"</span>.equalsIgnoreCase(ip)) {</span><br><span class="line">            ip = headers.getFirst(<span class="string">"X-Real-IP"</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (ip == <span class="literal">null</span> || ip.length() == <span class="number">0</span> || <span class="string">"unknown"</span>.equalsIgnoreCase(ip)) {</span><br><span class="line">            ip = request.getRemoteAddress().getAddress().getHostAddress();</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> ip;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>简单使用</p>
              <figure class="highlight java">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">// 获取 IPV4 地址<hanla></hanla></span></span><br><span class="line"><span class="keyword">try</span> {</span><br><span class="line">    <span class="type">InetAddress</span> <span class="variable">inet</span> <span class="operator">=</span> InetAddress.getLocalHost();</span><br><span class="line">    <span class="type">String</span> <span class="variable">ipAdddr</span> <span class="operator">=</span> inet.getHostAddress();</span><br><span class="line">    System.out.println(ipAdddr);</span><br><span class="line">} <span class="keyword">catch</span> (UnknownHostException e) {</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">}</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>表结构</p>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `sys_login_log`</span><br><span class="line">(</span><br><span class="line">    `id`          <span class="type">bigint</span>    <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">'访问<hanla></hanla>ID'</span>,</span><br><span class="line">    `username`    <span class="type">varchar</span>(<span class="number">50</span>)        <span class="keyword">DEFAULT</span> <span class="string">''</span> COMMENT <span class="string">'用户账号'</span>,</span><br><span class="line">    `ipaddr`      <span class="type">varchar</span>(<span class="number">128</span>)       <span class="keyword">DEFAULT</span> <span class="string">''</span> COMMENT <span class="string">'登录<hanla></hanla>IP<hanla></hanla>地址'</span>,</span><br><span class="line">    `status`      tinyint(<span class="number">1</span>)         <span class="keyword">DEFAULT</span> <span class="string">'0'</span> COMMENT <span class="string">'登录状态（0<hanla></hanla>成功 1<hanla></hanla>失败）'</span>,</span><br><span class="line">    `msg`         <span class="type">varchar</span>(<span class="number">255</span>)       <span class="keyword">DEFAULT</span> <span class="string">''</span> COMMENT <span class="string">'提示信息'</span>,</span><br><span class="line">    `access_time` datetime           <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">'访问时间'</span>,</span><br><span class="line">    `create_time` <span class="type">timestamp</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    `update_time` <span class="type">timestamp</span> <span class="keyword">NULL</span>     <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    `is_deleted`  tinyint   <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span> COMMENT <span class="string">'删除标记（0:<hanla></hanla>可用 1:<hanla></hanla>已删除）'</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB</span><br><span class="line">  AUTO_INCREMENT <span class="operator">=</span> <span class="number">11</span></span><br><span class="line">  <span class="keyword">DEFAULT</span> CHARSET <span class="operator">=</span> utf8mb3 COMMENT <span class="operator">=</span><span class="string">'系统访问记录'</span></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
          </ul>
          <h3 id="项目部署"><a href="#项目部署" class="headerlink" title="项目部署"></a>项目部署</h3>
          <ul>
            <li>
              <p>后端打包</p>
              <ul>
                <li>
                  <p>在主启动类的项目中的<hanla></hanla><code>pom.xml</code>
                    <hanla></hanla>添加<hanla></hanla><code>build</code>
                  </p>
                  <figure class="highlight xml">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>${project.artifactId}<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>删除父工程的<hanla></hanla><code>build</code></p>
                </li>
                <li>
                  <p>目录结构预览</p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">目录结构预览</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/1ba2569d31844d7b8498099b01fa720d.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p>在主启动的项目中点击<hanla></hanla><code>maven</code>
                    <hanla></hanla>的<hanla></hanla><code>package</code>
                  </p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">打包</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/55c1265e8f8c46129fe8d8027a11e997.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p>打包成功</p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">打包结果</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/afeaee9b562e4124b3884e6837dcab8f.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
              </ul>
            </li>
          </ul>
        </article>
        <div class="post-copyright">
          <div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://coderitl.github.io">coder-itl</a></span></div>
          <div class="post-copyright__type"><span class="post-copyright-meta">
              <hanla></hanla>文章链接:
            </span><span class="post-copyright-info"><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.nesxc.com/post/hexocc.html">https://www.nesxc.com/post/hexocc.html</a></span></div>
          <div class="post-copyright__notice"><span class="post-copyright-meta">
              <hanla></hanla>版权声明:
            </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="external nofollow noopener noreferrer">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://coderitl.github.io" target="_blank">coder-itl</a>！</span></div>
        </div>
        <div class="tag_share">
          <div class="post-meta__tag-list"></div>
          <div class="post_share">
            <div class="social-share" data-image="https://cdn.jsdelivr.net/gh/coderitl/hiddenContent@v1.0.4/re-4.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'">
            <script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer=""></script>
          </div>
        </div>
        <nav class="pagination-post" id="pagination">
          <div class="prev-post pull-left"><a href="/2022/12/16/6566.html" title="前端时间格式化"><img class="cover" src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/coderitl/Access@v1.0/medias/featureimages/21.jpg" onerror="onerror=null;src='/null'" alt="cover of previous post">
              <div class="pagination-info">
                <div class="label">上一篇</div>
                <div class="prev_info">前端时间格式化</div>
              </div>
            </a></div>
          <div class="next-post pull-right"><a href="/2022/11/30/42622.html" title="SpringCloud"><img class="cover" src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://i.328888.xyz/2023/04/01/i2p4AN.jpeg" onerror="onerror=null;src='/null'" alt="cover of next post">
              <div class="pagination-info">
                <div class="label">下一篇<hanla></hanla>
                </div>
                <div class="next_info">SpringCloud</div>
              </div>
            </a></div>
        </nav>
        <hr>
        <div id="post-comment">
          <div class="comment-head">
            <div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论<hanla></hanla></span></div>
          </div>
          <div class="comment-wrap">
            <div>
              <div id="twikoo-wrap"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="aside-content" id="aside-content">
        <div class="card-widget card-info">
          <div class="is-center">
            <div class="avatar-img"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://i.328888.xyz/2023/03/19/MJUXa.jpeg" onerror="this.onerror=null;this.src='https://i.328888.xyz/2023/03/20/P3kfC.gif'" alt="avatar"></div>
            <div class="author-info__name">coder-itl</div>
            <div class="author-info__description">To read without reflecting is like eating without digesting.</div>
          </div>
          <div class="card-info-data site-data is-center"><a href="/archives/">
              <div class="headline">
                <hanla></hanla>文章<hanla></hanla>
              </div>
              <div class="length-num">119</div>
            </a><a href="/tags/">
              <div class="headline">
                <hanla></hanla>标签<hanla></hanla>
              </div>
              <div class="length-num">21</div>
            </a><a href="/categories/">
              <div class="headline">
                <hanla></hanla>分类<hanla></hanla>
              </div>
              <div class="length-num">13</div>
            </a></div><a id="card-info-btn" target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a>
        </div>
        <div class="card-widget card-announcement">
          <div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>
              <hanla></hanla>公告
            </span></div>
          <div class="announcement_content">本站所有图片来源于网络,<hanla></hanla>侵权请添加管理员删除【3327511395@qq.com】!</div>
        </div>
        <div class="sticky_layout">
          <div class="card-widget" id="card-toc">
            <div class="item-headline"><i class="fas fa-stream"></i><span>
                <hanla></hanla>目录<hanla></hanla>
              </span><span class="toc-percentage"></span></div>
            <div class="toc-content">
              <ol class="toc">
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E9%80%9A%E7%94%A8%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.</span> <span class="toc-text">权限通用项目<hanla></hanla></span></a>
                  <ol class="toc-child">
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#Maven-%E8%81%9A%E5%90%88%E5%B7%A5%E7%A8%8B"><span class="toc-number">1.1.</span> <span class="toc-text">Maven-聚合工程<hanla></hanla></span></a></li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#Knife4j"><span class="toc-number">1.2.</span> <span class="toc-text">Knife4j</span></a></li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E7%BB%9F%E4%B8%80%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.3.</span> <span class="toc-text">定义统一返回结果对象<hanla></hanla></span></a></li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#MybatisPlus-%E6%9D%A1%E4%BB%B6%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.4.</span> <span class="toc-text">MybatisPlus-条件分页查询<hanla></hanla></span></a></li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%9F%E4%B8%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">1.5.</span> <span class="toc-text">统一异常处理<hanla></hanla></span></a>
                      <ol class="toc-child">
                        <li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">1.5.1.</span> <span class="toc-text">全局异常处理<hanla></hanla></span></a></li>
                        <li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%89%B9%E5%AE%9A%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">1.5.2.</span> <span class="toc-text">特定异常处理<hanla></hanla></span></a></li>
                        <li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">1.5.3.</span> <span class="toc-text">自定义异常处理<hanla></hanla></span></a></li>
                      </ol>
                    </li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E5%99%A8%E4%BD%BF%E7%94%A8"><span class="toc-number">1.6.</span> <span class="toc-text">代码生成器使用<hanla></hanla></span></a></li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#Token"><span class="toc-number">1.7.</span> <span class="toc-text">Token</span></a></li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF"><span class="toc-number">1.8.</span> <span class="toc-text">前端<hanla></hanla></span></a>
                      <ol class="toc-child">
                        <li class="toc-item toc-level-5"><a class="toc-link" href="#vue-admin-template"><span class="toc-number">1.8.1.</span> <span class="toc-text">vue-admin-template</span></a></li>
                        <li class="toc-item toc-level-5"><a class="toc-link" href="#Vue-admin-template%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95"><span class="toc-number">1.8.2.</span> <span class="toc-text">Vue-admin-template<hanla></hanla>文件目录<hanla></hanla></span></a></li>
                        <li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E9%80%80%E5%87%BA%E6%94%B9%E9%80%A0"><span class="toc-number">1.8.3.</span> <span class="toc-text">登录退出改造<hanla></hanla></span></a></li>
                        <li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%92%E8%89%B2%E5%88%97%E8%A1%A8%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.8.4.</span> <span class="toc-text">角色列表实现<hanla></hanla></span></a></li>
                        <li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97"><span class="toc-number">1.8.5.</span> <span class="toc-text">用户管理模块<hanla></hanla></span></a></li>
                        <li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8F%9C%E5%8D%95%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97"><span class="toc-number">1.8.6.</span> <span class="toc-text">菜单管理模块<hanla></hanla></span></a></li>
                        <li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="toc-number">1.8.7.</span> <span class="toc-text">权限管理<hanla></hanla></span></a></li>
                      </ol>
                    </li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#SpringSecurity"><span class="toc-number">1.9.</span> <span class="toc-text">SpringSecurity</span></a></li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97"><span class="toc-number">1.10.</span> <span class="toc-text">日志模块<hanla></hanla></span></a></li>
                  </ol>
                </li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2"><span class="toc-number">2.</span> <span class="toc-text">项目部署</span></a></li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </main>
    <footer id="footer" style="background: transparent">
      <div id="footer-wrap">
        <div class="copyright">©2020 - 2023 By coder-itl</div>
        <div class="framework-info"><span>
            <hanla></hanla>框架
          </span><a target="_blank" rel="external nofollow noopener noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div>
        <div class="footer_custom_text">
          <p><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-orange">&nbsp;<img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Theme-Buffterfly-blue">&nbsp;<img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/CDN-jsDeliver-blueviolet">&nbsp;<img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Source-Github-9cf">&nbsp;<img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Theme-Matery-ff69b4">&nbsp;<img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Python-Python-success">&nbsp;<img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Python-Flask-red"></p>
          <p><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-red?logo=Castorama&amp;logoWidth=18">&nbsp;<img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?logo=Grunt&amp;logoWidth=18"></p>
        </div>
      </div>
    </footer>
  </div>
  <div id="rightside">
    <div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div>
    <div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div>
  </div>
  <div id="local-search">
    <div class="search-dialog">
      <nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav>
      <div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中<hanla></hanla></span></div>
      <div class="search-wrap">
        <div id="local-search-input">
          <div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div>
        </div>
        <hr>
        <div id="local-search-results"></div>
      </div>
    </div>
    <div id="search-mask"></div>
  </div>
  <div>
    <script src="/js/utils.js"></script>
    <script src="/js/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script>
    <script src="/js/search/local-search.js"></script>
    <div class="js-pjax">
      <script>
        (() =>
        {
          const init = () =>
          {
            twikoo.init(Object.assign(
            {
              el: '#twikoo-wrap',
              envId: 'https://twikoo-jlw0ln3jv-coderitl.vercel.app/',
              region: 'ap-shanghai',
              onCommentLoaded: function ()
              {
                btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
              }
            }, null))
          }
          const getCount = () =>
          {
            const countELement = document.getElementById('twikoo-count')
            if (!countELement) return
            twikoo.getCommentsCount(
            {
              envId: 'https://twikoo-jlw0ln3jv-coderitl.vercel.app/',
              region: 'ap-shanghai',
              urls: [window.location.pathname],
              includeReply: false
            }).then(function (res)
            {
              countELement.innerText = res[0].count
            }).catch(function (err)
            {
              console.error(err);
            });
          }
          const runFn = () =>
          {
            init()
          }
          const loadTwikoo = () =>
          {
            if (typeof twikoo === 'object')
            {
              setTimeout(runFn, 0)
              return
            }
            getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
          }
          if ('Twikoo' === 'Twikoo' || !false)
          {
            if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
            else loadTwikoo()
          }
          else
          {
            window.loadOtherComment = () =>
            {
              loadTwikoo()
            }
          }
        })()

      </script>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script>
    <script defer="" src="https://cdn.jsdelivr.net/npm/hexo-theme-volantis@latest/source/js/issues.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>
    <script data-pjax="" src="https://cdn.jsdelivr.net/gh/coderitl/FileJsDeliver@v1.1.13/swiper/swiper.min.js"></script>
    <script data-pjax="" src="https://cdn.jsdelivr.net/gh/coderitl/FileJsDeliver@v1.1.13/swiper/swiperindex.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/graingert/wow@1.3.0/dist/wow.min.js"></script>
    <script src="https://www.youxiaohou.com/mactype.user.js"></script>
    <script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script>
    <script>
      let pjaxSelectors = ["head > title", "#config-diff", "#body-wrap", "#rightside-config-hide", "#rightside-config-show", ".js-pjax"]
      var pjax = new Pjax(
      {
        elements: 'a:not([target="_blank"])',
        selectors: pjaxSelectors,
        cacheBust: false,
        analytics: false,
        scrollRestoration: false
      })
      document.addEventListener('pjax:send', function ()
      {
        // removeEventListener scroll 
        window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
        window.scrollCollect && window.removeEventListener('scroll', scrollCollect)
        document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
        if (window.aplayers)
        {
          for (let i = 0; i < window.aplayers.length; i++)
          {
            if (!window.aplayers[i].options.fixed)
            {
              window.aplayers[i].destroy()
            }
          }
        }
        typeof typed === 'object' && typed.destroy()
        //reset readmode
        const $bodyClassList = document.body.classList
        $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
        typeof disqusjs === 'object' && disqusjs.destroy()
      })
      document.addEventListener('pjax:complete', function ()
      {
        window.refreshFn()
        document.querySelectorAll('script[data-pjax]').forEach(item =>
        {
          const newScript = document.createElement('script')
          const content = item.text || item.textContent || item.innerHTML || ""
          Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
          newScript.appendChild(document.createTextNode(content))
          item.parentNode.replaceChild(newScript, item)
        })
        GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()
        typeof chatBtnFn === 'function' && chatBtnFn()
        typeof panguInit === 'function' && panguInit()
        // google analytics
        typeof gtag === 'function' && gtag('config', '',
        {
          'page_path': window.location.pathname
        });
        // baidu analytics
        typeof _hmt === 'object' && _hmt.push(['_trackPageview', window.location.pathname]);
        typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
        // prismjs
        typeof Prism === 'object' && Prism.highlightAll()
      })
      document.addEventListener('pjax:error', (e) =>
      {
        if (e.request.status === 404)
        {
          pjax.loadUrl('/404.html')
        }
      })

    </script>
    <script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  </div><!-- hexo injector body_end start -->
  <script data-pjax="">
    function history_calendar_injector_config()
    {
      var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
      var item_html = '<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span><hanla></hanla>那年今日<hanla></hanla></span></div><div id="history-baidu" style="height: 100px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>';
      console.log('已挂载<hanla></hanla>history_calendar')
      // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用<hanla></hanla>(支持<hanla></hanla>pjax<hanla></hanla>跳转)
      parent_div_git.insertAdjacentHTML("afterbegin", item_html) // 有报错，但不影响使用<hanla></hanla>(支持<hanla></hanla>pjax<hanla></hanla>跳转)
    }
    if (document.getElementsByClassName('sticky_layout')[0] & amp; & amp;
      (location.pathname === 'all' || 'all' === 'all'))
    {
      history_calendar_injector_config()
    } < /div>

  </script>
  <script data-pjax="" src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
  <script data-pjax="" src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script>
  <script data-pjax="">
    function butterfly_swiper_injector_config()
    {
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/08/13/15497.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/coderitl/Access@v1.0/medias/featureimages/7.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-13</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/08/13/15497.html&quot;);" href="javascript:void(0);" alt=""><hanla></hanla>文件上传下载实战<hanla></hanla></a><div class="blog-slider__text"><hanla></hanla>再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/08/13/15497.html&quot;);" href="javascript:void(0);" alt=""><hanla></hanla>详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/09/04/27324.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/coderitl/Access@v1.0/medias/featureimages/8.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"></a><div class="blog-slider__content"><span class="blog-slider__code">2022-09-04</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/09/04/27324.html&quot;);" href="javascript:void(0);" alt="">Docker<hanla></hanla>安装<hanla></hanla>Oracle</a><div class="blog-slider__text"><hanla></hanla>再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/09/04/27324.html&quot;);" href="javascript:void(0);" alt=""><hanla></hanla>详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/11/30/42622.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://i.328888.xyz/2023/04/01/i2p4AN.jpeg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"></a><div class="blog-slider__content"><span class="blog-slider__code">2022-11-30</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/11/30/42622.html&quot;);" href="javascript:void(0);" alt="">SpringCloud</a><div class="blog-slider__text"><hanla></hanla>再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/11/30/42622.html&quot;);" href="javascript:void(0);" alt=""><hanla></hanla>详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/12/29/2485.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/coderitl/Access@v1.0/medias/featureimages/2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"></a><div class="blog-slider__content"><span class="blog-slider__code">2022-12-29</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/12/29/2485.html&quot;);" href="javascript:void(0);" alt="">Ubuntu-系统<hanla></hanla></a><div class="blog-slider__text"><hanla></hanla>再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/12/29/2485.html&quot;);" href="javascript:void(0);" alt=""><hanla></hanla>详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
      console.log('已挂载<hanla></hanla>butterfly_swiper')
      parent_div_git.insertAdjacentHTML("afterbegin", item_html)
    }
    var elist = 'undefined'.split(',');
    var cpage = location.pathname;
    var epage = 'all';
    var flag = 0;
    for (var i = 0; i

  </script>
  <script defer="" src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script>
  <script defer="" data-pjax="" src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script>
  <script data-pjax="" src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script>
  <script data-pjax="">
    function gitcalendar_injector_config()
    {
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 280px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin", item_html)
      console.log('已挂载<hanla></hanla>gitcalendar')
    }
    if (document.getElementById('recent-posts') && (location.pathname === '/' || '/' === 'all'))
    {
      gitcalendar_injector_config()
      GitCalendarInit("https://python-github-calenda-4cx5gxbnc-coderitl.vercel.app/api?coderitl", ['#e4dfd7', '#f9f4dc', '#f7e8aa', '#f7e8aa', '#f8df72', '#fcd217', '#fcc515', '#f28e16', '#fb8b05', '#d85916', '#f43e06'], 'coderitl')
    }

  </script>
  <script async="" src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end -->
  <script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script>
  <script>
    L2Dwidget.init(
    {
      "pluginModelPath": "assets/",
      "model":
      {
        "jsonPath": "/live2dw/assets/shizuku.model.json"
      },
      "display":
      {
        "position": "left",
        "width": 150,
        "height": 300
      },
      "mobile":
      {
        "show": false
      },
      "rect":
      {
        "opacity": 0.7
      },
      "log": false,
      "pluginJsPath": "lib/",
      "pluginRootPath": "live2dw/",
      "tagMode": false
    });

  </script>



</body></html>