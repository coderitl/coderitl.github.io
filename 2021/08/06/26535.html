<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <title>MYSQL-高级 | coder-itl</title>
  <meta name="author" content="coder-itl">
  <meta name="copyright" content="coder-itl">
  <meta name="format-detection" content="telephone=no">
  <meta name="theme-color" content="#ffffff">
  <meta name="description" content="索引 索引概述 索引: 索引(index)是帮助MYSQL高效获取的数据结构。在数据之外，数据库系统还维护者满足特定查找算法的数据结构，这些数据结构以某种方式引用(指向)数据，这样就可以在这些数据结构上实现查找算法，这些数据结构就是索引。   引出    无索引 有索引         在SQL: select * from user where age = 45这条语句上,在没有索引时,查询数据">
  <meta property="og:type" content="article">
  <meta property="og:title" content="MYSQL-高级">
  <meta property="og:url" content="https://coderitl.github.io/2021/08/06/26535.html">
  <meta property="og:site_name" content="coder-itl">
  <meta property="og:description" content="索引 索引概述 索引: 索引(index)是帮助MYSQL高效获取的数据结构。在数据之外，数据库系统还维护者满足特定查找算法的数据结构，这些数据结构以某种方式引用(指向)数据，这样就可以在这些数据结构上实现查找算法，这些数据结构就是索引。   引出    无索引 有索引         在SQL: select * from user where age = 45这条语句上,在没有索引时,查询数据">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:image" content="https://i.328888.xyz/2023/04/01/i2pIO3.jpeg">
  <meta property="article:published_time" content="2021-08-06T02:55:47.000Z">
  <meta property="article:modified_time" content="2023-06-22T11:51:59.462Z">
  <meta property="article:author" content="coder-itl">
  <meta property="article:tag" content="coder-itl,Java,HTML+CSS,Hexo,MYSQL">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:image" content="https://i.328888.xyz/2023/04/01/i2pIO3.jpeg">
  <link rel="shortcut icon" href="https://img-blog.csdnimg.cn/f44f454681b440f3a8ae5f086d3c07d9.png">
  <link rel="canonical" href="https://coderitl.github.io/2021/08/06/26535.html">
  <link rel="preconnect" href="//cdn.jsdelivr.net">
  <link rel="preconnect" href="//busuanzi.ibruce.info">
  <link rel="stylesheet" href="/css/index.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'">
  <script>
    const GLOBAL_CONFIG = {
      root: '/',
      algolia: undefined,
      localSearch:
      {
        "path": "/search.xml",
        "preload": false,
        "languages":
        {
          "hits_empty": "找不到您查询的内容：${query}"
        }
      },
      translate: undefined,
      noticeOutdate: undefined,
      highlight:
      {
        "plugin": "highlighjs",
        "highlightCopy": true,
        "highlightLang": false,
        "highlightHeightLimit": false
      },
      copy:
      {
        success: '复制成功',
        error: '复制错误',
        noSupport: '浏览器不支持'
      },
      relativeDate:
      {
        homepage: false,
        post: false
      },
      runtime: '',
      date_suffix:
      {
        just: '刚刚',
        min: '分钟前',
        hour: '小时前',
        day: '天前',
        month: '个月前'
      },
      copyright: undefined,
      lightbox: 'fancybox',
      Snackbar: undefined,
      source:
      {
        justifiedGallery:
        {
          js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
          css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
        }
      },
      isPhotoFigcaption: false,
      islazyload: true,
      isAnchor: false,
      percent:
      {
        toc: true,
        rightside: false,
      }
    }

  </script>
  <script id="config-diff">
    var GLOBAL_CONFIG_SITE = {
      title: 'MYSQL-高级',
      isPost: true,
      isHome: false,
      isHighlightShrink: false,
      isToc: true,
      postUpdate: '2023-06-22 19:51:59'
    }

  </script><noscript>
    <style type="text/css">
      #nav
      {
        opacity: 1
      }

      .justified-gallery img
      {
        opacity: 1
      }

      #recent-posts time,
      #post-meta time
      {
        display: inline !important
      }

    </style>
  </noscript>
  <script>
    (win =>
    {
      win.saveToLocal = {
        set: function setWithExpiry(key, value, ttl)
        {
          if (ttl === 0) return
          const now = new Date()
          const expiryDay = ttl * 86400000
          const item = {
            value: value,
            expiry: now.getTime() + expiryDay,
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
        get: function getWithExpiry(key)
        {
          const itemStr = localStorage.getItem(key)
          if (!itemStr)
          {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = new Date()
          if (now.getTime() > item.expiry)
          {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
      win.getScript = url => new Promise((resolve, reject) =>
      {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function ()
        {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(script)
      })
      win.getCSS = url => new Promise((resolve, reject) =>
      {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        link.onload = () => resolve()
        link.onerror = () => reject()
        document.head.appendChild(link)
      })
      win.activateDarkMode = function ()
      {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null)
        {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function ()
      {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null)
        {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
      if (t === 'dark') activateDarkMode()
      else if (t === 'light') activateLightMode()
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined)
      {
        if (asideStatus === 'hide')
        {
          document.documentElement.classList.add('hide-aside')
        }
        else
        {
          document.documentElement.classList.remove('hide-aside')
        }
      }
      const detectApple = () =>
      {
        if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent))
        {
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)

  </script>
  <link rel="stylesheet" href="/css/modify.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css" media="defer" onload="this.media='all'">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/coderitl/FileJsDeliver@v1.1.12/css/gitcalendar.css" media="defer" onload="this.media='all'">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/coderitl/FileJsDeliver@v1.1.13/swiper/swiper.min.css" media="defer" onload="this.media='all'">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/coderitl/FileJsDeliver@v1.1.13/swiper/swiperstyle.css" media="defer" onload="this.media='all'">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/animate-css/animate.css@3.7.2/animate.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css" media="defer">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/coderitl/globalfont@v0.0.4/my.css">
  <link rel="stylesheet" href="/css/my.css">
  <meta name="referrer" content="no-referrer"><!-- hexo injector head_end start -->
  <style>
    body hanla:after
    {
      content: ' ';
      display: inline;
      font-family: inherit;
      font-size: 0.45em;
    }

    html code hanla,
    html pre hanla,
    html kbd hanla,
    html samp hanla,
    html ruby hanla,
    html .tag-list-item hanla
    {
      display: none;
    }

    html ol>hanla,
    html ul>hanla
    {
      display: none;
    }

  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css">
  <style>
    #recent-posts>.recent-post-item>.recent-post-info>.article-meta-wrap>.tags:before
    {
      content: "\A";
      white-space: pre;
    }

    #recent-posts>.recent-post-item>.recent-post-info>.article-meta-wrap>.tags>.article-meta__separator
    {
      display: none
    }

  </style>
  <link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'">
  <link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'">
  <link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'">
  <link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'">
  <link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'">
  <script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end -->
  <meta name="generator" content="Hexo 5.4.2">
  <link rel="alternate" href="/atom.xml" title="coder-itl" type="application/atom+xml">
</head>

<body>
  <div id="loading-box">
    <div class="loading-left-bg"></div>
    <div class="loading-right-bg"></div>
    <div class="spinner-box">
      <div class="configure-border-1">
        <div class="configure-core"></div>
      </div>
      <div class="configure-border-2">
        <div class="configure-core"></div>
      </div>
      <div class="loading-word">加载中...</div>
    </div>
  </div>
  <script>
    const preloader = {
      endLoading: () =>
      {
        document.body.style.overflow = 'auto';
        document.getElementById('loading-box').classList.add("loaded")
      },
      initLoading: () =>
      {
        document.body.style.overflow = '';
        document.getElementById('loading-box').classList.remove("loaded")
      }
    }
    window.addEventListener('load', () =>
    {
      preloader.endLoading()
    })
    if (true)
    {
      document.addEventListener('pjax:send', () =>
      {
        preloader.initLoading()
      })
      document.addEventListener('pjax:complete', () =>
      {
        preloader.endLoading()
      })
    }

  </script>
  <div id="web_bg"></div>
  <div id="sidebar">
    <div id="menu-mask"></div>
    <div id="sidebar-menus">
      <div class="avatar-img is-center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://i.328888.xyz/2023/03/19/MJUXa.jpeg" onerror="onerror=null;src='https://i.328888.xyz/2023/03/20/P3kfC.gif'" alt="avatar"></div>
      <div class="sidebar-site-data site-data is-center"><a href="/archives/">
          <div class="headline">
            <hanla></hanla>文章<hanla></hanla>
          </div>
          <div class="length-num">119</div>
        </a><a href="/tags/">
          <div class="headline">
            <hanla></hanla>标签<hanla></hanla>
          </div>
          <div class="length-num">21</div>
        </a><a href="/categories/">
          <div class="headline">
            <hanla></hanla>分类<hanla></hanla>
          </div>
          <div class="length-num">13</div>
        </a></div>
      <hr>
      <div class="menus_items">
        <div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div>
        <div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div>
        <div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div>
        <div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div>
        <div class="menus_item"><a class="site-page" href="/Timeline/"><i class="fa-fw fab fa-docker"></i><span> 日志</span></a></div>
        <div class="menus_item"><a class="site-page" href="/Java-%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/"><i class="fa-fw fas fa-link"></i><span> 学习路线</span></a></div>
        <div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于<hanla></hanla></span></a></div>
      </div>
    </div>
  </div>
  <div class="post" id="body-wrap">
    <header class="post-bg" id="page-header" style="background-image: url('https://i.328888.xyz/2023/04/01/i2pIO3.jpeg')">
      <nav id="nav"><span id="blog-info"><a href="/" title="coder-itl"><span class="site-name">coder-itl</span></a></span>
        <div id="menus">
          <div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div>
          <div class="menus_items">
            <div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div>
            <div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div>
            <div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div>
            <div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div>
            <div class="menus_item"><a class="site-page" href="/Timeline/"><i class="fa-fw fab fa-docker"></i><span> 日志</span></a></div>
            <div class="menus_item"><a class="site-page" href="/Java-%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/"><i class="fa-fw fas fa-link"></i><span> 学习路线</span></a></div>
            <div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于<hanla></hanla></span></a></div>
          </div>
          <div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div>
        </div>
      </nav>
      <div id="post-info">
        <h1 class="post-title">MYSQL-高级</h1>
        <div id="post-meta">
          <div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于<hanla></hanla></span><time class="post-meta-date-created" datetime="2021-08-06T02:55:47.000Z" title="发表于 2021-08-06 10:55:47">2021-08-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于<hanla></hanla></span><time class="post-meta-date-updated" datetime="2023-06-22T11:51:59.462Z" title="更新于 2023-06-22 19:51:59">2023-06-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/SQL/">SQL</a></span></div>
          <div class="meta-secondline"><span class="post-meta-separator">|</span><span id="" data-flag-title="MYSQL-高级"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div>
        </div>
      </div>
    </header>
    <main class="layout" id="content-inner">
      <div id="post"><div class="top-img" style="background-image: url('https://i.328888.xyz/2023/04/01/i2pIO3.jpeg');"></div>
        <article class="post-content" id="article-container">
          <h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>
            <hanla></hanla>索引
          </h3>
          <ul>
            <li>
              <p>索引概述</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>索引: 索引<hanla></hanla>(<code>index</code>)<hanla></hanla>是帮助<hanla></hanla><code>MYSQL</code>
                  <hanla></hanla>高效获取的数据结构。在数据之外，数据库系统还维护者满足特定查找算法的数据结构，这些数据结构以某种方式引用<hanla></hanla>(<code>指向</code>)<hanla></hanla>数据，这样就可以在这些数据结构上实现查找算法，这些数据结构就是索引。
                </p>
              </div>
            </li>
            <li>
              <p>引出</p>
              <table>
                <thead>
                  <tr>
                    <th align="center">无索引</th>
                    <th align="center">有索引</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/03441917b84d4edc95cd92c42bff6e17.png"></td>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/5a64c3497c144b9e9c331510ac970fe7.png"></td>
                  </tr>
                </tbody>
              </table>
              <blockquote>
                <p>在<hanla></hanla><code>SQL: select * from user where age = 45</code>
                  <hanla></hanla>这条语句上,<hanla></hanla>在没有索引时,<hanla></hanla>查询数据时会进行全表扫描,<hanla></hanla>这种效率是极低的,<hanla></hanla>而当建立了索引时,<hanla></hanla>维护了一个二叉树<hanla></hanla>(用于举例),<hanla></hanla>因为<hanla></hanla><code>age=45</code>,<hanla></hanla>此时会将<hanla></hanla><code>45</code>
                  <hanla></hanla>与该节点（<code>36</code>）进行比较,<hanla></hanla>在这条<hanla></hanla><code>SQL</code>
                  <hanla></hanla>中,<hanla></hanla>要命中也只进行了<hanla></hanla><code>3</code>
                  <hanla></hanla>次比较,<hanla></hanla>就获取到了数据
                </p>
              </blockquote>
              <blockquote>
                <p>
                  <font color="orange">上面的二叉树只是一个示意图,<hanla></hanla>并不是真实的索引结构</font>
                </p>
              </blockquote>
            </li>
            <li>
              <p>索引的优势</p>
              <ol>
                <li>类似于书籍的目录索引，提高数据检索效率，降低数据库的<hanla></hanla><code>IO</code>
                  <hanla></hanla>成本
                </li>
                <li>通过索引列对数据进行排序，降低数据排序的成本，降低<hanla></hanla><code>CPU</code>
                  <hanla></hanla>的消耗
                </li>
              </ol>
            </li>
            <li>
              <p>索引的劣势</p>
              <ol>
                <li>实际上索引也是一张表，该表中保存了主键与索引字段，并指向实体类的记录，所以索引列也是占用空间的</li>
                <li>虽然索引大大提高了效率，同时却也降低了更新表的速度，如对表进行<hanla></hanla><code>insert</code>、<code>update</code>、<code>delete</code>，因为更新表时，<code>MYSQL</code>
                  <hanla></hanla>不仅要保存数据，还要保存一下索引文件每次更新添加了索引列的字段，都会调整因为更新所带来的键值变化后的索引信息
                </li>
              </ol>
            </li>
          </ul>
          <h3 id="树"><a href="#树" class="headerlink" title="树"></a>树</h3>
          <ul>
            <li>
              <p>二叉树</p>
              <table>
                <thead>
                  <tr>
                    <th align="center">二叉树</th>
                    <th align="center">红黑树</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/77acbf9971254ac8aaf06866c910eed9.png"></td>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/2f99d5103d6b457ba157292c295175d2.png"></td>
                  </tr>
                </tbody>
              </table>
              <blockquote>
                <p>二叉树缺点: 顺序插入时,<hanla></hanla>会形成一个链表,<hanla></hanla>查询性能大大降低。大数据量情况下,<hanla></hanla>层级较深,<hanla></hanla>检索速度较慢</p>
              </blockquote>
              <blockquote>
                <p>通过<code>红黑树</code>解决二叉树的平衡问题,<hanla></hanla>红黑树在大数据量情况下,<hanla></hanla>层级较深,<hanla></hanla>检索速度慢。因此后面出现<hanla></hanla><code>B-TREE</code></p>
              </blockquote>
            </li>
          </ul>
          <h3 id="索引结构"><a href="#索引结构" class="headerlink" title="索引结构"></a>索引结构</h3>
          <ul>
            <li>
              <p><code>MYSQL</code>
                <hanla></hanla>目前提供的索引
              </p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <ul>
                  <li><code>BTREE</code>
                    <hanla></hanla>索引：最常见的索引类型，大部分索引都支持<hanla></hanla><code>B<hanla></hanla>树</code>索引
                  </li>
                  <li><code>HASH</code>
                    <hanla></hanla>索引：只有<hanla></hanla><code>Memory</code>
                    <hanla></hanla>引擎支持，使用场景简单
                  </li>
                  <li><code>R-tree</code>
                    <hanla></hanla>索引：空间索引是<hanla></hanla><code>MyISAM</code>
                    <hanla></hanla>引擎的一个特殊索引类型，主要用于地理空间数据结构，通常使用较少
                  </li>
                  <li><code>Full-text</code>
                    <hanla></hanla>索引：全文索引也是<hanla></hanla><code>MyISAM</code>
                    <hanla></hanla>的一个特殊索引类型，主要用于全文索引，<code>InnoDB</code>
                    <hanla></hanla>从<hanla></hanla><code>MYSQL5.6</code>
                    <hanla></hanla>版本开始支持全文索引
                  </li>
                </ul>
              </div>
            </li>
            <li>
              <p><code>BTREE</code> 结构</p>
              <blockquote>
                <p>树的度数指的是一个节点的子节点个数</p>
              </blockquote>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p><code>BTree</code>
                  <hanla></hanla>又叫多路平衡搜索树，一颗<hanla></hanla><code>m</code>
                  <hanla></hanla>叉的<hanla></hanla><code>BTree</code>
                  <hanla></hanla>特性如下：
                </p>
                <ul>
                  <li>树中每个节点最多包含<hanla></hanla><code>m</code>
                    <hanla></hanla>个孩子
                  </li>
                  <li>除根节点与叶子节点外,<hanla></hanla>每个节点至少有<hanla></hanla><code>ceil(m/2)</code>
                    <hanla></hanla>个孩子
                  </li>
                  <li>若根节点不是叶子节点，则至少有两个孩子</li>
                  <li>所有的叶子节点都在同一层</li>
                  <li>每个非叶子节点由<hanla></hanla><code>n</code>
                    <hanla></hanla>个<hanla></hanla><code>key</code>
                    <hanla></hanla>与<hanla></hanla><code>n+1</code>
                    <hanla></hanla>个指针组成,<hanla></hanla>其中<hanla></hanla><code>[ceil(m/2)]&lt;= n &lt;= m-1</code>
                  </li>
                </ul>
                <table>
                  <thead>
                    <tr>
                      <th align="center"><code>BTree</code></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/b66672cad4164e58adae97468401b3f2.png"></td>
                    </tr>
                  </tbody>
                </table>
                <blockquote>
                  <p>查看<hanla></hanla>Btree<hanla></hanla>的分裂过程: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.cs.usfca.edu/~galles/visualization/BTree.html">https://www.cs.usfca.edu/~galles/visualization/BTree.html</a></p>
                </blockquote>
              </div>
            </li>
            <li>
              <p><code>B+Tree</code>
                <hanla></hanla>结构
              </p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p><code>B+Tree</code>
                  <hanla></hanla>为<hanla></hanla><code>BTree</code>
                  <hanla></hanla>的变种，<code>B+Tree</code>
                  <hanla></hanla>与<hanla></hanla><code>BTree</code>
                  <hanla></hanla>的区别为:
                </p>
                <ol>
                  <li>
                    <p><code>n</code>
                      <hanla></hanla>叉<hanla></hanla><code>B+Tree</code>
                      <hanla></hanla>最多含有<hanla></hanla><code>n</code>
                      <hanla></hanla>个<hanla></hanla><code>key</code>,<hanla></hanla>而<hanla></hanla><code>BTree</code>
                      <hanla></hanla>最多含有<hanla></hanla><code>n-1</code>
                      <hanla></hanla>个<hanla></hanla><code>key</code>
                    </p>
                  </li>
                  <li>
                    <p><code>B+Tree</code>
                      <hanla></hanla>的叶子节点保存所有的<hanla></hanla><code>key</code>
                      <hanla></hanla>信息,<hanla></hanla>依<hanla></hanla><code>key</code>
                      <hanla></hanla>大小顺序排列
                    </p>
                  </li>
                  <li>
                    <p>所有的非叶子节点都可以看作是<hanla></hanla><code>key</code>
                      <hanla></hanla>的索引部分
                    </p>
                    <table>
                      <thead>
                        <tr>
                          <th align="center">经典<hanla></hanla><code>B+Tree</code></th>
                          <th align="center"><code>MYSQL</code>
                            <hanla></hanla>中对<hanla></hanla><code>B+Tree</code>
                            <hanla></hanla>进行了优化
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/8c90c387b8794472a7f8f401ccf2c275.png"></td>
                          <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/05b7aa9164094e34a5962a4d879f7bf2.png"></td>
                        </tr>
                      </tbody>
                    </table>
                  </li>
                </ol>
                <p><code>MYSQL</code>
                  <hanla></hanla>索引数据结构对经典的<hanla></hanla><code>B+Tree</code>
                  <hanla></hanla>进行了优化,<hanla></hanla>在原<hanla></hanla><code>B+Tree</code>
                  <hanla></hanla>的基础上,<hanla></hanla>增加了一个指向相邻叶子节点的链表指针,<hanla></hanla>就形成了带有顺序指针的<hanla></hanla><code>B+Tree</code>，提高区间访问的性能
                </p>
              </div>
            </li>
            <li>
              <p><code>Hash</code>
                <hanla></hanla>索引
              </p>
              <blockquote>
                <p>哈希索引就是采用一定的<hanla></hanla><code>hash</code>
                  <hanla></hanla>算法,<hanla></hanla>将键值换算成新的<hanla></hanla><code>hash</code>
                  <hanla></hanla>值,<hanla></hanla>映射到对应的槽位上，然后存储在<hanla></hanla><code>hash</code>
                  <hanla></hanla>表中
                </p>
                <p>哈希碰撞: 如果两个<hanla></hanla>(或者多个)<hanla></hanla>键值,<hanla></hanla>映射到一个相同的槽位上,<hanla></hanla>它们就产生了<hanla></hanla><code>hash</code>
                  <hanla></hanla>冲突<hanla></hanla>(也成为<hanla></hanla><code>hash</code>
                  <hanla></hanla>碰撞),<hanla></hanla>可以通过<code>链表</code>来解决
                </p>
              </blockquote>
              <table>
                <thead>
                  <tr>
                    <th align="center">哈希索引</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/9693a8ee328240d79f678fd5631b6d8b.png"></td>
                  </tr>
                </tbody>
              </table>
              <ul>
                <li>特点<ul>
                    <li><code>Hash</code>
                      <hanla></hanla>索引只能用于对等比较<hanla></hanla><code>=,in</code>，不支持范围查询<hanla></hanla>(<code>between,&gt;,&lt;,...</code>)
                    </li>
                    <li>无法利用索引完成排序操作</li>
                    <li>查询效率高,<hanla></hanla>通常<hanla></hanla>(<code>只要不出现哈希碰撞</code>)<hanla></hanla>只需要一次检索就可以了,<hanla></hanla>效率通常要高于<hanla></hanla><code>B+tree</code>
                      <hanla></hanla>索引
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>
              <p><code>B+Tree</code>
                <hanla></hanla>相对于<hanla></hanla><code>BTree</code>
                <hanla></hanla>的区别
              </p>
              <ul>
                <li><code>B+Tree</code>
                  <hanla></hanla>所有的数据都会出现在叶子节点
                </li>
                <li>叶子节点形成一个单向链表</li>
              </ul>
            </li>
          </ul>
          <h3 id="索引分类"><a href="#索引分类" class="headerlink" title="索引分类"></a>索引分类</h3>
          <ul>
            <li>
              <p>分类</p>
              <table>
                <thead>
                  <tr>
                    <th align="center">分类</th>
                    <th align="center">含义</th>
                    <th align="center">特点</th>
                    <th align="center">关键词</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center">主键索引</td>
                    <td align="center">针对于表中主键创建的索引</td>
                    <td align="center">默认自动创建，只能有一个</td>
                    <td align="center"><code>primary</code></td>
                  </tr>
                  <tr>
                    <td align="center">唯一索引</td>
                    <td align="center">避免同一个表中某数据列中的值重复</td>
                    <td align="center">可以有多个</td>
                    <td align="center"><code>unique</code></td>
                  </tr>
                  <tr>
                    <td align="center">常规索引</td>
                    <td align="center">快速定位特定数据</td>
                    <td align="center">可以有多个</td>
                    <td align="center"></td>
                  </tr>
                  <tr>
                    <td align="center">全文索引</td>
                    <td align="center">全文索引查找的是文本中的关键词，而不是比较索引中的值</td>
                    <td align="center">可以有多个</td>
                    <td align="center"><code>fulltext</code></td>
                  </tr>
                </tbody>
              </table>
            </li>
          </ul>
          <h3 id="索引语法"><a href="#索引语法" class="headerlink" title="索引语法"></a>索引语法</h3>
          <ul>
            <li>
              <p>基础语法</p>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">-- 创建索引<hanla></hanla></span></span><br><span class="line"><span class="keyword">create</span> index idx_test_name <span class="keyword">on</span> tableName (<span class="keyword">table</span><span class="operator">-</span>key);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看索引<hanla></hanla></span></span><br><span class="line"><span class="keyword">show</span> index <span class="keyword">from</span> tableName;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除索引<hanla></hanla></span></span><br><span class="line"><span class="keyword">drop</span> index index_name <span class="keyword">on</span> tableName;</span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>练习</p>
              <ul>
                <li>
                  <p><code>name</code>
                    <hanla></hanla>字段为姓名字段，该字段的值可能会重复，为该字段创建索引
                  </p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">create</span> index idx_user_name <span class="keyword">on</span> t_user(name);</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p><code>phone</code>
                    <hanla></hanla>手机号字段的值,<hanla></hanla>是非空,<hanla></hanla>且唯一的，为该字段创建唯一索引
                  </p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">create</span> <span class="keyword">unique</span> index idx_user_phone <span class="keyword">on</span> t_user(phone);</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>为<hanla></hanla><code>profession，age,status</code>
                    <hanla></hanla>创建联合索引
                  </p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">create</span> index idx_user_pro_age_status <span class="keyword">on</span> t_user(profession,age,status);</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>为<hanla></hanla><code>email</code>
                    <hanla></hanla>建立合适的索引来提升查询效率
                  </p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">create</span> index  idx_user_email <span class="keyword">on</span> t_user(email);</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">查看当前表有那些索引信息</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/700e44c73ef24980b5eab37295823413.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
              </ul>
            </li>
            <li>
              <p>在<hanla></hanla><code>InnoDB</code>
                <hanla></hanla>存储引擎中,<hanla></hanla>根据索引的存储形式，又可以分为如下两种
              </p>
              <table>
                <thead>
                  <tr>
                    <th>分类</th>
                    <th>含义</th>
                    <th>特点</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>聚集索引</td>
                    <td>将数据存储与索引放到了一块，索引结构的叶子节点保存了行数据</td>
                    <td>必须有，而且只能有一个</td>
                  </tr>
                  <tr>
                    <td>二级索引<hanla></hanla>(也叫非聚簇索引)</td>
                    <td>将数据与索引分开存储，索引结构的叶子节点关联的是对应的主键</td>
                    <td>可以存在多个</td>
                  </tr>
                </tbody>
              </table>
              <ul>
                <li>
                  <p>聚集索引选取规则</p>
                  <ul>
                    <li>如果存在主键，主键索引就是聚集索引</li>
                    <li>如果不存在主键，将使用第一个唯一索引作为聚集索引</li>
                    <li>如果表没有主键，或没有合适的唯一索引，则<hanla></hanla><code>InnoDB</code>
                      <hanla></hanla>会自动生成一个<hanla></hanla><code>rowid</code>
                      <hanla></hanla>作为隐藏的聚集索引
                    </li>
                  </ul>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">聚集索引与非聚集索引的区别</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/61a6737cf1854b1e9ee459917a45e3c6.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p><code>select * from user where name = 'Arm'</code></p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">执行流程</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/77f8900c0f114cab857ad7d297fe4bb7.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p>思考那个执行效率高</p>
                  <ul>
                    <li><code>select * from user where id = 10 (效率高)</code></li>
                    <li><code>select * from user where name = 'Arm'(需要回表)</code></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
          <h3 id="为什么-InnoDB-存储引擎选择使用-B-tree-索引"><a href="#为什么-InnoDB-存储引擎选择使用-B-tree-索引" class="headerlink" title="为什么 InnoDB 存储引擎选择使用 B+tree 索引"></a>为什么 InnoDB 存储引擎选择使用 B+tree 索引</h3>
          <ul>
            <li>
              <p>二叉树和红黑树</p>
              <table>
                <thead>
                  <tr>
                    <th align="center">二叉树和红黑树</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/2f2c1fa4c953434cbf9be3cd2cdd949b.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p>树形结构的缺点</p>
              <ul>
                <li>二叉树缺点: 顺序插入时,<hanla></hanla>会形成一个链表，查询性能大大降低。大数据情况下,<hanla></hanla>层级较深，检索速度慢</li>
                <li>红黑树: 大数据量情况下,<hanla></hanla>层级较深,<hanla></hanla>检索速度慢</li>
              </ul>
            </li>
            <li>
              <p>选择<hanla></hanla><code>B+tree</code>
                <hanla></hanla>的原因
              </p>
              <ul>
                <li>
                  <p>相对于二叉树，层绞更少，搜索效率高</p>
                </li>
                <li>
                  <p>对于<hanla></hanla><code>B-tree</code>，无论是叶子节点还是非叶子节点，都会保存数据，这样导致一页中存储的键值减少，指针跟着减少，要同样保存大量数据,<hanla></hanla>只能增加树的高度，导致性能降低</p>
                </li>
                <li>
                  <p>相对于<hanla></hanla><code>Hash</code>
                    <hanla></hanla>索引，<code>B+tree</code>
                    <hanla></hanla>支持范围匹配以及排序操作
                  </p>
                </li>
              </ul>
            </li>
          </ul>
          <h3 id="SQL-性能分析"><a href="#SQL-性能分析" class="headerlink" title="SQL 性能分析"></a>SQL 性能分析</h3>
          <ul>
            <li>
              <p>显示当前<hanla></hanla><code>session</code>
                <hanla></hanla>中所有统计参数的值
              </p>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"># [session<span class="operator">|</span><span class="keyword">global</span>] 命令可以提供服务器状态信息，通过如下指令，可以查看当前数据库的 <span class="keyword">insert</span>,<span class="keyword">update</span>,<span class="keyword">delete</span>,<span class="keyword">select</span> 的访问频次 _(<span class="number">7</span><hanla></hanla>个)</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> status  <span class="keyword">like</span> <span class="string">'Com_______'</span>;</span><br><span class="line"></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+-------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name <span class="operator">|</span> <span class="keyword">Value</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+-------+</span></span><br><span class="line"><span class="operator">|</span> Com_binlog    <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Com_commit    <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Com_delete    <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Com_import    <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Com_insert    <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Com_repair    <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Com_revoke    <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Com_select    <span class="operator">|</span> <span class="number">2</span>     <span class="operator">|</span> # 查询两次</span><br><span class="line"><span class="operator">|</span> Com_signal    <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Com_update    <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Com_xa_end    <span class="operator">|</span> <span class="number">0</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+-------+</span></span><br><span class="line"><span class="number">11</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>查看<hanla></hanla><code>Innodb</code>
                <hanla></hanla>对于增删改查影响
              </p>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> statys <span class="keyword">like</span> <span class="string">'Innodb_rows_%'</span>;</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>慢查询日志</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>慢查询日志记录了所有执行时间超过指定参数<hanla></hanla>(<code>long_query_time</code>，单位: 秒,<hanla></hanla>默认<hanla></hanla><code>10s</code>)<hanla></hanla>的所有<hanla></hanla><code>SQL</code>
                  <hanla></hanla>语句的日志
                </p>
                <p><code>MYSQL</code>
                  <hanla></hanla>的慢查询日志默认没有开启，需要在<hanla></hanla><code>MYSQL</code>
                  <hanla></hanla>的配置文件<hanla></hanla>(<code>/etc/my.cnf</code>)<hanla></hanla>中配置如下信息:
                </p>
              </div>
              <ul>
                <li>
                  <p>查看是否开启</p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"># 可以看出,<hanla></hanla>默认关闭<hanla></hanla></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">'slow_query_log'</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name  <span class="operator">|</span> <span class="keyword">Value</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------+</span></span><br><span class="line"><span class="operator">|</span> slow_query_log <span class="operator">|</span> OFF   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+-------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>开启慢查询开关</p>
                  <figure class="highlight ini">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment"># 开启 MYSQL 慢查询开关<hanla></hanla></span></span><br><span class="line"><span class="attr">slow_query_log</span>=<span class="number">1</span></span><br><span class="line"><span class="comment"># 设置慢日志的时间为 2s，SQL 语句执行时间超过 2s，就会视为慢查询,<hanla></hanla>记录慢查询日志<hanla></hanla></span></span><br><span class="line"><span class="attr">long_query_time</span>=<span class="number">2</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <blockquote>
                    <p>配置文件保存退出后,<hanla></hanla>重启<hanla></hanla><code>MYSQL</code>
                      <hanla></hanla>服务器进行测试,<hanla></hanla>查看慢日志文件中记录的值信息<hanla></hanla><code>/var/lib/mysql/localhost-slow.log</code>
                    </p>
                  </blockquote>
                  <figure class="highlight properties">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment"># 重启 mysqld 服务<hanla></hanla></span></span><br><span class="line"><span class="attr">systemctl</span> <span class="string">restart mysqld</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p><code>profile</code>
                    <hanla></hanla>详情
                  </p>
                  <ul>
                    <li>
                      <p><code>show profiles</code>
                        <hanla></hanla>能够在做<hanla></hanla><code>SQL</code>
                        <hanla></hanla>优化时帮助我们了解时间都耗费哪里去了
                      </p>
                    </li>
                    <li>
                      <p>查看当前数据库是否支持</p>
                      <figure class="highlight sql">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> @<span class="variable">@have_profiling</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+</span></span><br><span class="line"><span class="operator">|</span> @<span class="variable">@have_profiling</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+</span></span><br><span class="line"><span class="operator">|</span> YES              <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"># YES: 支持</span><br><span class="line"></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                    <li>
                      <p>默认<hanla></hanla><code>profiling</code>
                        <hanla></hanla>是关闭的，可以通过<hanla></hanla><code>set</code>
                        <hanla></hanla>语句在<hanla></hanla><code>session/global</code>
                        <hanla></hanla>级别开启<hanla></hanla><code>profiling</code>
                      </p>
                      <figure class="highlight properties">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="comment"># 查看 profiling 是否开启<hanla></hanla></span></span><br><span class="line"><span class="attr">mysql&gt;</span> <span class="string">select @@profiling;</span></span><br><span class="line"><span class="attr">+-------------+</span></span><br><span class="line"><span class="attr">|</span> <span class="string">@@profiling |</span></span><br><span class="line"><span class="attr">+-------------+</span></span><br><span class="line"><span class="attr">|</span>           <span class="string">0 |</span></span><br><span class="line"><span class="attr">+-------------+</span></span><br><span class="line"><span class="attr">1</span> <span class="string">row in set, 1 warning (0.00 sec)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 开启<hanla></hanla></span></span><br><span class="line"><span class="attr">set</span> <span class="string">profiling = 1;</span></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                    <li>
                      <p>详情</p>
                      <blockquote>
                        <p>执行一系列的业务 <code>SQL</code>
                          <hanla></hanla>的操作,<hanla></hanla>然后通过如下指令查看指令的执行耗时
                        </p>
                      </blockquote>
                      <figure class="highlight sql">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="comment">-- 查看每一条 SQL 的耗时情况<hanla></hanla></span></span><br><span class="line"><span class="keyword">show</span> profiles;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插卡指定 query_id 的 SQL 语句各个阶段的耗时情况<hanla></hanla></span></span><br><span class="line"><span class="keyword">show</span> profile <span class="keyword">for</span> query_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看指定 query_id 的 SQL 语句 CPU 的使用情况<hanla></hanla></span></span><br><span class="line"><span class="keyword">show</span> profile cpu <span class="keyword">for</span> query query_id;</span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
          <h3 id="explain"><a href="#explain" class="headerlink" title="explain"></a>explain</h3>
          <ul>
            <li>
              <p>是什么</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>使用<hanla></hanla><code>desc/explain</code>
                  <hanla></hanla>关键字可以模拟优化器执行<hanla></hanla><code>SQL</code>
                  <hanla></hanla>查询语句，从而知道<hanla></hanla><code>MYSQL</code>
                  <hanla></hanla>是如何处理<hanla></hanla><code>SQL</code>
                  <hanla></hanla>语句的。
                </p>
              </div>
            </li>
            <li>
              <p>怎么用?</p>
              <p>| <code>explain/desc</code> |</p>
            </li>
          </ul>
          <p>| :———————————————————-: |<br> | <img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/img_convert/141aeec00b1f5f4bfae7ed9e7588400a.png"> |</p>
          <ul>
            <li>
              <p>字段解释</p>
              <ul>
                <li>
                  <p><code>id</code></p>
                  <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                    <p><code>select</code>
                      <hanla></hanla>查询的序列号，表示查询中执行<hanla></hanla><code>select</code>
                      <hanla></hanla>子句或者是操作表的顺序<hanla></hanla>(<code>id</code>
                      <hanla></hanla>相同,<hanla></hanla>执行顺序从上到下,<code>id</code>
                      <hanla></hanla>不同,<hanla></hanla>值越大,<hanla></hanla>越先执行)
                    </p>
                  </div>
                </li>
                <li>
                  <p><code>select_type</code></p>
                  <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                    <p>表示<hanla></hanla><code>select</code>
                      <hanla></hanla>的类型,<hanla></hanla>常见的取值有:
                    </p>
                    <ul>
                      <li><code>SIMPLE</code>(<code>简单表,<hanla></hanla>即不使用表连接或者子查询</code>)</li>
                      <li><code>PRIMARY</code>(主查询,<hanla></hanla>即外层的查询)</li>
                      <li><code>UNION</code>(<code>UNION</code>
                        <hanla></hanla>中的第二个或者后面的查询语句)
                      </li>
                      <li><code>SUBQUERY</code>(<code>SELECT/WHERE</code>
                        <hanla></hanla>之后包含了子查询)
                      </li>
                    </ul>
                  </div>
                </li>
                <li>
                  <p><code>type</code></p>
                  <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                    <p>表示连接类型，性能由好到差的连接类型为<hanla></hanla><code>NULL，system，const,eq_ref,ref,range,index,all</code></p>
                  </div>
                </li>
                <li>
                  <p><code>possible_key</code>： 显示可能应用在这张表上的索引,<hanla></hanla>一个或多个</p>
                </li>
                <li>
                  <p><code>key</code>: 实际使用的索引,<hanla></hanla>如果为<hanla></hanla><code>NULL</code>，则没有使用索引</p>
                </li>
                <li>
                  <p><code>key_len</code>: 表示索引中使用的字节数,<hanla></hanla>该值为索引字段中最大可能长度，并非实际使用长度，在不损失精确性的前提下，长度越短越好</p>
                </li>
                <li>
                  <p><code>rows</code>: <code>MYSQL</code>
                    <hanla></hanla>认为必须要执行查询的行数,<hanla></hanla>在<hanla></hanla><code>InnoDB</code>
                    <hanla></hanla>引擎的表中,<hanla></hanla>是一个估计值,<hanla></hanla>可能并不是准确的
                  </p>
                </li>
                <li>
                  <p><code>filtered</code>: 表示返回结果的行数占需读取行数的百分比,<code>filtered</code>
                    <hanla></hanla>的值越大越好
                  </p>
                </li>
              </ul>
            </li>
          </ul>
          <h3 id="索引-使用规则"><a href="#索引-使用规则" class="headerlink" title="索引-使用规则"></a>索引-使用规则</h3>
          <ul>
            <li>
              <p>百万数据插入表中时,<hanla></hanla>该表需要建立<code>主键<hanla></hanla>(索引产生)</code></p>
            </li>
            <li>
              <p>最左前缀法则</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>如果索引了多列<hanla></hanla>(<code>联合索引</code>),<hanla></hanla>要遵守最左前缀法则。最左前缀法则指的是查询从索引的最左列开始，并且<code>不跳过索引中的列</code>。</p>
                <p>与位置<hanla></hanla>(位置: <code>最左侧的键</code>,<hanla></hanla>只需要<code>存在</code>即可)<hanla></hanla>无关</p>
              </div>
              <table>
                <thead>
                  <tr>
                    <th align="center">分析，经过<code>索引</code></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/646de574eba44f8cb140180998b85be9.png"></td>
                  </tr>
                </tbody>
              </table>
              <table>
                <thead>
                  <tr>
                    <th align="center">跳过联合索引中最左侧字段时,<code>
                        <hanla></hanla>索引失效
                      </code></th>
                    <th align="center">缺少除了最左侧或者跳跃外,<hanla></hanla>省略字段时,<hanla></hanla>依然经过索引</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/073d3c2f43d84bcea295208f637a6dd9.png"></td>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/44cc304072994f6995da33e11d62c2e7.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p>范围查询</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>
                  <font color="orange"><strong>TODO: 如何确定是那个字段没有进入索引范围的？</strong></font>
                </p>
                <p>联合索引中,<hanla></hanla>出现范围查询<hanla></hanla>(<code>&gt;,&lt;</code>),<code>
                    <hanla></hanla>范围查询右侧的列索引失效
                  </code></p>
                <table>
                  <thead>
                    <tr>
                      <th align="center">解决方案: 将<code>&gt;/&lt; </code>修改为<code>&gt;= / &lt;=(业务允许时)</code></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/ac1b4b973cb24e05ad80386889514d73.png"></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </li>
            <li>
              <p>索引列运算：不要在索引列上进行运算操作,<hanla></hanla>否则<code>索引将失效</code></p>
              <table>
                <thead>
                  <tr>
                    <th align="center">列运算导致索引失效（<code> explain select * from t_user where substring(phone,10,2)='15';</code>）</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/a05f0371f83945978e69dfd49bb3bfed.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p>字符串不加引号： 字符串类型字段使用时,<hanla></hanla>不加引号,<code>
                  <hanla></hanla>索引将失效
                </code></p>
              <table>
                <thead>
                  <tr>
                    <th align="center">字符串类型字段使用时,<hanla></hanla>不加引号,<code>
                        <hanla></hanla>索引将失效
                      </code></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/0d18181392d04839b63520240b3a12c3.png"></td>
                  </tr>
                </tbody>
              </table>
              <table>
                <thead>
                  <tr>
                    <th align="center">注意</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/49fef4133e414549836e454359d37e5d.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p>模糊查询: 如果仅仅是<code>尾部</code>模糊查询匹配,<hanla></hanla>索引不会失效,<hanla></hanla>如果是<code>头部</code>模糊匹配，索引失效</p>
              <table>
                <thead>
                  <tr>
                    <th align="center">模糊查询失效情况</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/3a8a7973138f43f29bbdb11e0e2efef6.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p><code>or</code>
                <hanla></hanla>连接条件
              </p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>用 <code>or</code>
                  <hanla></hanla>分割开的条件,<hanla></hanla>如果<hanla></hanla><code>or</code>
                  <hanla></hanla>前的条件中的列有索引,<hanla></hanla>而后面的列中没有索引，那么涉及的索引都不会被用到
                </p>
                <table>
                  <thead>
                    <tr>
                      <th align="center"><code>phone: idx_user_ohone age:null =&gt; 索引失效</code></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/faf390e9554d4d46aa6e7c4d8c18c717.png"></td>
                    </tr>
                  </tbody>
                </table>
                <p>要解决<hanla></hanla><code>or</code>
                  <hanla></hanla>连接索引不失效,<hanla></hanla>只需要为其添加索引即可
                </p>
                <table>
                  <thead>
                    <tr>
                      <th align="center">解决<hanla></hanla><code>or</code>
                        <hanla></hanla>索引失效
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/b3b3e596a24a4b1993364a0831840f1c.png"></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </li>
            <li>
              <p>数据分布影响: 如果<hanla></hanla><code>MYSQL</code>
                <hanla></hanla>评估使用索引比全表更慢,<hanla></hanla>则不使用索引
              </p>
              <table>
                <thead>
                  <tr>
                    <th align="center">预估以下范围小于该表，则选择索引</th>
                    <th align="center">数据分布导致索引失效</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/b5aff44930e14319bb33c6fedddef1f0.png"></td>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/1f6b643f704b4039850be13076b2eb90.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p><code>SQL</code>
                <hanla></hanla>提示：是优化数据库的一个重要手段,<hanla></hanla>简单来说，就是在<hanla></hanla><code>SQL</code>
                <hanla></hanla>语句中加入一些认为的提示来达到优化操作的目的
              </p>
              <table>
                <thead>
                  <tr>
                    <th align="center">问题引出: 为表字段<hanla></hanla><code>profession</code>
                      <hanla></hanla>创建索引,<hanla></hanla>查询时依然使用联合索引
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/1b1e5d3431a64221abf0b517933a71ac.png" alt="在这里插入图片描述"></td>
                  </tr>
                </tbody>
              </table>
              <ul>
                <li>
                  <p><code>use index</code>(使用索引)</p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_user use index(idx_user_profession) <span class="keyword">where</span> profession<span class="operator">=</span><span class="string">'化工'</span>;</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">使用指定索引</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/40f377635b204e3caf4b0eb2c97d38bd.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p><code>ignore index</code>(忽略某个索引)</p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_user ignore index(idx_user_pro_age_status) <span class="keyword">where</span> profession<span class="operator">=</span><span class="string">'化工'</span>;</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">忽略某个索引</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/faf47499dd0742d8a252188a62b12550.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p><code>force index</code>(强制使用某个索引)</p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_user force index(idx_user_profession) <span class="keyword">where</span> profession<span class="operator">=</span><span class="string">'化工'</span>;</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">强制使用某个索引</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/fc5a71a1582346ceb6c1dd817359c3e1.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
              </ul>
            </li>
            <li>
              <p>覆盖索引: 尽量使用覆盖索引<hanla></hanla>(查询使用了索引，并且需要返回的列，在该索引中已经全部能够找到),<hanla></hanla>减少<hanla></hanla><code>select *</code></p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p><code>using index condition</code>: 查找使用了索引，但是<code>需要回表</code>查询数据</p>
                <p><code>using where;using index</code>: 查找使用了索引，但是需要的数据都在索引列中能找到，所以不需要徽标查询数据</p>
                <table>
                  <thead>
                    <tr>
                      <th align="center">覆盖索引</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/ffd33dd17fc14fd7be586f80c0a57312.png"></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </li>
            <li>
              <p>思考题</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>一张表，有四个字段<hanla></hanla>(<code>id,username,password,status</code>) 由于数据量大，需要对以下<hanla></hanla><code>SQL</code>
                  <hanla></hanla>语句进行优化，该如何进行才是最优方案
                </p>
              </div>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">select</span> id,username,password,status <span class="keyword">from</span> t_user <span class="keyword">where</span> username <span class="operator">=</span><span class="string">'coder-itl'</span>;</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <blockquote>
                <p>答: 对<hanla></hanla><code>username,password</code>
                  <hanla></hanla>建立联合索引
                </p>
              </blockquote>
              <table>
                <thead>
                  <tr>
                    <th align="center">辅助索引下挂的是<hanla></hanla><code>id</code></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/1c60d20e279542e4b83ac07bee92d19b.png" style="zoom:50%;"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p>前缀索引</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>当字段类型为字符串<hanla></hanla>(<code>varchar,text</code>
                  <hanla></hanla>等)<hanla></hanla>时,<hanla></hanla>有时候需要索引很长的字符串,<hanla></hanla>这会让索引变得很大，查询时，浪费大量的磁盘<hanla></hanla><code>IO</code>，影响查询效率。此时可以只将字符串的一部分前缀，建立索引，这样可以大大节约索引空间，从而提高索引效率。
                </p>
              </div>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">-- n: 代表选取的字符个数<hanla></hanla></span></span><br><span class="line"><span class="keyword">create</span> index idx_xx <span class="keyword">on</span> table_name(<span class="keyword">column</span>(n));</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <ul>
                <li>
                  <p>前缀长度</p>
                  <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                    <p>可以根据索引的选择性来决定，而选择性是指不重复的索引值<hanla></hanla>(基数)<hanla></hanla>和数据表的记录总数的比值，索引选择性越高则查询效率越高，唯一索引的选择性是<hanla></hanla><code>1</code>，这是最好的索引选择性，性能也是最好的</p>
                  </div>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">-- 某个字段的选择性计算公式<hanla></hanla></span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> email)<span class="operator">/</span><span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> t_user;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> <span class="built_in">substring</span>(email,<span class="number">1</span>,<span class="number">5</span>))<span class="operator">/</span><span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> t_user;</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ul>
            </li>
            <li>
              <p>单列索引和联合索引</p>
              <ul>
                <li>
                  <p>单列索引: 即一个索引只能包含单个列</p>
                </li>
                <li>
                  <p>联合索引: 即一个索引包含了多个列</p>
                  <blockquote>
                    <p>在业务场景中，如果存在多个查询条件，考虑针对查询字段建立索引时,<hanla></hanla>建议建立联合索引，而非单列索引</p>
                  </blockquote>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">单列索引和联合索引</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/41a4d124fb3346c7ad5c23125ff051c3.png"></td>
                      </tr>
                    </tbody>
                  </table>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">联合索引的<hanla></hanla><code>B+Tree</code>
                          <hanla></hanla>结构
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/f53a6f2ddf484b478a162eb536c5fc8d.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
              </ul>
            </li>
          </ul>
          <h3 id="trace分析器执行计划"><a href="#trace分析器执行计划" class="headerlink" title="trace分析器执行计划"></a>trace<hanla></hanla>分析器执行计划</h3>
          <ul>
            <li>
              <p>设置格式</p>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">set</span> optimizer_trace<span class="operator">=</span>"enabled=on",end_markers_in_json<span class="operator">=</span><span class="keyword">on</span>;</span><br><span class="line"><span class="keyword">set</span> optimizer_trace_max_mem_size<span class="operator">=</span><span class="number">100000</span>;</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>执行<hanla></hanla><code>sql</code></p>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">select</span> xxx <span class="keyword">from</span> xxx;</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>检查<hanla></hanla><code>infomation_schema.optimizer_trace</code>
                <hanla></hanla>就可以知道<hanla></hanla><code>mysql</code>
                <hanla></hanla>是如何执行的
              </p>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> information_schema.optimizer_trace\G;</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
          </ul>
          <h3 id="索引使用"><a href="#索引使用" class="headerlink" title="索引使用"></a>索引使用</h3>
          <ul>
            <li>
              <p>索引失效情况</p>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><hanla></hanla>范围查询，字段运算，字符串不加单引号<hanla></hanla>(根据数据的类型)</span><br><span class="line"></span><br><span class="line">name<hanla></hanla>字段是索引列，而 createtime 不是索引列，中间是 <span class="keyword">or</span> 进行连接是不走索引的</span><br><span class="line"></span><br><span class="line">以 <span class="operator">%</span> 开头的 <span class="keyword">like</span><hanla></hanla>模糊索引查询,<hanla></hanla>索引失效，仅仅是尾部模糊匹配，索引就不会失效</span><br><span class="line"></span><br><span class="line">如果使用索引，发现全表扫描更快，就不走索引<hanla></hanla></span><br><span class="line"></span><br><span class="line"><span class="keyword">is</span> <span class="keyword">null</span>,<span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> 有时索引失效<hanla></hanla></span><br><span class="line"></span><br><span class="line"><span class="keyword">in</span> 走索引,<span class="keyword">not</span> <span class="keyword">in</span><hanla></hanla>索引失效</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>使用覆盖索引避免索引失效</p>
            </li>
            <li>
              <p>单列索引和复合索引如何选择?</p>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><hanla></hanla>尽量选择复合索引</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
          </ul>
          <h3 id="索引设计原则"><a href="#索引设计原则" class="headerlink" title="索引设计原则"></a>索引设计原则</h3>
          <ul>
            <li>
              <p>设计原则</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <ul>
                  <li>针对于数据量较大，且查询比较频繁的表建立索引</li>
                  <li>针对于常作为查询条件<hanla></hanla>(<code>where</code>)，排序<hanla></hanla>(<code>order by</code>)，分组<hanla></hanla>(<code>group by</code>)<hanla></hanla>操作的字段建立索引</li>
                  <li>尽量选择区分度高的列作为索引，尽量建立唯一索引，区分度越高，使用索引的效率越高</li>
                  <li>如果是字符串类型的字段，字段的长度较长，可以针对于字段的特点，建立前缀索引</li>
                  <li>尽量使用联合索引，减少单列索引，查询时，联合索引很多时候可以覆盖索引，节省存储空间，避免回表，提升查询效率</li>
                  <li>要控制索引的数量,<hanla></hanla>索引并不是多多益善，索引越多，维护索引结构的代价也就越大，会影响增删改的效率</li>
                  <li>如果索引列不能存储<hanla></hanla><code>null</code>
                    <hanla></hanla>值，请在创建表时使用<hanla></hanla><code>NOT NULL</code> 约束它。当优化器知道每列是否包含<hanla></hanla><code>NULL</code>
                    <hanla></hanla>值时，它可以更好地确定哪个索引最有效的用于查询
                  </li>
                </ul>
              </div>
            </li>
          </ul>
          <h3 id="SQL优化"><a href="#SQL优化" class="headerlink" title="SQL优化"></a>SQL<hanla></hanla>优化</h3>
          <h4 id="大批量插入数据"><a href="#大批量插入数据" class="headerlink" title="大批量插入数据"></a>大批量插入数据</h4>
          <ol>
            <li>
              <p>主键顺序插入</p>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><hanla></hanla>因为 InnoDB 类型的表是按照主键的顺序保存的，所以将导入的数据按照主键的顺序排列，可以有效的提高导入数据的效率</span><br><span class="line">如果 InnoDB 表没有主键，那么系统会自动默认创建一个内部列作为主键，所以如果可以给表创建一个主键，将可以利用这点，来提高导入数据的效率</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
          </ol>
          <ul>
            <li>
              <p>大批量数据加载使用步骤</p>
              <figure class="highlight properties">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment"># 客户端连接服务端时,<hanla></hanla>加上参数 --local-infile</span></span><br><span class="line"><span class="attr">mysql</span> <span class="string">--local-infile -u root -p</span></span><br><span class="line"><span class="comment"># 设置全局参数 local_infile = 1，开启从本地加载文件导入数据的开关<hanla></hanla></span></span><br><span class="line"><span class="attr">set</span> <span class="string">global local_infile = 1;</span></span><br><span class="line"><span class="comment"># 执行 load 指令将准备好的数据，加载到表结构中<hanla></hanla></span></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line">load data <span class="keyword">local</span> infile <span class="string">'文件路径'</span> <span class="keyword">into</span> <span class="keyword">table</span> <span class="string">'数据表'</span> fields terminated <span class="keyword">by</span> <span class="string">','</span> lines terminated <span class="keyword">by</span> <span class="string">'\n'</span>;</span><br><span class="line"># Eg</span><br><span class="line">load data <span class="keyword">local</span> infile <span class="string">'/root/sqlScript/load_user_100w_sort.sql'</span> <span class="keyword">into</span> <span class="keyword">table</span> tb_user fields terminated <span class="keyword">by</span> <span class="string">','</span> lines terminated <span class="keyword">by</span> <span class="string">'\n'</span>;</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <table>
                <thead>
                  <tr>
                    <th align="center">数据脚本模型</th>
                    <th align="center">待插入表结构</th>
                    <th align="center">执行单一插入操作，百万条数据耗时大约半小时</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/3d92fa0ced264ac58d7aa6d72a0b4803.png"></td>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/b588a7ddc1ea4bbcba4b4d7435085138.png"></td>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/4a9fe1cdac484626ac1684122f708a9e.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
          </ul>
          <ol start="2">
            <li>关闭唯一索引校验</li>
          </ol>
          <figure class="highlight sql">
            <table>
              <tbody>
                <tr>
                  <td class="gutter">
                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                  </td>
                  <td class="code">
                    <pre><span class="line"># 导入前<hanla></hanla></span><br><span class="line"><span class="keyword">set</span> unique_checks <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"># 执行导入结束后<hanla></hanla></span><br><span class="line"><span class="keyword">set</span> unique_checks <span class="operator">=</span> <span class="number">1</span>;</span><br></pre>
                  </td>
                </tr>
              </tbody>
            </table>
          </figure>
          <ol start="3">
            <li>
              <p>手动提交事务</p>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"># 导入数据前<hanla></hanla></span><br><span class="line"><span class="keyword">set</span> autocommit <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"># 导入数据结束后<hanla></hanla></span><br><span class="line"><span class="keyword">set</span> autocommit <span class="operator">=</span> <span class="number">1</span>;</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
          </ol>
          <h4 id="优化-Insert-语句"><a href="#优化-Insert-语句" class="headerlink" title="优化 Insert 语句"></a>优化 Insert 语句</h4>
          <ul>
            <li>
              <p>如果需要同时对一张表插入很多数据，应该尽量使用多个值表的<hanla></hanla><code>insert</code>
                <hanla></hanla>语句，这种方式可以大大的所见客户端与数据库之间的连接，关闭等消耗
              </p>
              <ul>
                <li>
                  <p>原始方式</p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'test01'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'test02'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">'test03'</span>);</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>优化后</p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'test01'</span>),(<span class="number">2</span>,<span class="string">'test02'</span>),(<span class="number">3</span>,<span class="string">'test03'</span>);</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ul>
            </li>
            <li>
              <p>手动提交事务</p>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">start</span> transition;</span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'test01'</span>);</span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'test02'</span>);</span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">'test03'</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>数据有序插入</p>
              <ul>
                <li>
                  <p>原始</p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">'test03'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">4</span>,<span class="string">'test04'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'test01'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'test02'</span>);</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>优化后</p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'test01'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'test02'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">'test03'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_test <span class="keyword">values</span>(<span class="number">4</span>,<span class="string">'test04'</span>);</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ul>
            </li>
          </ul>
          <h4 id="主键优化"><a href="#主键优化" class="headerlink" title="主键优化"></a>主键优化</h4>
          <ul>
            <li>
              <p>数据组织方式</p>
              <blockquote>
                <p>在 <code>InnoDB</code>
                  <hanla></hanla>存储引擎中，表数据都是根据主键顺序组织存放的，这种存储方式的表称为<code>索引组织表<hanla></hanla>(index organzied table IOT)</code>
                </p>
              </blockquote>
            </li>
            <li>
              <p>逻辑结构</p>
              <table>
                <thead>
                  <tr>
                    <th align="center">逻辑存储结构</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/9336435bc8834ae5b10f303e3e174950.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p>页分裂</p>
              <blockquote>
                <p>页可以为空，也可以填充一般，也可以填充<hanla></hanla><code>100%</code>，每个页包含了<hanla></hanla><code>2-N</code>
                  <hanla></hanla>行数据<hanla></hanla>(如果一个数据较大，会行溢出),<hanla></hanla>根据主键排列
                </p>
              </blockquote>
              <ul>
                <li>
                  <p>主键顺序插入</p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">主键顺序插入，当一页存满后，申请下一页</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/9df67b8e2abd44439f4fd0b4c1b27d5a.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p>主键乱序插入</p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">乱序</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/b27c489970bf4de1b7265e15f182506a.png"></td>
                      </tr>
                    </tbody>
                  </table>
                  <blockquote>
                    <p>当存储<hanla></hanla><code>50</code>
                      <hanla></hanla>这个元素时，不会直接插入在第三页中,<hanla></hanla>而是在第一页的<hanla></hanla><code>50%</code>
                      <hanla></hanla>处，在第一页超出<hanla></hanla><code>50%</code>
                      <hanla></hanla>的元素移动到第三页中,<hanla></hanla>再将<hanla></hanla><code>50</code>
                      <hanla></hanla>这个元素插入，重新设置链表，排列成顺序链表，此时，<code>导致页分裂</code>
                    </p>
                  </blockquote>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">页分裂</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/916f3a91c4f74cd497cd9eb1007e71f9.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
              </ul>
            </li>
            <li>
              <p>页合并</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>当删除一行记录时,<hanla></hanla>实际上记录并没有被物理删除,<hanla></hanla>只是记录被标记<hanla></hanla>(<code>flaged</code>)<hanla></hanla>为删除并且他的空间变得允许被其他记录声明使用</p>
                <table>
                  <thead>
                    <tr>
                      <th align="center">删除<hanla></hanla><code>13-16,<hanla></hanla>实则被标记</code></th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/0cc255e1bd1e49a284f26ddf7cc1648b.png"></td>
                    </tr>
                  </tbody>
                </table>
                <p>当页中删除的记录达到<hanla></hanla><code>MERGE_THRESHOLD(默认为页的<hanla></hanla>50%)</code>，<code>InnoDB</code>
                  <hanla></hanla>会开始寻找最靠近的页<hanla></hanla>(前或后)<hanla></hanla>看看时候可以将两个页合并以优化空间使用
                </p>
                <table>
                  <thead>
                    <tr>
                      <th align="center">页合并</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/5f2e287aa03742ac8dbd17dfee2d516e.png"></td>
                    </tr>
                  </tbody>
                </table>
                <blockquote>
                  <p>在标记的页中，在<hanla></hanla><code>50%</code>
                    <hanla></hanla>处，开始寻找前后靠近的页，在第一页中不满足和并要求，而在下一页中满足合并，那么将该页中的数据移动到标记处，在将新插入的元素放入空闲页中，完成页合并
                  </p>
                  <p><code>MERGE_THRESHOLD</code>: 合并页的阈值，可以自己设置，在创建表或者创建索引时指定。</p>
                </blockquote>
              </div>
            </li>
            <li>
              <p>主键设计原则</p>
              <ul>
                <li>
                  <p>满足业务需求的情况下，尽量降低主键的长度</p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">因为二级索引叶子节点挂的是<hanla></hanla><code>id</code>,<hanla></hanla>越长越耗费存储空间</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/689c938062f348da8db33cf140183090.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p>插入数据时，尽量选择顺序插入，选择使用<hanla></hanla><code>AUTO_INCREMENT</code>
                    <hanla></hanla>自增主键
                  </p>
                </li>
                <li>
                  <p>尽量不要使用<hanla></hanla><code>UUID</code>
                    <hanla></hanla>做主键或者其他自然主键，如<code>身份证</code>
                  </p>
                </li>
                <li>
                  <p>业务操作时，避免对主键的修改</p>
                </li>
              </ul>
            </li>
          </ul>
          <h4 id="优化-order-by语句"><a href="#优化-order-by语句" class="headerlink" title="优化 order by语句"></a>优化 order by<hanla></hanla>语句</h4>
          <ul>
            <li>
              <p><code>Using filesort</code>: 通过表的索引或全表扫描，读取满足条件的数据行，然后再排序缓冲区<hanla></hanla><code>sort buffer</code>
                <hanla></hanla>中完成排序操作，所有不是通过索引直接排序结果的排序都叫<hanla></hanla><code>FileSort</code>
                <hanla></hanla>排序
              </p>
            </li>
            <li>
              <p><code>Using index</code>: 通过有序索引顺序扫描直接返回有序数据，这种情况叫<hanla></hanla><code>using index</code>，不需要额外排序，操作效率高</p>
            </li>
            <li>
              <p>优化</p>
              <ul>
                <li>
                  <p>根据排序字段建立合适的索引，多字段排序时，也遵循最左前缀法则</p>
                </li>
                <li>
                  <p>尽量使用覆盖索引<hanla></hanla>(字段)</p>
                </li>
                <li>
                  <p>多字段排序，一个升序一个降序，此时需要注意联合索引在创建时的规则<hanla></hanla>(<code>ASC/DESC</code>)</p>
                </li>
                <li>
                  <p>如果不可避免的出现<hanla></hanla><code>filesort</code>,<hanla></hanla>大数据量排序时，可以适当增大排序缓冲区大小<hanla></hanla><code>sort_buffer_size(默认: 256k)</code></p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">-- 查看默认的排序缓冲区大小<hanla></hanla></span></span><br><span class="line"><span class="keyword">show</span>  variables <span class="keyword">like</span> <span class="string">'sort_buffer_size'</span>;</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ul>
            </li>
          </ul>
          <h4 id="优化-group-by-语句"><a href="#优化-group-by-语句" class="headerlink" title="优化 group by 语句"></a>优化 group by 语句</h4>
          <ul>
            <li>
              <p>如果查询包含<hanla></hanla><code>group by</code> 但是用户想要避免排序结果的消耗，则可执行<hanla></hanla><code>order by</code>
                <hanla></hanla>禁止排序
              </p>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="keyword">select</span>  xxx <span class="keyword">from</span> xxx <span class="keyword">group</span> <span class="keyword">by</span> xxx;</span><br><span class="line">优化后<hanla></hanla></span><br><span class="line"><span class="keyword">select</span>  xxx <span class="keyword">from</span> xxx <span class="keyword">group</span> <span class="keyword">by</span> xxx <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">null</span>;</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
            <li>
              <p>在分组操作时，可以通过索引来提高效率</p>
            </li>
            <li>
              <p>分组操作时，索引的使用也是满足最左前缀法则的</p>
            </li>
          </ul>
          <h4 id="分页查询的优化"><a href="#分页查询的优化" class="headerlink" title="分页查询的优化"></a>分页查询的优化</h4>
          <ul>
            <li>
              <p>一般分页查询时，通过创建覆盖索引能够比较好的提高性能。一个常见又非常头疼的问题就是<hanla></hanla><code>limit 2000000,10</code>
                <hanla></hanla>此时就需要<hanla></hanla><code>MYSQL</code>
                <hanla></hanla>排序前<hanla></hanla><code>200000010</code>
                <hanla></hanla>记录，仅仅返回<hanla></hanla><code>2000000-200000010</code>
                <hanla></hanla>的记录，其他丢弃记录，查询排序的代价非常大
              </p>
            </li>
            <li>
              <p>优化思路一:</p>
              <ul>
                <li>
                  <p>在索引上完成排序分页操作，最后根据主键关联回原表查需所需要的其他列内容</p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">select</span>  <span class="operator">*</span> <span class="keyword">from</span> tb_test,(<span class="keyword">select</span> xxx <span class="keyword">from</span> xxx <span class="keyword">order</span> <span class="keyword">by</span> xxx limit  <span class="number">2000000</span>,<span class="number">10</span>) a <span class="keyword">where</span> xxx <span class="operator">=</span> xxx;</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ul>
            </li>
            <li>
              <p>优化思路二</p>
              <ul>
                <li>
                  <p>该方案适用于<code>主键自增的表</code>，可以把<hanla></hanla><code>limit</code>
                    <hanla></hanla>查询转换成某个位置的查询
                  </p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> xxx <span class="keyword">where</span> xx <span class="operator">&gt;</span> xxx limit <span class="number">10</span>;</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ul>
            </li>
          </ul>
          <h4 id="count-优化"><a href="#count-优化" class="headerlink" title="count 优化"></a>count 优化</h4>
          <ul>
            <li><code>count(主键)</code>: <code>InnoDB</code>
              <hanla></hanla>引擎会遍历整张表，把每一行的主键<hanla></hanla><code>id</code>
              <hanla></hanla>值都取出来，返回给服务层。服务层拿到逐渐后，直接按行进行累加<hanla></hanla>(主键不可能为<hanla></hanla><code>NULL</code>)
            </li>
            <li><code>count(字段)</code>
              <ul>
                <li>没有<hanla></hanla><code>not null</code>
                  <hanla></hanla>约束： <code>InnoDB</code>
                  <hanla></hanla>引擎会遍历整张表把每一行的字段值都取出来，返回给服务层，服务层判断是否为<hanla></hanla><code>null</code>,<hanla></hanla>不为<hanla></hanla><code>null</code>，计数累加。
                </li>
                <li><code>有 not null</code>
                  <hanla></hanla>约束: <code>InnoDB</code>
                  <hanla></hanla>引擎会遍历整张表把每一行的字段值都取出来，返回给服务层，直接按行进行累加。
                </li>
              </ul>
            </li>
            <li><code>count(*)</code>: <code>InnoDB</code>
              <hanla></hanla>引擎并不会把全部字段取出来，而是专门做了优化，不取值，服务层直接按行进行累加。
            </li>
          </ul>
          <blockquote>
            <p>按照效率排序的话<hanla></hanla><code>count(字段)<count(主键<hanla>id)</count(主键<hanla></code>,<hanla></hanla>所以尽量使用<hanla></hanla><code>count(*)</code></p>
          </blockquote>
          <table>
            <thead>
              <tr>
                <th align="center">count</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/fa485acadb574288ba455e781f655962.png"></td>
              </tr>
            </tbody>
          </table>
          <h4 id="update-优化"><a href="#update-优化" class="headerlink" title="update 优化"></a>update 优化</h4>
          <ul>
            <li>
              <p>优化</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p><code>InnoDB</code>
                  <hanla></hanla>的行锁是针对索引加的锁，不是针对记录加的锁，并且该索引不能失效，否则会从行锁升级为表锁。
                </p>
              </div>
            </li>
          </ul>
          <h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3>
          <ul>
            <li>视图是一种虚拟存在的表。视图中的数据并不在数据库中实际存在，行和列数据来自定义视图查询中使用的表，并且是在使用视图时动态生成的</li>
            <li>通俗的讲，视图只保存了查询的<hanla></hanla><code>SQL</code>
              <hanla></hanla>逻辑，不保存查询的结果。所以我们在创建视图的时候，主要的工作就落在创建这条<hanla></hanla><code>SQL</code>
              <hanla></hanla>查询语句上
            </li>
          </ul>
          <h3 id="锁"><a href="#锁" class="headerlink" title="锁"></a>锁</h3>
          <ul>
            <li>
              <p>是什么？</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>锁是计算机协调多个进程或线程并发访问某一资源的机制，在数据库中，除传统的计算机资源的争用外，数据也是一种供许多用户共享的资源。如何保证数据并发访问的一致性、有效性是所有数据库必须解决的一个问题，锁冲突也是影响数据库并发访问性能的一个重要因素。</p>
              </div>
            </li>
            <li>
              <p>分类： <code>MYSQL</code>
                <hanla></hanla>中的锁，按照粒度分，分为以下三类
              </p>
              <ul>
                <li>
                  <p>全局锁: 锁定数据库中的所有表</p>
                  <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                    <p>全局锁就是对整个数据库实例加锁，加锁后整个实例就处于只读状态，后续的<hanla></hanla><code>DML</code>
                      <hanla></hanla>的写语句，<code>DDL</code>
                      <hanla></hanla>语句，以及更新操作的事务提交语句都将被阻塞
                    </p>
                    <p>其典型的使用场景是做全库的逻辑备份，对素有的表进行锁定，从而获取一致性视图，保证数据的完整性。</p>
                    <table>
                      <thead>
                        <tr>
                          <th align="center">未加锁的备份</th>
                          <th align="center">加锁后</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/0c520fbb029a41aaa69df1ca267da043.png"></td>
                          <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/5aa25b693203433c99f8d8d6de462033.png"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">锁的添加与释放</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/abd541e03a2342759b4c35533f01ed11.png"></td>
                      </tr>
                    </tbody>
                  </table>
                  <ul>
                    <li>
                      <p>特点</p>
                      <ol>
                        <li>如果在主库上备份，那么在备份期间都不能执行更新操作，业务基本上就是停滞</li>
                        <li>如果在从库上备份，那么在备份期间从库不能执行主库同步过来的二进制日志<hanla></hanla><code>binlog</code>，会导致主从延迟</li>
                      </ol>
                      <blockquote>
                        <p>在<hanla></hanla><code>InnoDB</code>
                          <hanla></hanla>引擎中，我们可以在备份时加上参数<code>--single-transaction</code>
                          <hanla></hanla>参数来完成不加锁的一致性数据备份
                        </p>
                      </blockquote>
                      <figure class="highlight properties">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="attr">mysqldump</span> <span class="string">--single-transaction -uroot -proot coderitl&gt;D:/coderitl.sql</span></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                  </ul>
                </li>
                <li>
                  <p>表级锁: 每次操作锁住整张表</p>
                  <blockquote>
                    <p>表级锁: 每次操作锁住整张表。锁定粒度大，发生锁冲突的概率最高,<hanla></hanla>并发度最低。应用在<hanla></hanla><code>MyISAM,InnoDB,BOB</code>
                      <hanla></hanla>等存储引擎中
                    </p>
                  </blockquote>
                  <ul>
                    <li>
                      <p>表级锁分类</p>
                      <ol>
                        <li>
                          <p>表锁</p>
                          <ul>
                            <li>
                              <p>表共享读锁</p>
                              <table>
                                <thead>
                                  <tr>
                                    <th align="center">会阻塞其他客户端的<hanla></hanla><code>DDL/DML</code>
                                      <hanla></hanla>操作,<hanla></hanla>不会影响<hanla></hanla><code>DQL（读）</code>
                                    </th>
                                    <th align="center">阻塞</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/f5d7582a213942528b93423003f59b90.png"></td>
                                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/b0a930c1a2414250aab30765c82c1382.png"></td>
                                  </tr>
                                </tbody>
                              </table>
                            </li>
                            <li>
                              <p>表独占写锁</p>
                              <table>
                                <thead>
                                  <tr>
                                    <th align="center">加写锁后，仅允许自己的客户端执行写<hanla></hanla>(独占写),<hanla></hanla>阻塞其他客户端的读写</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/9c5176dcb7584800956287dcc57cfbe1.png"></td>
                                  </tr>
                                </tbody>
                              </table>
                            </li>
                            <li>
                              <p>语法</p>
                              <ul>
                                <li>加锁: <code>lock table 表名 read/write</code></li>
                                <li>释放锁: <code>unlock tables / 客户端断开连接</code></li>
                              </ul>
                              <figure class="highlight sql">
                                <table>
                                  <tbody>
                                    <tr>
                                      <td class="gutter">
                                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                                      </td>
                                      <td class="code">
                                        <pre><span class="line"><span class="comment">-- 加锁<hanla></hanla></span></span><br><span class="line">lock <span class="keyword">table</span> course read;</span><br><span class="line"><span class="comment">-- 释放锁<hanla></hanla></span></span><br><span class="line">unlock tables;</span><br></pre>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </figure>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p>元数据锁</p>
                          <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                            <p><code>MDL(元数据锁简称)</code>
                              <hanla></hanla>加锁过程是系统和自动控制，无需显示使用，在访问一张表的时候会自动加上。<code>MDL</code>
                              <hanla></hanla>锁主要作用是维护表元数据的数据一致性，在表上有活动事务的时候，不可以对元数据进行写入操作。
                            </p>
                          </div>
                          <blockquote>
                            <p>对一张表进行增删改查的时候,<hanla></hanla>加<hanla></hanla><code>MDL</code>
                              <hanla></hanla>读锁<hanla></hanla>(共享);当对表结构进行变更操作的时候，加<hanla></hanla><code>MDL</code>
                              <hanla></hanla>写锁<hanla></hanla>(排他锁)
                            </p>
                          </blockquote>
                          <table>
                            <thead>
                              <tr>
                                <th align="center">元数据锁</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/ad5deb3d69d74a058c198f3078311595.png"></td>
                              </tr>
                            </tbody>
                          </table>
                        </li>
                        <li>
                          <p>意向锁</p>
                          <table>
                            <thead>
                              <tr>
                                <th align="center">引出： 行锁与表锁的冲突</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/c1dad4233a8843929d698570bef9b79d.png"></td>
                              </tr>
                            </tbody>
                          </table>
                          <ol>
                            <li>意向共享锁: 与表锁共享锁<hanla></hanla>(<code>read</code>)<hanla></hanla>兼容,<hanla></hanla>与表锁排他锁互斥</li>
                            <li>意向排他锁: 与表锁共享锁<hanla></hanla>(<code>read</code>)<hanla></hanla>及排他锁<hanla></hanla>(<code>write</code>)<hanla></hanla>都互斥。意向锁之间不会互斥。</li>
                          </ol>
                        </li>
                      </ol>
                    </li>
                  </ul>
                </li>
                <li>
                  <p>行级锁: 每次操作锁住对应的行数据</p>
                  <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                    <p>行级锁: 每次操作锁住对应的行数据。锁定粒度最小，发生锁冲突的概率最低，并发度最高。应用在<hanla></hanla><code>InnoDB</code>
                      <hanla></hanla>存储引擎中。
                    </p>
                    <p><code>InnoDB</code>
                      <hanla></hanla>的数据是基于索引组织的，行锁是通过索引上的索引项加锁来实现的，而不是对记录加的锁。对于行级锁，主要分为以下三类:
                    </p>
                    <ol>
                      <li>
                        <p>行锁<hanla></hanla>(<code>Record Lock</code>): 锁定单个行记录的锁，防止其他事务对此进行<hanla></hanla><code>update</code>
                          <hanla></hanla>和<hanla></hanla><code>delete</code>.<hanla></hanla>在<hanla></hanla><code>RC,RP</code>
                          <hanla></hanla>隔离级别下都支持。
                        </p>
                        <table>
                          <thead>
                            <tr>
                              <th align="center">行锁: 锁定单个行记录的锁</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/c8e4d7eb52f34706b025a2d22d54d4df.png"></td>
                            </tr>
                          </tbody>
                        </table>
                      </li>
                      <li>
                        <p>间隙锁： 锁定索引记录间隙<hanla></hanla>(不含该记录),<hanla></hanla>确保索引记录间隙不变，防止其他事务在这个间隙进行<hanla></hanla><code>insert</code>，产生幻读。在<hanla></hanla><code>PR</code>
                          <hanla></hanla>隔离级别下都支持。
                        </p>
                        <table>
                          <thead>
                            <tr>
                              <th align="center">间隙锁</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/f3f7a252303544d7b93fe2a3720116f2.png" alt="在这里插入图片描述"></td>
                            </tr>
                          </tbody>
                        </table>
                      </li>
                      <li>
                        <p>临键锁: 行锁和间隙锁组合，同时锁住数据，并锁住数据前面的间隙<hanla></hanla><code>Gap</code>。在<hanla></hanla><code>RR</code>
                          <hanla></hanla>隔离级别下支持。
                        </p>
                      </li>
                    </ol>
                  </div>
                  <ul>
                    <li>
                      <p>行锁: <code>InnoDB</code>
                        <hanla></hanla>实现了以下两种类型的行锁
                      </p>
                      <ul>
                        <li>共享锁<hanla></hanla>(<code>S</code>): 允许一个事务去读一行，阻止其他事务获得相同数据集的排他锁</li>
                        <li>排他锁<hanla></hanla>(<code>X</code>): 允许获取排他锁的事务更新数据，阻止其他事务获得相同数据集的共享锁和排他锁</li>
                      </ul>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">行锁</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/593317c8986046399ee3c28717b4f8b8.png"></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
          <h3 id="事务原理"><a href="#事务原理" class="headerlink" title="事务原理"></a>事务原理</h3>
          <ul>
            <li>
              <p>事务</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>事务是一组操作的集合，它是一个不可分割的工作单位，事务会把<code>所有的操作作为一个整体</code>一起向系统提交或撤销操作请求,<hanla></hanla>即这些操作要么同时成功，要么同时失败。</p>
              </div>
            </li>
            <li>
              <p>特性</p>
              <ul>
                <li>原子性<hanla></hanla>(<code>Atomicity</code>): 事务是不可分割的做小操作单元，要么全部成功，要么全部失败</li>
                <li>一致性<hanla></hanla>(<code>Consistency</code>): 事务完成时，必须使所有的数据都保持一致状态</li>
                <li>隔离性<hanla></hanla>(<code>Isolation</code>): 数据库系统提供的隔离机制,<hanla></hanla>保证事务在不受外部并发操作影响的独立环境下运行</li>
                <li>持久性<hanla></hanla>(<code>Durability</code>): 事务一旦提交或回滚，它对数据库中的数据的改变就是永久的。</li>
              </ul>
            </li>
            <li>
              <p>原理</p>
              <table>
                <thead>
                  <tr>
                    <th align="center">分为两个方面</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/3412fea7e9464f32bec4269a8c98dc58.png"></td>
                  </tr>
                </tbody>
              </table>
              <ul>
                <li>
                  <p><code>redo log(重做日志)</code>：(保障持久性)</p>
                  <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                    <p>重做日志，记录的是事务提交时数据页的物理修改，是用来实现事务的持久性。</p>
                    <p>该日志文件由两部分组成: 重做日志缓冲<hanla></hanla>(<code>redo log buffer</code>)<hanla></hanla>以及重做日志文件<hanla></hanla>(<code>redo log file</code>)，前者是在内存中，后者是在磁盘中。当事务提交之后会把所有的修改信息都存到该日志文件中，用于在刷新脏页到磁盘，发生错误时，进行数据恢复使用。</p>
                    <table>
                      <thead>
                        <tr>
                          <th align="center">脏页产生</th>
                          <th align="center">出现<hanla></hanla><code>redo log</code></th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/9d3c25c6dcd34f60b4cd4760c818f6fe.png"></td>
                          <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/e02ace301e174814918a3fdd57194b72.png"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </li>
              </ul>
            </li>
            <li>
              <p><code>undo log</code></p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>回滚日志，用于记录数据被修改前的信息，作用包含两个: <code>提供回滚</code>和<hanla></hanla><code>MVCC(多版本并发控制)</code></p>
                <p><code>undo log</code>
                  <hanla></hanla>和<hanla></hanla><code>redo log</code>
                  <hanla></hanla>记录物理日志不一样，它是逻辑日志，可以认为当<hanla></hanla><code>delete</code>
                  <hanla></hanla>一条记录时，<code>undo log</code>
                  <hanla></hanla>中会记录一条对应的<hanla></hanla><code>insert</code>
                  <hanla></hanla>记录，反之亦然，当<hanla></hanla><code>update</code>
                  <hanla></hanla>一条记录时，它记录一条对应相反的<hanla></hanla><code>update</code>
                  <hanla></hanla>记录。当执行<hanla></hanla><code>rollback</code>
                  <hanla></hanla>时，就可以从<hanla></hanla><code>undo log</code>
                  <hanla></hanla>中的逻辑记录读取到响应的内容并进行回滚
                </p>
                <p><code>undo log</code>
                  <hanla></hanla>销毁: <code>undo log</code>
                  <hanla></hanla>在事务执行时产生，事务提交时,<hanla></hanla>并不会立即删除<hanla></hanla><code>undo log</code>，因为这些日志可能还用于<hanla></hanla><code>MVCC</code>
                </p>
                <p><code>undo log</code>
                  <hanla></hanla>存储: <code>undo log</code>
                  <hanla></hanla>采用段的方式进行管理和记录，存放在前面介绍的<hanla></hanla><code>rollback segement</code>
                  <hanla></hanla>回滚段中，内部还包含<hanla></hanla><code>1024</code>
                  <hanla></hanla>个<hanla></hanla><code>undo log segement</code>
                </p>
              </div>
            </li>
            <li>
              <p><code>MVCC</code>-基本概念</p>
              <ul>
                <li>
                  <p>当前读</p>
                  <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                    <p>读取的时记录的最新版本，读取时还要保证其他并发事务不能修改当前记录，会对读取的记录进行加锁。对于我们日常的操作，如<hanla></hanla><code>select .... lock in share mode(共享锁),select ... for update,update,insert,delete(排他锁)<hanla></hanla>都是一种当前读</code></p>
                  </div>
                </li>
                <li>
                  <p>快照读</p>
                  <blockquote>
                    <p>简单的<hanla></hanla><code>select(不加锁)</code> 就是快照读，快照读，读取的是记录数据的可见版本，有可能是历史数据，不加锁，是非阻塞读。</p>
                  </blockquote>
                  <ul>
                    <li><code>Read Committed</code>: 每次<hanla></hanla><code>select</code>，都生成一个快照读</li>
                    <li><code>Repeatable Read</code>: 开启事务后第一个<hanla></hanla><code>select</code>
                      <hanla></hanla>语句才是快照读的地方
                    </li>
                    <li><code>Serializable</code>: 快照读退化为当前读</li>
                  </ul>
                </li>
                <li>
                  <p><code>MVCC</code></p>
                  <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                    <p>全称<hanla></hanla>(<code>Multi-Version Concurrency Control</code>),<hanla></hanla>多版本并发控制。指维护一个数据的多个版本，使得读写操作没有冲突，快照读为<hanla></hanla><code>MYSQL</code>
                      <hanla></hanla>实现<hanla></hanla><code>MVCC</code>
                      <hanla></hanla>提供了一个非阻塞读功能。<code>MVCC</code>
                      <hanla></hanla>的具体实现，还需要依赖于数据库记录中的三个隐式字段、<code>undo log</code>
                      <hanla></hanla>日志，<code>readView</code>
                    </p>
                  </div>
                  <ul>
                    <li>
                      <p>记录中的隐藏字段</p>
                      <table>
                        <thead>
                          <tr>
                            <th>隐藏字段</th>
                            <th>含义</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td><code>DB_TRX_ID</code></td>
                            <td>最近修改事务<hanla></hanla><code>ID</code>，记录插入这条记录或最后一次修改记录的事务<hanla></hanla><code>ID</code></td>
                          </tr>
                          <tr>
                            <td><code>DB_ROLL_PTR</code></td>
                            <td>回滚日志，指向这条记录的上一个版本，用于配合<hanla></hanla><code>undo log</code>,<hanla></hanla>指向上一个版本</td>
                          </tr>
                          <tr>
                            <td><code>DB_ROW_ID</code></td>
                            <td>隐藏主键，如果表机构没有指定主键，将会生成该隐藏字段</td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
          <h3 id="系统数据库"><a href="#系统数据库" class="headerlink" title="系统数据库"></a>系统数据库</h3>
          <ul>
            <li>
              <p>数据库</p>
              <table>
                <thead>
                  <tr>
                    <th>数据库</th>
                    <th>含义</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><code>mysql</code></td>
                    <td>存储<hanla></hanla><code>MYSQL</code>
                      <hanla></hanla>服务器正常运行所需要的各种信息<hanla></hanla>(时区、主从、用户、权限等·)
                    </td>
                  </tr>
                  <tr>
                    <td><code>infomation_schema</code></td>
                    <td>提供了访问数据库元数据的各种表和视图，包含数据库、表、字段类型及访问权限等</td>
                  </tr>
                  <tr>
                    <td><code>perfromance_schema</code></td>
                    <td>为<hanla></hanla><code>MYSQL</code>
                      <hanla></hanla>服务器运行时状态提供了一个底层监控功能，主要用于收集数据库服务器性能参数
                    </td>
                  </tr>
                  <tr>
                    <td><code>sys</code></td>
                    <td>包含了一系列方便<hanla></hanla><code>DBA</code>
                      <hanla></hanla>和开发人员利用<hanla></hanla><code>preformance_sechma</code>
                      <hanla></hanla>性能数据库进行性能调优和诊断的视图
                    </td>
                  </tr>
                </tbody>
              </table>
            </li>
          </ul>
          <h3 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h3>
          <ul>
            <li>
              <p>错误日志</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>错误日志是<hanla></hanla><code>MYSQL</code>
                  <hanla></hanla>中最重要的日志之一，它记录了当<hanla></hanla><code>mysqld</code>
                  <hanla></hanla>启动和停止时，以及服务器在运行过程中发生任何严重错误时的相关信息。当数据库出现任何故障导致无法正常使用时，建议首先查看此日志。
                </p>
                <p>该日志默认是开启的，默认存放目录<hanla></hanla><code>/var/log</code>，默认的日志文件名<hanla></hanla><code>mysqld.log</code>。查看日志位置</p>
                <figure class="highlight sql">
                  <table>
                    <tbody>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">'%log_error%'</span>;</span><br></pre>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </figure>
              </div>
            </li>
            <li>
              <p>二进制日志</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>二进制日志<hanla></hanla>(<code>binlog</code>)<hanla></hanla>记录了所有的<hanla></hanla><code>DDL(数据定义语言)</code>
                  <hanla></hanla>语句和<hanla></hanla><code>DML(数据操纵语言)</code>
                  <hanla></hanla>语句，但不包括数据查询<hanla></hanla>(<code>select,show</code>)<hanla></hanla>语句
                </p>
              </div>
              <ul>
                <li>
                  <p>作用</p>
                  <ol>
                    <li>灾难时的数据恢复</li>
                    <li><code>MYSQL</code>
                      <hanla></hanla>的主从复制。在<hanla></hanla><code>MYSQL8</code>
                      <hanla></hanla>版本中，默认二进制日志是开启的，涉及到参数如下:
                    </li>
                  </ol>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">-- 查看位置<hanla></hanla></span></span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">'%log_bin%'</span>;</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>格式</p>
                  <table>
                    <thead>
                      <tr>
                        <th>日志格式</th>
                        <th>含义</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><code>statement</code></td>
                        <td>基于<hanla></hanla><code>SQL</code>
                          <hanla></hanla>语句的日志记录，记录的是<hanla></hanla><code>SQL</code>
                          <hanla></hanla>语句，对数据进行修改的<hanla></hanla><code>SQL</code>
                          <hanla></hanla>都会记录在日志文件中
                        </td>
                      </tr>
                      <tr>
                        <td><code>row</code></td>
                        <td>基于行的日志记录，记录的是每一行的数据变更<hanla></hanla>(<code>默认</code>)</td>
                      </tr>
                      <tr>
                        <td><code>mixed</code></td>
                        <td>混合了<hanla></hanla><code>statement</code>
                          <hanla></hanla>和<hanla></hanla><code>row</code>
                          <hanla></hanla>两种格式，默认采用<hanla></hanla><code>statement</code>，在某些特殊情况下会自动转换为<hanla></hanla><code>row</code>
                          <hanla></hanla>进行记录
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">-- 查看默认的日志格式<hanla></hanla></span></span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">'%binlog_format%'</span>;</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>日志查看</p>
                  <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                    <p>由于日志是以二进制方式存储，不能直接读取，需要通过以二进制日志查询工具<hanla></hanla><code>mysqlbinlog</code>
                      <hanla></hanla>来查看,<hanla></hanla>具体语法如下:
                    </p>
                  </div>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line">mysqlbinlog [参数选项] logfilename</span><br><span class="line"></span><br><span class="line"><hanla></hanla>参数选项:</span><br><span class="line">	<span class="operator">-</span>d: 指定数据库名称，只列出指定的数据库相关操作</span><br><span class="line">	<span class="operator">-</span>o: 忽略掉日志中的前 n 行命令</span><br><span class="line">	<span class="operator">-</span>v: 将行<hanla></hanla>(行<hanla></hanla>(<span class="type">row</span>))<hanla></hanla>事件<hanla></hanla>(数据变更) 重构为 <span class="keyword">SQL</span> 语句</span><br><span class="line">	<span class="operator">-</span>w: 将 行事件 (数据变更) 重构为 <span class="keyword">SQL</span> 语句,<hanla></hanla>并输出注释信息</span><br><span class="line">	</span><br><span class="line"># 查看<hanla></hanla></span><br><span class="line">mysqlbinlog <span class="operator">-</span>v binlog<span class="number">.000001</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">此位置下的<hanla></hanla><code>binlog.00000x</code></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/72c575edeeaf4e62a15556741d24213f.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p>修改日志显示格式</p>
                  <figure class="highlight properties">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment"># 修改配置文件<hanla></hanla></span></span><br><span class="line"><span class="attr">vim</span> <span class="string">/etc/my.cnf</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 末尾添加 以 SQL 语句形式显示<hanla></hanla></span></span><br><span class="line"><span class="attr">binlog_format</span>=<span class="string">STATEMENT</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 重启服务<hanla></hanla></span></span><br><span class="line"><span class="attr">systemctl</span> <span class="string">restart mysqld</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>日志删除</p>
                  <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                    <p>对于比较繁忙的业务系统，每天生成的<hanla></hanla><code>binlog</code>
                      <hanla></hanla>数据巨大，如果长时间不清除，将会占用打量磁盘空间。可以通过以下几种方式清理日志:
                    </p>
                    <table>
                      <thead>
                        <tr>
                          <th>指令</th>
                          <th>含义</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td><code>reset master</code></td>
                          <td>删除全部<hanla></hanla><code>binlog</code>
                            <hanla></hanla>日子，删除之后，日志编号，将从<hanla></hanla><code>binlog.000001</code>
                            <hanla></hanla>重新开始
                          </td>
                        </tr>
                        <tr>
                          <td><code>purge master logs to 'binglog.******'</code></td>
                          <td>删除<hanla></hanla><code>******</code>
                            <hanla></hanla>编号之前的所有日志
                          </td>
                        </tr>
                        <tr>
                          <td><code>purge master logs before 'yyy-mm-dd hh24:mi:ss'</code></td>
                          <td>删除日志为<hanla></hanla><code>yyyy-mm-dd hh24:mi:ss</code>
                            <hanla></hanla>之前产生的所有日志
                          </td>
                        </tr>
                      </tbody>
                    </table>
                    <p>
                      <font color="red"><strong>也可以在 mysql 的配置文件中配置二进制日志的过期时间，设置了之后，二进制日志过期会<code>自动</code>删除</strong></font>
                    </p>
                  </div>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"># 查看默认的过期时间（默认时间: <span class="number">30</span><hanla></hanla>天）</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">'%binlog_expire_logs_seconds%'</span>;</span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ul>
            </li>
            <li>
              <p>查询日志</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>查询日志记录了客户端的所有操作语句，而二进制日志不包含查询数据的<hanla></hanla><code>SQL</code>
                  <hanla></hanla>语句。默认情况下，查询日志是为开启的。如果需要开启查询日志，可以设置以下配置:
                </p>
              </div>
              <figure class="highlight sql">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment">-- 查看查询日志开启状态<hanla></hanla>(默认关闭)</span></span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">'%general%'</span>;</span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
              <ul>
                <li>
                  <p>开启</p>
                  <figure class="highlight sql">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"># 修改配置<hanla></hanla></span><br><span class="line">vim <span class="operator">/</span>etc<span class="operator">/</span>my.cnf</span><br><span class="line"></span><br><span class="line"># 该选项用来开启查询日志,<hanla></hanla>可选值: <span class="number">0</span> 或者 <span class="number">1</span>,<span class="number">0</span>: off,<span class="number">1</span>: <span class="keyword">on</span></span><br><span class="line">general_log<span class="operator">=</span><span class="number">1</span></span><br><span class="line"># 设置日志的文件名,<hanla></hanla>如果没有指定,<hanla></hanla>默认的文件名为 host_name.log</span><br><span class="line">general_log_file<span class="operator">=</span>mysql_query.log</span><br><span class="line"></span><br><span class="line"># 重启服务<hanla></hanla></span><br><span class="line">systemctl restart mysqld</span><br><span class="line"></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">开启前</th>
                        <th align="center">开启后</th>
                        <th align="center"><code>mysql_query.log</code>
                          <hanla></hanla>记录内容为<hanla></hanla><code>crud,ddl<hanla></hanla>操作</code>
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/594351f8372f4d3e83e5fb54e4d9a505.png"></td>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/af1375ee66be4e86bf63914e3d889861.png"></td>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/a64b4c3ba620413fb043bb5ac783871b.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
              </ul>
            </li>
            <li>
              <p>慢查询日志</p>
              <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                <p>慢查询日志记录了所有执行时间超过参数<hanla></hanla><code>long_query_time</code>
                  <hanla></hanla>设置值并且扫描记录数不小于<hanla></hanla><code>min_examined_row_limit</code>
                  <hanla></hanla>的所有的<hanla></hanla><code>SQL</code>
                  <hanla></hanla>语句的日志，默认未开启。<code>long_query_time</code>
                  <hanla></hanla>默认为<hanla></hanla><code>10s</code>，最小为<hanla></hanla><code>0</code>，精度可以到微妙
                </p>
                <figure class="highlight properties">
                  <table>
                    <tbody>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="comment"># 开启慢查询日志记录<hanla></hanla></span></span><br><span class="line"><span class="attr">slow_query_log</span>=<span class="string">1</span></span><br><span class="line"><span class="comment"># 超过<hanla></hanla>2s<hanla></hanla>视为慢查询<hanla></hanla></span></span><br><span class="line"><span class="attr">log_query_time</span>=<span class="string">2</span></span><br></pre>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </figure>
                <table>
                  <thead>
                    <tr>
                      <th align="center">查看慢查询是否被记录</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/48bfe2e2ac194be9b98bf7ee568793ae.png"></td>
                    </tr>
                  </tbody>
                </table>
                <p>默认情况下，不会记录管理语句，也不会记录不使用索引进行查找的查询。可以使用<hanla></hanla><code>log_slow_admin_statements</code>
                  <hanla></hanla>和更改此行为
                </p>
                <p><code>log_queries_noe_using_indexes</code></p>
              </div>
              <figure class="highlight properties">
                <table>
                  <tbody>
                    <tr>
                      <td class="gutter">
                        <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                      </td>
                      <td class="code">
                        <pre><span class="line"><span class="comment"># 记录执行比较慢的管理语句<hanla></hanla>(修改 my.cnf)</span></span><br><span class="line"><span class="attr">log_slow_admin_statements</span>=<span class="string">1</span></span><br><span class="line"><span class="comment"># 记录执行较慢的未使用索引的语句<hanla></hanla></span></span><br><span class="line"><span class="attr">log_queries_not_using_indexes</span>=<span class="string">1</span></span><br></pre>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </figure>
            </li>
          </ul>
          <h3 id="主从复制"><a href="#主从复制" class="headerlink" title="主从复制"></a>主从复制</h3>
          <ul>
            <li>
              <p>概述</p>
              <div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i>
                <p>主从复制是指将主句库的<hanla></hanla><code>DDL</code>
                  <hanla></hanla>和<hanla></hanla><code>DML</code>
                  <hanla></hanla>操作通过二进制日志传到从库服务器中，然后在从库上对这些日志重新执行<hanla></hanla>(也叫重做),<hanla></hanla>从而使得从库和主库的数据保持同步
                </p>
                <p><code>MYSQL</code>
                  <hanla></hanla>支持一台主库同时向多台从库进行复制，从库同时也可以作为其他从服务器的主库，实现链状复制。
                </p>
              </div>
            </li>
            <li>
              <p>主从复制的好处</p>
              <ol>
                <li>主库<hanla></hanla>(<code>主库: master</code>)<hanla></hanla>出现问题，可以快速切换到从库提供服务</li>
                <li>实现读写分离，降低主库的访问压力</li>
                <li>可以在从库<hanla></hanla>(<code>从库: Slave</code>)<hanla></hanla>中执行备份，以避免备份期间影响到主库服务</li>
              </ol>
            </li>
            <li>
              <p>主从复制的原理</p>
              <table>
                <thead>
                  <tr>
                    <th align="center">主从复制的原理</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/b035377c7d3044caa7cefc5d269721c0.png"></td>
                  </tr>
                </tbody>
              </table>
              <div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i>
                <p>从上图看，复制分成三步:</p>
                <ol>
                  <li><code>Master</code>
                    <hanla></hanla>主库在事务提交时，会把数据变更记录在二进制日志文件<hanla></hanla><code>Binlog</code>
                    <hanla></hanla>中
                  </li>
                  <li>从库读取主库的二进制文件<hanla></hanla><code>Binlog</code>，写入到从库的中继日志<hanla></hanla><code>Relay Log</code></li>
                  <li><code>Slave</code>
                    <hanla></hanla>重做中继日志中的事件，将改变反映给它自己的数据
                  </li>
                </ol>
              </div>
            </li>
            <li>
              <p>搭建</p>
              <ul>
                <li>
                  <p>服务器准备</p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">安装<hanla></hanla><code>MYSQL80</code></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/1bac749655b749bb87a00c07ecec3845.png"></td>
                      </tr>
                    </tbody>
                  </table>
                  <figure class="highlight properties">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment"># 开放指定的 3306 端口<hanla></hanla></span></span><br><span class="line"><span class="attr">firewall-cmd</span> <span class="string">--zone=public --add-port=3306/tcp -permanent</span></span><br><span class="line"><span class="attr">firewall-cmd</span> <span class="string">-reload</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 关闭服务器的防火墙<hanla></hanla></span></span><br><span class="line"><span class="attr">systemctl</span> <span class="string">stop firewalld</span></span><br><span class="line"><span class="attr">systemctl</span> <span class="string">disable firewalld</span></span><br><span class="line"></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
                <li>
                  <p>主库配置</p>
                  <ol>
                    <li>
                      <p>修改主库的配置文件</p>
                      <figure class="highlight properties">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="comment"># mysql 服务 ID,<hanla></hanla>保证整个集群环境中唯一,<hanla></hanla>取值范围: 1-2^32-1，默认为 1</span></span><br><span class="line"><span class="attr">server-id</span>=<span class="string">1</span></span><br><span class="line"><span class="comment"># 是否只读,1: 只读,0: 读写<hanla></hanla></span></span><br><span class="line"><span class="attr">read-only</span>=<span class="string">0</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 忽略的数据,<hanla></hanla>指不需要同步的数据库 [可选]</span></span><br><span class="line"><span class="comment"># binlog-ignore-db=mysql</span></span><br><span class="line"><span class="comment"># 指定同步的数据库</span></span><br><span class="line"><span class="comment"># binlog-do-db=coderitl</span></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                    <li>
                      <p>重启<hanla></hanla><code>MYSQL</code>
                        <hanla></hanla>服务
                      </p>
                      <figure class="highlight properties">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="attr">systemctl</span> <span class="string">restart mysqld</span></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                    <li>
                      <p>登录<hanla></hanla><code>MYSQL</code>
                        <hanla></hanla>主库,<hanla></hanla>创建远程连接的账号,<hanla></hanla>并授予主从复制权限
                      </p>
                      <figure class="highlight sql">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"># 创建用户 coder<span class="operator">-</span>itl,<hanla></hanla>并设置密码为: Root<span class="variable">@root</span>,<hanla></hanla>该用户可以在任意主机连接该 MYSQL 服务<hanla></hanla></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">'coder-itl'</span>@<span class="string">'%'</span> IDENTIFIED <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">'Root@root'</span>;</span><br><span class="line"># 为 `coder<span class="operator">-</span>itl`@<span class="string">'%'</span> 用户分配主从复制权限<hanla></hanla></span><br><span class="line"><span class="keyword">GRANT</span> REPLICATION SLAVE <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">'coder-itl'</span>@<span class="string">'%'</span>;</span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                    <li>
                      <p>通过指令,<hanla></hanla>查看二进制日志坐标</p>
                      <figure class="highlight sql">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="keyword">show</span> master status;</span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                      <table>
                        <thead>
                          <tr>
                            <th align="center"><code>File Position</code></th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/59ea87bf3ea94f55acf52b857db22d95.png"></td>
                          </tr>
                        </tbody>
                      </table>
                      <ul>
                        <li>字段含义<ul>
                            <li><code>file</code>: 从那个日志文件开始推送日志文件</li>
                            <li><code>position</code>：从那个位置开始推送日志</li>
                            <li><code>binlog_ignore_db</code>: 指定不需要同步的数据库</li>
                          </ul>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <p>不要在主库执行其他任何语句</p>
                    </li>
                  </ol>
                </li>
                <li>
                  <p>从库配置</p>
                  <ol>
                    <li>
                      <p>修改从库下的配置文件</p>
                      <figure class="highlight properties">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="comment"># mysql 服务 ID,<hanla></hanla>保证整个集群环境中唯一,<hanla></hanla>取值范围: 1-2^32-1，和主库不一样即可<hanla></hanla></span></span><br><span class="line"><span class="attr">server-id</span>=<span class="string">2</span></span><br><span class="line"><span class="comment"># 是否是只读,1: 只读,0: 读写<hanla></hanla></span></span><br><span class="line"><span class="attr">read-only</span>=<span class="string">1</span></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                    <li>
                      <p>重启<code>从库</code>的<hanla></hanla><code>MYSQL</code>
                        <hanla></hanla>服务
                      </p>
                      <figure class="highlight properties">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="attr">systemctl</span> <span class="string">restart mysqld</span></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                    <li>
                      <p>登录<hanla></hanla><code>MYSQL</code>
                        <hanla></hanla>从库,<hanla></hanla>设置主库配置
                      </p>
                      <figure class="highlight properties">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="comment"># 从库执行 (MYSQL version 8.0.23+)</span></span><br><span class="line"><span class="attr">CHANGE</span> <span class="string">replication source TO </span></span><br><span class="line">	<span class="attr">source_host</span> = <span class="string">'192.168.2.3',</span></span><br><span class="line">	<span class="attr">source_user</span> = <span class="string">'coder-itl',</span></span><br><span class="line">	<span class="attr">source_password</span> = <span class="string">'Root@root',</span></span><br><span class="line">	<span class="attr">source_log_file</span> = <span class="string">'binlog.000011',</span></span><br><span class="line">	<span class="attr">source_log_pos</span> = <span class="string">671;</span></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                      <figure class="highlight properties">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="comment">#  (MYSQL version 8.0.23-)</span></span><br><span class="line"><span class="attr">CHANGE</span> <span class="string">MASTER TO </span></span><br><span class="line">	<span class="attr">MASTER_HOST</span> = <span class="string">'192.168.2.3',</span></span><br><span class="line">	<span class="attr">MASTER_USER</span> = <span class="string">'coder-itl',</span></span><br><span class="line">	<span class="attr">MASTER_PASSWORD</span> = <span class="string">'Root@root',</span></span><br><span class="line">	<span class="attr">MASTER_LOG_FILE</span> = <span class="string">'binlog.000011',</span></span><br><span class="line">	<span class="attr">MASTER_LOG_POS</span> = <span class="string">671;</span></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">参数名</th>
                            <th align="center">含义</th>
                            <th align="center"><code>8.0.23</code>
                              <hanla></hanla>之前
                            </th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><code>source_host</code></td>
                            <td align="center">主库<hanla></hanla><code>IP</code>
                              <hanla></hanla>地址
                            </td>
                            <td align="center"><code>master_host</code></td>
                          </tr>
                          <tr>
                            <td align="center"><code>source_user</code></td>
                            <td align="center">连接主库的用户名<hanla></hanla>(<code>coder-itl</code>)</td>
                            <td align="center"><code>master_user</code></td>
                          </tr>
                          <tr>
                            <td align="center"><code>source_password</code></td>
                            <td align="center">连接主库的密码<hanla></hanla>(<code>Root@root</code>)</td>
                            <td align="center"><code>master_password</code></td>
                          </tr>
                          <tr>
                            <td align="center"><code>source_log_file</code></td>
                            <td align="center"><code>binlog</code>
                              <hanla></hanla>日志文件名<hanla></hanla>(<code>binlog.000011(主库获取)</code>)
                            </td>
                            <td align="center"><code>master_log_file</code></td>
                          </tr>
                          <tr>
                            <td align="center"><code>source_log_pos</code></td>
                            <td align="center"><code>binlog</code>
                              <hanla></hanla>日志文件位置<hanla></hanla>(<code>671: 主库获取</code>)
                            </td>
                            <td align="center"><code>master_log_pos</code></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                    <li>
                      <p>在从库上开启同步操作</p>
                      <figure class="highlight sql">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="keyword">start</span> replica; # mysql <span class="number">8.0</span><span class="number">.22</span> 之后<hanla></hanla></span><br><span class="line"><span class="keyword">start</span> slave; #  mysql <span class="number">8.0</span><span class="number">.22</span> 之前</span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                    <li>
                      <p>从库执行查看主从同步状态</p>
                      <figure class="highlight sql">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="keyword">show</span> replica status\G; # mysql <span class="number">8.0</span><span class="number">.22</span> 之后<hanla></hanla></span><br><span class="line"><span class="keyword">show</span> slave status\G; #  mysql <span class="number">8.0</span><span class="number">.22</span> 之前</span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                    <li>
                      <p>查看从库相对于主库是否正常</p>
                      <table>
                        <thead>
                          <tr>
                            <th align="center"><code>观察<hanla></hanla>Slave_IO_Running 和 Slave_SQL_Running</code>
                              <hanla></hanla>为<hanla></hanla><code>YES</code>
                              <hanla></hanla>即为正常
                            </th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/1f184d0e82d54cfd9efe777b8590f2c3.png"></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                  </ol>
                  <ul>
                    <li>
                      <p>测试主从是否同步</p>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">正常同步主库</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/79067ee188df47409d339cba81efc011.png"></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                    <li>
                      <p>上述步骤执行完毕查看时，如果出现<hanla></hanla><code>Slave_IO_Running</code>
                        <hanla></hanla>为<hanla></hanla><code>No</code>，并出现日志错误<hanla></hanla>(<code>index not found</code>)<hanla></hanla>解决方案
                      </p>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">
                              <font color="red"><strong>Slave_IO_Running: No</strong></font>
                            </th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/a652515d433748c99d4bb54b99b939f5.png"></td>
                          </tr>
                        </tbody>
                      </table>
                      <figure class="highlight sql">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"># <span class="number">1.</span> 登录<hanla></hanla>MYSQL<hanla></hanla>主库服务器，停止从库同步<hanla></hanla></span><br><span class="line">stop slave;</span><br><span class="line"># <span class="number">2.</span> 主库中关闭当前的二进制日志文件并创建一个新文件<hanla></hanla></span><br><span class="line">flush logs;</span><br><span class="line"># <span class="number">3.</span> 查看主库状态,<hanla></hanla>主要查看日志文件和位置<hanla></hanla></span><br><span class="line"><span class="keyword">show</span> master status\G;</span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">主库执行</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/2e48bda69eb546f0a422ecb658749606.png"></td>
                          </tr>
                        </tbody>
                      </table>
                      <figure class="highlight sql">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"># <span class="number">4.</span> 登录 MYSQL 从库服务器<hanla></hanla></span><br><span class="line">change master <span class="keyword">to</span> master_log_file<span class="operator">=</span><span class="string">'主库中获取到 binlog.000012'</span>,master_log_pos<span class="operator">=</span><span class="number">156</span>;</span><br><span class="line"># 启动从库<hanla></hanla></span><br><span class="line"><span class="keyword">start</span> slave;</span><br><span class="line"># 查看从库信息<hanla></hanla></span><br><span class="line"><span class="keyword">show</span> slave status\G;</span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                    <li>
                      <p>测试是否同步</p>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">主从执行流程</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/9c3ad27f7c0f4a169dbfd605cdc28e24.png"></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                    <li>
                      <p>
                        <font color="red"><strong>疑问</strong></font>
                      </p>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">只读从库写入了数据？</th>
                            <th align="center">主从数据发生了不一致</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/c5048808b28a416c879118e0636d2ed5.png"></td>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/29b38739bd0944d6a69d1e4045cffa6c.png"></td>
                          </tr>
                        </tbody>
                      </table>
                      <ul>
                        <li>
                          <p>由于从库登录的是<hanla></hanla><code>root</code>
                            <hanla></hanla>用户,<hanla></hanla>拥有的权限比较大,<hanla></hanla>所以出现上述情况
                          </p>
                        </li>
                        <li>
                          <p>测试<hanla></hanla><code>test</code>
                            <hanla></hanla>用户
                          </p>
                          <table>
                            <thead>
                              <tr>
                                <th align="center">使用其他用户登录</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/367f249f85224a7aa40ab95f95876c15.png"></td>
                              </tr>
                            </tbody>
                          </table>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
          <h3 id="分库分表"><a href="#分库分表" class="headerlink" title="分库分表"></a>分库分表</h3>
          <ul>
            <li>
              <p>单数据库出现的瓶颈</p>
              <div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i>
                <p>随着互联网及移动互联网的发展,<hanla></hanla>应用系统的数据量也是指数式增长,<hanla></hanla>若采用单数据库进行数据存储，存在以下性能瓶颈</p>
                <ol>
                  <li><code>IO<hanla></hanla>瓶颈</code>: 热点数据太多,<hanla></hanla>数据库缓存不足,<hanla></hanla>产生大量磁盘<hanla></hanla><code>IO</code>，效率较低。请求数据太多,<hanla></hanla>带宽不够,<hanla></hanla>网络<hanla></hanla><code>IO</code>
                    <hanla></hanla>瓶颈
                  </li>
                  <li><code>CPU</code>
                    <hanla></hanla>瓶颈: 排序、分组、连接查询、聚合统计等<hanla></hanla><code>SQL</code>
                    <hanla></hanla>会耗费大量的<hanla></hanla><code>CPU</code>
                    <hanla></hanla>资源，请求数太多，<code>CPU</code>
                    <hanla></hanla>出现瓶颈
                  </li>
                </ol>
                <blockquote>
                  <p>分库分表的中心思想就是将数据分散存储，使得单一数据库<hanla></hanla>/<hanla></hanla>表的数据量变小来缓解单一数据库的性能问题，从而达到提升数据库性能的目的。</p>
                </blockquote>
              </div>
            </li>
            <li>
              <p>垂直拆分</p>
              <ul>
                <li>
                  <p>垂直拆库: 以表为依据，根据业务将不同表拆分到不同库中</p>
                  <ul>
                    <li>
                      <p>特点</p>
                      <ul>
                        <li>每个库的表结构都不一样</li>
                        <li>每个库的数据也不一样</li>
                        <li>所有库的并集是全量数据</li>
                      </ul>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">垂直分库</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/c63e6d28ffdf4a46a0701c4d4289a5b6.png"></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                  </ul>
                </li>
                <li>
                  <p>垂直分表: 以字段为依据，根据字段属性将不同字段拆分到不同表中</p>
                  <ul>
                    <li>
                      <p>特点</p>
                      <ol>
                        <li>每个表的结构都不一样</li>
                        <li>每个表的数据也不一样，一般通过一列<hanla></hanla>(主键<hanla></hanla>/<hanla></hanla>外键)<hanla></hanla>关联</li>
                        <li>所有表的并集是全量数据</li>
                      </ol>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">垂直分表</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/57d49e3af8404673a97ecb739ed60dc5.png"></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
            <li>
              <p>水平拆分</p>
              <ul>
                <li>
                  <p>水平分库: 以字段为依据，按照一定策略，将一个库的数据拆分到多个库中</p>
                  <ul>
                    <li>
                      <p>特点</p>
                      <ol>
                        <li>每个库的表结构都一样</li>
                        <li>每个库的数据都不一样</li>
                        <li>所有库的并集是全量数据</li>
                      </ol>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">水平分库</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/00fee315575a44ee853c67862f07fe24.png"></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                  </ul>
                </li>
                <li>
                  <p>水平分表: 以字段为依据，按照一定策略，将一个表的数据拆分到多个表中</p>
                  <ul>
                    <li>
                      <p>特点:</p>
                      <ol>
                        <li>每个表的结构都一样</li>
                        <li>每个表的数据都不一样</li>
                        <li>所有表的并集是全量数据</li>
                      </ol>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">水平分表</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/c009c92d041c49bfa06236b964ca427a.png"></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
          <h3 id="MyCat"><a href="#MyCat" class="headerlink" title="MyCat"></a>MyCat</h3>
          <ul>
            <li>
              <p>下载</p>
              <blockquote>
                <p>文档: <a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.mycat.org.cn/">http://www.mycat.org.cn/</a></p>
                <p>下载页: <a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.mycat.org.cn/mycat1.html">http://www.mycat.org.cn/mycat1.html</a></p>
                <p>下载链接: <a target="_blank" rel="external nofollow noopener noreferrer" href="http://dl.mycat.org.cn/1.6.7.4/Mycat-server-1.6.7.4-release/Mycat-server-1.6.7.4-release-20200105164103-linux.tar.gz">http://dl.mycat.org.cn/1.6.7.4/Mycat-server-1.6.7.4-release/Mycat-server-1.6.7.4-release-20200105164103-linux.tar.gz</a></p>
              </blockquote>
              <table>
                <thead>
                  <tr>
                    <th align="center">①：点击使用<hanla></hanla><code>mycat1.6</code></th>
                    <th align="center">②: 点击下载</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/ab33c2f2888c48bcaa4f9005fb61c097.png"></td>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/e8be26fc098d481daae8896c247e0141.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p>服务器环境说明</p>
              <table>
                <thead>
                  <tr>
                    <th align="center">服务器</th>
                    <th align="center">安装软件</th>
                    <th align="center">说明</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center">192.168.2.3</td>
                    <td align="center"><code>JDK,Mycat</code></td>
                    <td align="center"><code>MyCat</code>
                      <hanla></hanla>中间件服务器
                    </td>
                  </tr>
                  <tr>
                    <td align="center">192.168.2.3</td>
                    <td align="center"><code>MYSQL</code></td>
                    <td align="center">分片服务器</td>
                  </tr>
                  <tr>
                    <td align="center">192.168.247.129</td>
                    <td align="center"><code>MYSQL</code></td>
                    <td align="center">分片服务器</td>
                  </tr>
                  <tr>
                    <td align="center">192.168.247.132</td>
                    <td align="center"><code>MYSQL</code></td>
                    <td align="center">分片服务器</td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p>安装</p>
              <ol>
                <li>
                  <p>上传<hanla></hanla><code>Mycat</code>
                    <hanla></hanla>至服务器<hanla></hanla>(<code>192.168.2.3</code>)
                  </p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center"><code>mycat</code> 上传服务器</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/937e9c33a9774868a87fe25afc0711f3.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p>解压到指定目录</p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center"><code>tar -zxvf Mycat-server-1.6.7.4-release-20200105164103-linux.tar.gz -C /usr/local</code></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/5d1dc84534a74597b5a30e857e53ea64.png"></td>
                      </tr>
                    </tbody>
                  </table>
                  <ul>
                    <li>目录说明<ul>
                        <li><code>bin</code>: 存放可执行文件,<hanla></hanla>用于启动停止<hanla></hanla><code>mycat</code></li>
                        <li><code>conf</code>: 存放<hanla></hanla><code>mycat</code>
                          <hanla></hanla>的配置文件
                        </li>
                        <li><code>lib</code>: 存放<hanla></hanla><code>mycat</code>
                          <hanla></hanla>的项目依赖包<hanla></hanla>(<code>jar</code>)
                        </li>
                        <li><code>logs</code>: 存放<hanla></hanla><code>mycat</code>
                          <hanla></hanla>的日志文件
                        </li>
                      </ul>
                    </li>
                  </ul>
                </li>
                <li>
                  <p>删除并重新下载<hanla></hanla><code>mysql</code>
                    <hanla></hanla>连接驱动<hanla></hanla><code>jar</code>
                  </p>
                  <figure class="highlight properties">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">#mycat: /usr/local/mycat/lib </span></span><br><span class="line"><span class="attr">wget</span> <span class="string">https://repo1.maven.org/maven2/mysql/mysql-connector-java/8.0.28/mysql-connector-java-8.0.28.jar</span></span><br><span class="line"><span class="comment"># 赋予权限<hanla></hanla></span></span><br><span class="line"><span class="attr">chmod</span> <span class="string">777 mysql-connector-java-8.0.28.jar</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                </li>
              </ol>
            </li>
            <li>
              <p><code>Mycat</code>
                <hanla></hanla>概述
              </p>
              <table>
                <thead>
                  <tr>
                    <th align="center">结构</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/9c186f613f8e4b9cabccb1178652dc4b.png"></td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p>快速入门</p>
              <ul>
                <li>
                  <p>需求</p>
                  <div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i>
                    <p>由于<hanla></hanla><code>tb_order</code>
                      <hanla></hanla>表中数据量很大，磁盘<hanla></hanla><code>IO</code>
                      <hanla></hanla>及容量都达到了瓶颈，现在需要对<hanla></hanla><code>tb_order</code>
                      <hanla></hanla>表进行数据分片，分为三个数据节点，每一个节点主机位于不同的服务器上,<hanla></hanla>具体结构，如下:
                    </p>
                  </div>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">水平分表实现</th>
                        <th align="center"><code>schema.xml</code></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/8d930afc42574867b9e472becc25996e.png" style="zoom:50%;"></td>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/bcc8250fab6840a1947e6909ee2071e2.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p><code>服务器环境</code></p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">服务器环境</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/ec0fbfd869c54a11a84db6544b5099d5.png" style="zoom:50%;"></td>
                      </tr>
                    </tbody>
                  </table>
                  <ol>
                    <li>
                      <p>检查所有服务器防火墙是否关闭</p>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">防火墙状态</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/cdb7cc086bc945fc9fff711cd457e4a3.png"></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                    <li>
                      <p>在三台服务器上创建同一个数据库</p>
                      <figure class="highlight sql">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line">#  创建数据库不要执行其他任何操作在 mysql</span><br><span class="line"><span class="keyword">create</span> database db01;</span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                  </ol>
                </li>
                <li>
                  <p><code>mycat</code>
                    <hanla></hanla>分片配置
                  </p>
                  <ul>
                    <li>
                      <p><code>sechema.xml</code></p>
                      <figure class="highlight xml">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mycat</span>:schema <span class="keyword">SYSTEM</span> <span class="string">"schema.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mycat:schema</span> <span class="attr">xmlns:mycat</span>=<span class="string">"http://io.mycat/"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">"DB01"</span> <span class="attr">checkSQLschema</span>=<span class="string">"true"</span> <span class="attr">sqlMaxLimit</span>=<span class="string">"100"</span> <span class="attr">randomDataNode</span>=<span class="string">"dn1"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"TB_ORDER"</span> <span class="attr">dataNode</span>=<span class="string">"dn1,dn2,dn3"</span> <span class="attr">rule</span>=<span class="string">"auto-sharding-long"</span> <span class="attr">splitTableNames</span> =<span class="string">"true"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">schema</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">"dn1"</span> <span class="attr">dataHost</span>=<span class="string">"localhost1"</span> <span class="attr">database</span>=<span class="string">"db01"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">"dn2"</span> <span class="attr">dataHost</span>=<span class="string">"localhost2"</span> <span class="attr">database</span>=<span class="string">"db01"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">"dn3"</span> <span class="attr">dataHost</span>=<span class="string">"localhost3"</span> <span class="attr">database</span>=<span class="string">"db01"</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">dataHost</span> <span class="attr">name</span>=<span class="string">"localhost1"</span> <span class="attr">maxCon</span>=<span class="string">"1000"</span> <span class="attr">minCon</span>=<span class="string">"10"</span> <span class="attr">balance</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">			  <span class="attr">writeType</span>=<span class="string">"0"</span> <span class="attr">dbType</span>=<span class="string">"mysql"</span> <span class="attr">dbDriver</span>=<span class="string">"jdbc"</span> <span class="attr">switchType</span>=<span class="string">"1"</span>  <span class="attr">slaveThreshold</span>=<span class="string">"100"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">heartbeat</span>&gt;</span>select user()<span class="tag">&lt;/<span class="name">heartbeat</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">writeHost</span> <span class="attr">host</span>=<span class="string">"hostM1"</span> <span class="attr">url</span>=<span class="string">"jdbc:mysql://192.168.2.3:3306/?characterEncoding=utf8<span class="symbol">&amp;amp;</span>useSSL=false<span class="symbol">&amp;amp;</span>serverTimezone=UTC<span class="symbol">&amp;amp;</span>rewriteBatchedStatements=true"</span> <span class="attr">user</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">				   <span class="attr">password</span>=<span class="string">"root"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">writeHost</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;/<span class="name">dataHost</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">dataHost</span> <span class="attr">name</span>=<span class="string">"localhost2"</span> <span class="attr">maxCon</span>=<span class="string">"1000"</span> <span class="attr">minCon</span>=<span class="string">"10"</span> <span class="attr">balance</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">			  <span class="attr">writeType</span>=<span class="string">"0"</span> <span class="attr">dbType</span>=<span class="string">"mysql"</span> <span class="attr">dbDriver</span>=<span class="string">"jdbc"</span> <span class="attr">switchType</span>=<span class="string">"1"</span>  <span class="attr">slaveThreshold</span>=<span class="string">"100"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">heartbeat</span>&gt;</span>select user()<span class="tag">&lt;/<span class="name">heartbeat</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">writeHost</span> <span class="attr">host</span>=<span class="string">"hostM1"</span> <span class="attr">url</span>=<span class="string">"jdbc:mysql://192.168.247.129:3306/?characterEncoding=utf8<span class="symbol">&amp;amp;</span>useSSL=false<span class="symbol">&amp;amp;</span>serverTimezone=UTC<span class="symbol">&amp;amp;</span>rewriteBatchedStatements=true"</span> <span class="attr">user</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">				   <span class="attr">password</span>=<span class="string">"root"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">writeHost</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;/<span class="name">dataHost</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">dataHost</span> <span class="attr">name</span>=<span class="string">"localhost3"</span> <span class="attr">maxCon</span>=<span class="string">"1000"</span> <span class="attr">minCon</span>=<span class="string">"10"</span> <span class="attr">balance</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">			  <span class="attr">writeType</span>=<span class="string">"0"</span> <span class="attr">dbType</span>=<span class="string">"mysql"</span> <span class="attr">dbDriver</span>=<span class="string">"jdbc"</span> <span class="attr">switchType</span>=<span class="string">"1"</span>  <span class="attr">slaveThreshold</span>=<span class="string">"100"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">heartbeat</span>&gt;</span>select user()<span class="tag">&lt;/<span class="name">heartbeat</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">writeHost</span> <span class="attr">host</span>=<span class="string">"hostM1"</span> <span class="attr">url</span>=<span class="string">"jdbc:mysql://192.168.247.132:3306/?characterEncoding=utf8<span class="symbol">&amp;amp;</span>useSSL=false<span class="symbol">&amp;amp;</span>serverTimezone=UTC<span class="symbol">&amp;amp;</span>rewriteBatchedStatements=true"</span> <span class="attr">user</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">				   <span class="attr">password</span>=<span class="string">"root"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">writeHost</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;/<span class="name">dataHost</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">mycat:schema</span>&gt;</span></span><br><span class="line"></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                    <li>
                      <p>在<hanla></hanla><code>bin</code>
                        <hanla></hanla>目录执行启动<hanla></hanla><code>mycat start</code>
                      </p>
                    </li>
                    <li>
                      <p>查看日志是否启动</p>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">红色信息内容: 驱动将自动加载注册,<hanla></hanla>启动成功占用端口:<code>8066</code></th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/4c5a39ef94814e06b6c9b862e7bdd082.png"></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                  </ul>
                </li>
                <li>
                  <p>分片测试</p>
                  <ol>
                    <li>
                      <p>登录<hanla></hanla><code>mycat</code>,<hanla></hanla>把<hanla></hanla><code>mycat</code>
                        <hanla></hanla>当作一台<hanla></hanla><code>mysql</code>
                      </p>
                      <figure class="highlight sql">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line">mysql <span class="operator">-</span>h <span class="number">192.168</span><span class="number">.2</span><span class="number">.3</span> <span class="operator">-</span>P <span class="number">8066</span> <span class="operator">-</span>uroot <span class="operator">-</span>proot</span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">登录<hanla></hanla><code>MyCat</code></th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/ad5578ce1d18452cb1637790c9a0fe7f.png"></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                    <li>
                      <p>查看表，并创建真实结构</p>
                      <figure class="highlight sql">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_order(</span><br><span class="line">   id <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">   title <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">   <span class="keyword">primary</span> key(id)</span><br><span class="line"> )engine<span class="operator">=</span>innodb <span class="keyword">default</span> charset<span class="operator">=</span>utf8;</span><br><span class="line">       </span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                      <table>
                        <thead>
                          <tr>
                            <th align="center"><code>mycat</code>
                              <hanla></hanla>创建表结构
                            </th>
                            <th align="center">登录其他服务器查看<hanla></hanla>(大小写敏感)</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/f486057b2090480a912e13ae7126e35c.png"></td>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/07a8530a457f49ccb5daf8cf3847e6c8.png"></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                    <li>
                      <p>在已登录的<hanla></hanla><code>mycat</code>
                        <hanla></hanla>数据库服务器添加数据
                      </p>
                      <table>
                        <thead>
                          <tr>
                            <th align="center"><code>mycat</code>
                              <hanla></hanla>插入数据时必须提供列
                            </th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/b93dac38199e4e8a85ae52307ac8f0b2.png"></td>
                          </tr>
                        </tbody>
                      </table>
                      <figure class="highlight sql">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> TB_ORDER(id,title)  <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">'aa'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> TB_ORDER(id,title)  <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">'bb'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> TB_ORDER(id,title)  <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">'cc'</span>);</span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                      <table>
                        <thead>
                          <tr>
                            <th align="center">以下数据库中的数据分布规则是由于<hanla></hanla><code>rule="auto-sharding-long"</code>导致的</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/5303c182f5ed46dead5954e31903b7fe.png"></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                  </ol>
                </li>
              </ul>
            </li>
            <li>
              <p><code>mycat</code>
                <hanla></hanla>配置
              </p>
              <ul>
                <li>
                  <p><code>schema.xml</code></p>
                  <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                    <p><code>schema.xml</code>
                      <hanla></hanla>作为<hanla></hanla><code>MyCat</code>
                      <hanla></hanla>中最重要的配置文件之一，涵盖了<hanla></hanla><code>MyCat</code>
                      <hanla></hanla>的逻辑库、逻辑表、分片规则、分片节点及数据源的配置
                    </p>
                    <p>主要包含以下三组标签:</p>
                    <ul>
                      <li><code>schema</code>
                        <hanla></hanla>标签
                      </li>
                      <li><code>datanode</code>
                        <hanla></hanla>标签
                      </li>
                      <li><code>datahost</code>
                        <hanla></hanla>标签
                      </li>
                    </ul>
                  </div>
                  <ul>
                    <li>
                      <p><code>schema</code>
                        <hanla></hanla>标签
                      </p>
                      <figure class="highlight xml">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">"DB01"</span> <span class="attr">checkSQLschema</span>=<span class="string">"true"</span> <span class="attr">sqlMaxLimit</span>=<span class="string">"100"</span> <span class="attr">randomDataNode</span>=<span class="string">"dn1"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"TB_ORDER"</span> <span class="attr">dataNode</span>=<span class="string">"dn1,dn2,dn3"</span> <span class="attr">rule</span>=<span class="string">"auto-sharding-long"</span> <span class="attr">splitTableNames</span> =<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">schema</span>&gt;</span></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                      <div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i>
                        <p><code>schema</code>
                          <hanla></hanla>标签用于定义<hanla></hanla><code>MyCat</code>
                          <hanla></hanla>实例中的逻辑库，一个<hanla></hanla><code>MyCat</code>
                          <hanla></hanla>实例中，可以有多个逻辑库，可以通过<hanla></hanla><code>schema</code>
                          <hanla></hanla>标签来划分不同的逻辑库。
                        </p>
                        <p><code>MyCat</code>
                          <hanla></hanla>中的逻辑库的概念，等同于<hanla></hanla><code>MySQL</code>
                          <hanla></hanla>中的<hanla></hanla><code>database</code>
                          <hanla></hanla>概念，需要操作某个逻辑库下的表时，也需要切换逻辑库。
                        </p>
                        <p>核心属性:</p>
                        <ul>
                          <li>
                            <p><code>name</code>: 指定自定义的逻辑库名</p>
                          </li>
                          <li>
                            <p><code>checkSQLschema</code>: 在<hanla></hanla><code>SQL</code>
                              <hanla></hanla>语句操作时指定了数据库名称，执行时是否自动去除
                            </p>
                            <ul>
                              <li><code>true</code>: 自动去除</li>
                              <li><code>false</code>: 不自动去除</li>
                            </ul>
                            <table>
                              <thead>
                                <tr>
                                  <th align="center">目前配置的是: <code>checkSQLschema: true</code>,<hanla></hanla>操作必须先执行:<code>use database-name</code></th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr>
                                  <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/919643ffdee64571b1033a8883110f9a.png"></td>
                                </tr>
                              </tbody>
                            </table>
                          </li>
                          <li>
                            <p><code>sqlMaxLimit</code>: 如果未指定<hanla></hanla><code>limit</code>
                              <hanla></hanla>进行查询,<hanla></hanla>列表查询模式查询多少条记录
                            </p>
                          </li>
                        </ul>
                      </div>
                      <ul>
                        <li>
                          <p><code>table</code>
                            <hanla></hanla>标签定义了<hanla></hanla><code>MyCat</code>
                            <hanla></hanla>中逻辑库<hanla></hanla><code>schema</code>
                            <hanla></hanla>下的逻辑表，所有需要拆分的表都需要在<hanla></hanla><code>table</code>
                            <hanla></hanla>标签中定义
                          </p>
                          <ul>
                            <li>
                              <p>核心属性</p>
                              <ol>
                                <li><code>name</code>: 定义逻辑表表名，在该逻辑库下唯一</li>
                                <li><code>dataNode</code>: 定义逻辑表所属的<hanla></hanla><code>dataNode</code>，该属性需要与<hanla></hanla><code>dataNode</code>
                                  <hanla></hanla>标签中<hanla></hanla><code>name</code>
                                  <hanla></hanla>对应；多个<hanla></hanla><code>dataNode</code>
                                  <hanla></hanla>逗号分割
                                </li>
                                <li><code>rule</code>: 分片规则名称，分片规则名字是在<hanla></hanla><code>rule.xml</code>
                                  <hanla></hanla>中定义的
                                </li>
                                <li><code>primaryKey</code>: 逻辑表对应真实表的主键</li>
                                <li><code>type</code>: 逻辑表的类型,<hanla></hanla>目前逻辑表只有全局表和普通表，如果未配置，就是普通表；全局表，配置为<hanla></hanla><code>global</code></li>
                              </ol>
                              <figure class="highlight xml">
                                <table>
                                  <tbody>
                                    <tr>
                                      <td class="gutter">
                                        <pre><span class="line">1</span><br></pre>
                                      </td>
                                      <td class="code">
                                        <pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"TB_ORDER"</span> <span class="attr">dataNode</span>=<span class="string">"dn1,dn2,dn3"</span> <span class="attr">rule</span>=<span class="string">"auto-sharding-long"</span> <span class="attr">splitTableNames</span> =<span class="string">"true"</span>/&gt;</span></span><br></pre>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </figure>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p><code>dataNode</code>
                            <hanla></hanla>标签
                          </p>
                          <figure class="highlight xml">
                            <table>
                              <tbody>
                                <tr>
                                  <td class="gutter">
                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                                  </td>
                                  <td class="code">
                                    <pre><span class="line"><span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">"dn1"</span> <span class="attr">dataHost</span>=<span class="string">"localhost1"</span> <span class="attr">database</span>=<span class="string">"db01"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">"dn2"</span> <span class="attr">dataHost</span>=<span class="string">"localhost2"</span> <span class="attr">database</span>=<span class="string">"db01"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">"dn3"</span> <span class="attr">dataHost</span>=<span class="string">"localhost3"</span> <span class="attr">database</span>=<span class="string">"db01"</span> /&gt;</span></span><br></pre>
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </figure>
                          <blockquote>
                            <p><code>dataNode</code>
                              <hanla></hanla>标签中定义了<hanla></hanla><code>MyCat</code>
                              <hanla></hanla>中的数据节点，也就是我们通常说的数据分片。一个<hanla></hanla><code>dataNode</code>
                              <hanla></hanla>标签就是一个独立的数据分片
                            </p>
                          </blockquote>
                          <ul>
                            <li>核心属性<ol>
                                <li><code>name</code>: 定义数据节点名称</li>
                                <li><code>dataHost</code>: 数据库实例的主机名称，引用自<hanla></hanla><code>dataHost</code>
                                  <hanla></hanla>标签中的<hanla></hanla><code>name</code>
                                  <hanla></hanla>属性
                                </li>
                                <li><code>database</code>: 定义分片所属数据库</li>
                              </ol>
                            </li>
                          </ul>
                        </li>
                        <li>
                          <p><code>dataHost</code>
                            <hanla></hanla>标签
                          </p>
                          <blockquote>
                            <p>该标签在<hanla></hanla><code>MyCat</code>
                              <hanla></hanla>逻辑库中作为底层标签存在，直接定义了具体的数据库实例、读写分离、心跳语句
                            </p>
                          </blockquote>
                          <figure class="highlight xml">
                            <table>
                              <tbody>
                                <tr>
                                  <td class="gutter">
                                    <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                                  </td>
                                  <td class="code">
                                    <pre><span class="line"><span class="tag">&lt;<span class="name">dataHost</span> <span class="attr">name</span>=<span class="string">"localhost1"</span> <span class="attr">maxCon</span>=<span class="string">"1000"</span> <span class="attr">minCon</span>=<span class="string">"10"</span> <span class="attr">balance</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">writeType</span>=<span class="string">"0"</span> <span class="attr">dbType</span>=<span class="string">"mysql"</span> <span class="attr">dbDriver</span>=<span class="string">"jdbc"</span> <span class="attr">switchType</span>=<span class="string">"1"</span>  <span class="attr">slaveThreshold</span>=<span class="string">"100"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">heartbeat</span>&gt;</span>select user()<span class="tag">&lt;/<span class="name">heartbeat</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">writeHost</span> <span class="attr">host</span>=<span class="string">"hostM1"</span> </span></span><br><span class="line"><span class="tag">               <span class="attr">url</span>=<span class="string">"jdbc:mysql://192.168.2.3:3306/?characterEncoding=utf8<span class="symbol">&amp;amp;</span>useSSL=false<span class="symbol">&amp;amp;</span>serverTimezone=UTC<span class="symbol">&amp;amp;</span>rewriteBatchedStatements=true"</span> </span></span><br><span class="line"><span class="tag">               <span class="attr">user</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">               <span class="attr">password</span>=<span class="string">"root"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">writeHost</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dataHost</span>&gt;</span></span><br></pre>
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </figure>
                          <ul>
                            <li>核心属性<ol>
                                <li><code>name</code>: 唯一标识，供上层标签使用</li>
                                <li><code>maxCon/minCon</code>: 最大连接数<hanla></hanla>/<hanla></hanla>最小连接数</li>
                                <li><code>balance</code>: 负载均衡策略,<hanla></hanla>取值<hanla></hanla><code>0,1,2,3</code></li>
                                <li><code>writeType</code>: 写操作分发方式<hanla></hanla>(<code>0:</code>
                                  <hanla></hanla>写操作转发到第一个<hanla></hanla><code>writeHost</code>，第一个挂了，切换到第二个，<code>1</code>:<hanla></hanla>写操作随即分发到配置的<hanla></hanla><code>writeHost</code>)
                                </li>
                                <li><code>dbDriver</code>: 数据库驱动，支持<hanla></hanla><code>native、jdbc</code></li>
                              </ol>
                            </li>
                          </ul>
                        </li>
                      </ul>
                    </li>
                  </ul>
                </li>
                <li>
                  <p><code>rule.xml</code></p>
                  <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                    <p><code>rule.xml</code>
                      <hanla></hanla>中定义了所有拆分表的规则，在使用过程中可以灵活使用分片算法，或者对同一个分片算法使用不同的参数，他让分片过程可配置化。主要包含两类标签: <code>tableRule、Function</code>
                    </p>
                    <table>
                      <thead>
                        <tr>
                          <th align="center"><code>rule.xml</code></th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/df601eddee1c439d9822cdee808521c1.png"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </li>
                <li>
                  <p><code>server.xml</code></p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center"><code>user</code></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/3732d9512cb04faa926d371608866360.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
              </ul>
            </li>
            <li>
              <p><code>MyCat</code>
                <hanla></hanla>分片<hanla></hanla>(分库分表)
              </p>
              <ul>
                <li>
                  <p>垂直拆分</p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center">拆分过程分析</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/84f2bd5984f24812baf5325bf2da7508.png"></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p>配置<hanla></hanla><code>schema.xml</code></p>
                  <table>
                    <thead>
                      <tr>
                        <th align="center"><code>schema.xml</code></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/f53a0457728e4a3d9a1f8d747ee38e7d.png"></td>
                      </tr>
                    </tbody>
                  </table>
                  <figure class="highlight xml">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">&lt;!-- 垂直分库: schema.xml --&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">"1.0"</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mycat</span>:schema <span class="keyword">SYSTEM</span> <span class="string">"schema.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mycat:schema</span> <span class="attr">xmlns:mycat</span>=<span class="string">"http://io.mycat/"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 逻辑库配置 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">"SHOPPING"</span> <span class="attr">checkSQLschema</span>=<span class="string">"true"</span> <span class="attr">sqlMaxLimit</span>=<span class="string">"100"</span> <span class="attr">randomDataNode</span>=<span class="string">"dn1"</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- <span class="doctag">TODO:</span> 落在第一个分片中 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"tb_goods_base"</span> <span class="attr">dataNode</span>=<span class="string">"dn1"</span> <span class="attr">primaryKey</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"tb_goods_brand"</span> <span class="attr">dataNode</span>=<span class="string">"dn1"</span> <span class="attr">primaryKey</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"tb_goods_cat"</span> <span class="attr">dataNode</span>=<span class="string">"dn1"</span> <span class="attr">primaryKey</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"tb_goods_desc"</span> <span class="attr">dataNode</span>=<span class="string">"dn1"</span> <span class="attr">primaryKey</span>=<span class="string">"goods_id"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"tb_goods_item"</span> <span class="attr">dataNode</span>=<span class="string">"dn1"</span> <span class="attr">primaryKey</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 落在第二个分片中 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"tb_order_item"</span> <span class="attr">dataNode</span>=<span class="string">"dn2"</span> <span class="attr">primaryKey</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"tb_order_master"</span> <span class="attr">dataNode</span>=<span class="string">"dn2"</span> <span class="attr">primaryKey</span>=<span class="string">"order_id"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"tb_order_pay_log"</span> <span class="attr">dataNode</span>=<span class="string">"dn2"</span> <span class="attr">primaryKey</span>=<span class="string">"out_trade_no"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 落在第三个分片中 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"tb_user"</span> <span class="attr">dataNode</span>=<span class="string">"dn3"</span> <span class="attr">primaryKey</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"tb_user_address"</span> <span class="attr">dataNode</span>=<span class="string">"dn3"</span> <span class="attr">primaryKey</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"tb_user_provinces"</span> <span class="attr">dataNode</span>=<span class="string">"dn3"</span> <span class="attr">primaryKey</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"tb_user_city"</span> <span class="attr">dataNode</span>=<span class="string">"dn3"</span> <span class="attr">primaryKey</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>=<span class="string">"tb_areas_region"</span> <span class="attr">dataNode</span>=<span class="string">"dn3"</span> <span class="attr">primaryKey</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">schema</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">"dn1"</span> <span class="attr">dataHost</span>=<span class="string">"localhost1"</span> <span class="attr">database</span>=<span class="string">"shopping"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">"dn2"</span> <span class="attr">dataHost</span>=<span class="string">"localhost2"</span> <span class="attr">database</span>=<span class="string">"shopping"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">"dn3"</span> <span class="attr">dataHost</span>=<span class="string">"localhost3"</span> <span class="attr">database</span>=<span class="string">"shopping"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dataHost</span> <span class="attr">name</span>=<span class="string">"localhost1"</span> <span class="attr">maxCon</span>=<span class="string">"1000"</span> <span class="attr">minCon</span>=<span class="string">"10"</span> <span class="attr">balance</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">writeType</span>=<span class="string">"0"</span> <span class="attr">dbType</span>=<span class="string">"mysql"</span> <span class="attr">dbDriver</span>=<span class="string">"jdbc"</span> <span class="attr">switchType</span>=<span class="string">"1"</span>  <span class="attr">slaveThreshold</span>=<span class="string">"100"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">heartbeat</span>&gt;</span>select user()<span class="tag">&lt;/<span class="name">heartbeat</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">writeHost</span> <span class="attr">host</span>=<span class="string">"hostM1"</span> <span class="attr">url</span>=<span class="string">"jdbc:mysql://192.168.2.3:3306/?characterEncoding=utf8<span class="symbol">&amp;amp;</span>useSSL=false<span class="symbol">&amp;amp;</span>serverTimezone=UTC<span class="symbol">&amp;amp;</span>rewriteBatchedStatements=true"</span> <span class="attr">user</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">password</span>=<span class="string">"root"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">writeHost</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dataHost</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dataHost</span> <span class="attr">name</span>=<span class="string">"localhost2"</span> <span class="attr">maxCon</span>=<span class="string">"1000"</span> <span class="attr">minCon</span>=<span class="string">"10"</span> <span class="attr">balance</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">writeType</span>=<span class="string">"0"</span> <span class="attr">dbType</span>=<span class="string">"mysql"</span> <span class="attr">dbDriver</span>=<span class="string">"jdbc"</span> <span class="attr">switchType</span>=<span class="string">"1"</span>  <span class="attr">slaveThreshold</span>=<span class="string">"100"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">heartbeat</span>&gt;</span>select user()<span class="tag">&lt;/<span class="name">heartbeat</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">writeHost</span> <span class="attr">host</span>=<span class="string">"hostM1"</span> <span class="attr">url</span>=<span class="string">"jdbc:mysql://192.168.247.129:3306/?characterEncoding=utf8<span class="symbol">&amp;amp;</span>useSSL=false<span class="symbol">&amp;amp;</span>serverTimezone=UTC<span class="symbol">&amp;amp;</span>rewriteBatchedStatements=true"</span> <span class="attr">user</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">password</span>=<span class="string">"root"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">writeHost</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dataHost</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dataHost</span> <span class="attr">name</span>=<span class="string">"localhost3"</span> <span class="attr">maxCon</span>=<span class="string">"1000"</span> <span class="attr">minCon</span>=<span class="string">"10"</span> <span class="attr">balance</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">writeType</span>=<span class="string">"0"</span> <span class="attr">dbType</span>=<span class="string">"mysql"</span> <span class="attr">dbDriver</span>=<span class="string">"jdbc"</span> <span class="attr">switchType</span>=<span class="string">"1"</span>  <span class="attr">slaveThreshold</span>=<span class="string">"100"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">heartbeat</span>&gt;</span>select user()<span class="tag">&lt;/<span class="name">heartbeat</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">writeHost</span> <span class="attr">host</span>=<span class="string">"hostM1"</span> <span class="attr">url</span>=<span class="string">"jdbc:mysql://192.168.247.132:3306/?characterEncoding=utf8<span class="symbol">&amp;amp;</span>useSSL=false<span class="symbol">&amp;amp;</span>serverTimezone=UTC<span class="symbol">&amp;amp;</span>rewriteBatchedStatements=true"</span> <span class="attr">user</span>=<span class="string">"root"</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">password</span>=<span class="string">"root"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">writeHost</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dataHost</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mycat:schema</span>&gt;</span></span><br><span class="line"></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <figure class="highlight xml">
                    <table>
                      <tbody>
                        <tr>
                          <td class="gutter">
                            <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                          </td>
                          <td class="code">
                            <pre><span class="line"><span class="comment">&lt;!-- server.xml --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span> <span class="attr">name</span>=<span class="string">"root"</span> <span class="attr">defaultAccount</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"schemas"</span>&gt;</span>SHOPPING<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- <span class="doctag">TODO:</span> user 是自行创立的用户还是全局用户 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span> <span class="attr">name</span>=<span class="string">"test"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span>test<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"schemas"</span>&gt;</span>SHOPPING<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"readOnly"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </figure>
                  <ul>
                    <li>
                      <p>重启<hanla></hanla><code>mycat</code>
                        <hanla></hanla>服务
                      </p>
                      <figure class="highlight properties">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="attr">cd</span> <span class="string">/usr/local/mycat</span></span><br><span class="line"><span class="attr">bin/mycat</span> <span class="string">restart</span></span><br><span class="line"><span class="attr">tail</span> <span class="string">-f logs/wrapper.log</span></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                    <li>
                      <p>登录<hanla></hanla><code>Mycat</code>,<hanla></hanla>查看数据库</p>
                      <figure class="highlight properties">
                        <table>
                          <tbody>
                            <tr>
                              <td class="gutter">
                                <pre><span class="line">1</span><br></pre>
                              </td>
                              <td class="code">
                                <pre><span class="line"><span class="attr">mysql</span> <span class="string">-h 192.168.2.3 -P 8066 -u root -proot</span></span><br></pre>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </figure>
                    </li>
                    <li>
                      <p>在<hanla></hanla><code>mycat</code>
                        <hanla></hanla>创建逻辑表对应的表结构
                      </p>
                    </li>
                    <li>
                      <p>在<hanla></hanla><code>mycat</code>
                        <hanla></hanla>插入逻辑表对应的数据
                      </p>
                    </li>
                  </ul>
                </li>
                <li>
                  <p>水平分表</p>
                  <div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i>
                    <p>在业务系统中，有一张表<hanla></hanla>(<code>日志表</code>),<hanla></hanla>业务系统每天都会产生大量的日志数据，单台服务器的数据存储及处理能力是有限的，可以对数据库表进行拆分。</p>
                    <table>
                      <thead>
                        <tr>
                          <th align="center">水平拆分分析</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td align="center"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/f3e1f017602444cf92a7ae19d78f77fb.png"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </li>
              </ul>
            </li>
          </ul>
        </article>
        <div class="post-copyright">
          <div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://coderitl.github.io">coder-itl</a></span></div>
          <div class="post-copyright__type"><span class="post-copyright-meta">
              <hanla></hanla>文章链接:
            </span><span class="post-copyright-info"><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.nesxc.com/post/hexocc.html">https://www.nesxc.com/post/hexocc.html</a></span></div>
          <div class="post-copyright__notice"><span class="post-copyright-meta">
              <hanla></hanla>版权声明:
            </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="external nofollow noopener noreferrer">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://coderitl.github.io" target="_blank">coder-itl</a>！</span></div>
        </div>
        <div class="tag_share">
          <div class="post-meta__tag-list"></div>
          <div class="post_share">
            <div class="social-share" data-image="https://i.328888.xyz/2023/04/01/i2pIO3.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'">
            <script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer=""></script>
          </div>
        </div>
        <nav class="pagination-post" id="pagination">
          <div class="prev-post pull-left"><a href="/2021/08/06/60206.html" title="JavaWeb"><img class="cover" src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img-blog.csdnimg.cn/e32cd7a40e6d45b79a8f8b873f551f85.jpeg" onerror="onerror=null;src='/null'" alt="cover of previous post">
              <div class="pagination-info">
                <div class="label">上一篇<hanla></hanla>
                </div>
                <div class="prev_info">JavaWeb</div>
              </div>
            </a></div>
          <div class="next-post pull-right"><a href="/2021/08/05/26534.html" title="MYSQL-Linux-Install"><img class="cover" src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/coderitl/hiddenContent@v1.10/day321/28.jpg" onerror="onerror=null;src='/null'" alt="cover of next post">
              <div class="pagination-info">
                <div class="label">
                  <hanla></hanla>下一篇<hanla></hanla>
                </div>
                <div class="next_info">MYSQL-Linux-Install</div>
              </div>
            </a></div>
        </nav>
        <hr>
        <div id="post-comment">
          <div class="comment-head">
            <div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论<hanla></hanla></span></div>
          </div>
          <div class="comment-wrap">
            <div>
              <div id="twikoo-wrap"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="aside-content" id="aside-content">
        <div class="card-widget card-info">
          <div class="is-center">
            <div class="avatar-img"><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://i.328888.xyz/2023/03/19/MJUXa.jpeg" onerror="this.onerror=null;this.src='https://i.328888.xyz/2023/03/20/P3kfC.gif'" alt="avatar"></div>
            <div class="author-info__name">coder-itl</div>
            <div class="author-info__description">To read without reflecting is like eating without digesting.</div>
          </div>
          <div class="card-info-data site-data is-center"><a href="/archives/">
              <div class="headline">
                <hanla></hanla>文章<hanla></hanla>
              </div>
              <div class="length-num">119</div>
            </a><a href="/tags/">
              <div class="headline">
                <hanla></hanla>标签<hanla></hanla>
              </div>
              <div class="length-num">21</div>
            </a><a href="/categories/">
              <div class="headline">
                <hanla></hanla>分类<hanla></hanla>
              </div>
              <div class="length-num">13</div>
            </a></div><a id="card-info-btn" target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a>
        </div>
        <div class="card-widget card-announcement">
          <div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>
              <hanla></hanla>公告
            </span></div>
          <div class="announcement_content">本站所有图片来源于网络,<hanla></hanla>侵权请添加管理员删除【3327511395@qq.com】!</div>
        </div>
        <div class="sticky_layout">
          <div class="card-widget" id="card-toc">
            <div class="item-headline"><i class="fas fa-stream"></i><span>
                <hanla></hanla>目录<hanla></hanla>
              </span><span class="toc-percentage"></span></div>
            <div class="toc-content">
              <ol class="toc">
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95"><span class="toc-number">1.</span> <span class="toc-text">索引<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%91"><span class="toc-number">2.</span> <span class="toc-text">树<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E7%BB%93%E6%9E%84"><span class="toc-number">3.</span> <span class="toc-text">索引结构<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB"><span class="toc-number">4.</span> <span class="toc-text">索引分类<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E8%AF%AD%E6%B3%95"><span class="toc-number">5.</span> <span class="toc-text">索引语法<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88-InnoDB-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E9%80%89%E6%8B%A9%E4%BD%BF%E7%94%A8-B-tree-%E7%B4%A2%E5%BC%95"><span class="toc-number">6.</span> <span class="toc-text">为什么 InnoDB 存储引擎选择使用 B+tree 索引<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-number">7.</span> <span class="toc-text">SQL 性能分析<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#explain"><span class="toc-number">8.</span> <span class="toc-text">explain</span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95-%E4%BD%BF%E7%94%A8%E8%A7%84%E5%88%99"><span class="toc-number">9.</span> <span class="toc-text">索引-使用规则<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#trace%E5%88%86%E6%9E%90%E5%99%A8%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92"><span class="toc-number">10.</span> <span class="toc-text">trace<hanla></hanla>分析器执行计划<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8"><span class="toc-number">11.</span> <span class="toc-text">索引使用<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99"><span class="toc-number">12.</span> <span class="toc-text">索引设计原则<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#SQL%E4%BC%98%E5%8C%96"><span class="toc-number">13.</span> <span class="toc-text">SQL<hanla></hanla>优化<hanla></hanla></span></a>
                  <ol class="toc-child">
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%A7%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">13.1.</span> <span class="toc-text">大批量插入数据<hanla></hanla></span></a></li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E5%8C%96-Insert-%E8%AF%AD%E5%8F%A5"><span class="toc-number">13.2.</span> <span class="toc-text">优化 Insert 语句<hanla></hanla></span></a></li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E4%BC%98%E5%8C%96"><span class="toc-number">13.3.</span> <span class="toc-text">主键优化<hanla></hanla></span></a></li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E5%8C%96-order-by%E8%AF%AD%E5%8F%A5"><span class="toc-number">13.4.</span> <span class="toc-text">优化 order by<hanla></hanla>语句<hanla></hanla></span></a></li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E5%8C%96-group-by-%E8%AF%AD%E5%8F%A5"><span class="toc-number">13.5.</span> <span class="toc-text">优化 group by 语句<hanla></hanla></span></a></li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%E7%9A%84%E4%BC%98%E5%8C%96"><span class="toc-number">13.6.</span> <span class="toc-text">分页查询的优化<hanla></hanla></span></a></li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#count-%E4%BC%98%E5%8C%96"><span class="toc-number">13.7.</span> <span class="toc-text">count 优化<hanla></hanla></span></a></li>
                    <li class="toc-item toc-level-4"><a class="toc-link" href="#update-%E4%BC%98%E5%8C%96"><span class="toc-number">13.8.</span> <span class="toc-text">update 优化<hanla></hanla></span></a></li>
                  </ol>
                </li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE"><span class="toc-number">14.</span> <span class="toc-text">视图<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%81"><span class="toc-number">15.</span> <span class="toc-text">锁<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E5%8E%9F%E7%90%86"><span class="toc-number">16.</span> <span class="toc-text">事务原理<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">17.</span> <span class="toc-text">系统数据库<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97"><span class="toc-number">18.</span> <span class="toc-text">日志<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="toc-number">19.</span> <span class="toc-text">主从复制<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8"><span class="toc-number">20.</span> <span class="toc-text">分库分表<hanla></hanla></span></a></li>
                <li class="toc-item toc-level-3"><a class="toc-link" href="#MyCat"><span class="toc-number">21.</span> <span class="toc-text">MyCat</span></a></li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </main>
    <footer id="footer" style="background: transparent">
      <div id="footer-wrap">
        <div class="copyright">©2020 - 2023 By coder-itl</div>
        <div class="framework-info"><span>
            <hanla></hanla>框架
          </span><a target="_blank" rel="external nofollow noopener noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div>
        <div class="footer_custom_text">
          <p><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-orange">&nbsp;<img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Theme-Buffterfly-blue">&nbsp;<img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/CDN-jsDeliver-blueviolet">&nbsp;<img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Source-Github-9cf">&nbsp;<img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Theme-Matery-ff69b4">&nbsp;<img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Python-Python-success">&nbsp;<img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Python-Flask-red"></p>
          <p><img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-red?logo=Castorama&amp;logoWidth=18">&nbsp;<img src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?logo=Grunt&amp;logoWidth=18"></p>
        </div>
      </div>
    </footer>
  </div>
  <div id="rightside">
    <div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div>
    <div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div>
  </div>
  <div id="local-search">
    <div class="search-dialog">
      <nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav>
      <div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中<hanla></hanla></span></div>
      <div class="search-wrap">
        <div id="local-search-input">
          <div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div>
        </div>
        <hr>
        <div id="local-search-results"></div>
      </div>
    </div>
    <div id="search-mask"></div>
  </div>
  <div>
    <script src="/js/utils.js"></script>
    <script src="/js/main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script>
    <script src="/js/search/local-search.js"></script>
    <div class="js-pjax">
      <script>
        (() =>
        {
          const init = () =>
          {
            twikoo.init(Object.assign(
            {
              el: '#twikoo-wrap',
              envId: 'https://twikoo-jlw0ln3jv-coderitl.vercel.app/',
              region: 'ap-shanghai',
              onCommentLoaded: function ()
              {
                btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
              }
            }, null))
          }
          const getCount = () =>
          {
            const countELement = document.getElementById('twikoo-count')
            if (!countELement) return
            twikoo.getCommentsCount(
            {
              envId: 'https://twikoo-jlw0ln3jv-coderitl.vercel.app/',
              region: 'ap-shanghai',
              urls: [window.location.pathname],
              includeReply: false
            }).then(function (res)
            {
              countELement.innerText = res[0].count
            }).catch(function (err)
            {
              console.error(err);
            });
          }
          const runFn = () =>
          {
            init()
          }
          const loadTwikoo = () =>
          {
            if (typeof twikoo === 'object')
            {
              setTimeout(runFn, 0)
              return
            }
            getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
          }
          if ('Twikoo' === 'Twikoo' || !false)
          {
            if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
            else loadTwikoo()
          }
          else
          {
            window.loadOtherComment = () =>
            {
              loadTwikoo()
            }
          }
        })()

      </script>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script>
    <script defer="" src="https://cdn.jsdelivr.net/npm/hexo-theme-volantis@latest/source/js/issues.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>
    <script data-pjax="" src="https://cdn.jsdelivr.net/gh/coderitl/FileJsDeliver@v1.1.13/swiper/swiper.min.js"></script>
    <script data-pjax="" src="https://cdn.jsdelivr.net/gh/coderitl/FileJsDeliver@v1.1.13/swiper/swiperindex.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/graingert/wow@1.3.0/dist/wow.min.js"></script>
    <script src="https://www.youxiaohou.com/mactype.user.js"></script>
    <script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script>
    <script>
      let pjaxSelectors = ["head > title", "#config-diff", "#body-wrap", "#rightside-config-hide", "#rightside-config-show", ".js-pjax"]
      var pjax = new Pjax(
      {
        elements: 'a:not([target="_blank"])',
        selectors: pjaxSelectors,
        cacheBust: false,
        analytics: false,
        scrollRestoration: false
      })
      document.addEventListener('pjax:send', function ()
      {
        // removeEventListener scroll 
        window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
        window.scrollCollect && window.removeEventListener('scroll', scrollCollect)
        document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
        if (window.aplayers)
        {
          for (let i = 0; i < window.aplayers.length; i++)
          {
            if (!window.aplayers[i].options.fixed)
            {
              window.aplayers[i].destroy()
            }
          }
        }
        typeof typed === 'object' && typed.destroy()
        //reset readmode
        const $bodyClassList = document.body.classList
        $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
        typeof disqusjs === 'object' && disqusjs.destroy()
      })
      document.addEventListener('pjax:complete', function ()
      {
        window.refreshFn()
        document.querySelectorAll('script[data-pjax]').forEach(item =>
        {
          const newScript = document.createElement('script')
          const content = item.text || item.textContent || item.innerHTML || ""
          Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
          newScript.appendChild(document.createTextNode(content))
          item.parentNode.replaceChild(newScript, item)
        })
        GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()
        typeof chatBtnFn === 'function' && chatBtnFn()
        typeof panguInit === 'function' && panguInit()
        // google analytics
        typeof gtag === 'function' && gtag('config', '',
        {
          'page_path': window.location.pathname
        });
        // baidu analytics
        typeof _hmt === 'object' && _hmt.push(['_trackPageview', window.location.pathname]);
        typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
        // prismjs
        typeof Prism === 'object' && Prism.highlightAll()
      })
      document.addEventListener('pjax:error', (e) =>
      {
        if (e.request.status === 404)
        {
          pjax.loadUrl('/404.html')
        }
      })

    </script>
    <script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  </div><!-- hexo injector body_end start -->
  <script data-pjax="">
    function history_calendar_injector_config()
    {
      var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
      var item_html = '<div class="card-widget card-history"><div class="card-content"><div class="item-headline"><i class="fas fa-clock fa-spin"></i><span><hanla></hanla>那年今日<hanla></hanla></span></div><div id="history-baidu" style="height: 100px;overflow: hidden"><div class="history_swiper-container" id="history-container" style="width: 100%;height: 100%"><div class="swiper-wrapper" id="history_container_wrapper" style="height:20px"></div></div></div></div>';
      console.log('已挂载<hanla></hanla>history_calendar')
      // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用<hanla></hanla>(支持<hanla></hanla>pjax<hanla></hanla>跳转)
      parent_div_git.insertAdjacentHTML("afterbegin", item_html) // 有报错，但不影响使用<hanla></hanla>(支持<hanla></hanla>pjax<hanla></hanla>跳转)
    }
    if (document.getElementsByClassName('sticky_layout')[0] & amp; & amp;
      (location.pathname === 'all' || 'all' === 'all'))
    {
      history_calendar_injector_config()
    } < /div>

  </script>
  <script data-pjax="" src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
  <script data-pjax="" src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js"></script>
  <script data-pjax="">
    function butterfly_swiper_injector_config()
    {
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/08/13/15497.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/coderitl/Access@v1.0/medias/featureimages/7.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"></a><div class="blog-slider__content"><span class="blog-slider__code">2022-08-13</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/08/13/15497.html&quot;);" href="javascript:void(0);" alt=""><hanla></hanla>文件上传下载实战<hanla></hanla></a><div class="blog-slider__text"><hanla></hanla>再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/08/13/15497.html&quot;);" href="javascript:void(0);" alt=""><hanla></hanla>详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/09/04/27324.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/coderitl/Access@v1.0/medias/featureimages/8.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"></a><div class="blog-slider__content"><span class="blog-slider__code">2022-09-04</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/09/04/27324.html&quot;);" href="javascript:void(0);" alt="">Docker<hanla></hanla>安装<hanla></hanla>Oracle</a><div class="blog-slider__text"><hanla></hanla>再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/09/04/27324.html&quot;);" href="javascript:void(0);" alt=""><hanla></hanla>详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/11/30/42622.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://i.328888.xyz/2023/04/01/i2p4AN.jpeg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"></a><div class="blog-slider__content"><span class="blog-slider__code">2022-11-30</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/11/30/42622.html&quot;);" href="javascript:void(0);" alt="">SpringCloud</a><div class="blog-slider__text"><hanla></hanla>再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/11/30/42622.html&quot;);" href="javascript:void(0);" alt=""><hanla></hanla>详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;2022/12/29/2485.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "https://i.328888.xyz/2023/03/20/P3kfC.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/coderitl/Access@v1.0/medias/featureimages/2.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"></a><div class="blog-slider__content"><span class="blog-slider__code">2022-12-29</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;2022/12/29/2485.html&quot;);" href="javascript:void(0);" alt="">Ubuntu-系统<hanla></hanla></a><div class="blog-slider__text"><hanla></hanla>再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;2022/12/29/2485.html&quot;);" href="javascript:void(0);" alt=""><hanla></hanla>详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
      console.log('已挂载<hanla></hanla>butterfly_swiper')
      parent_div_git.insertAdjacentHTML("afterbegin", item_html)
    }
    var elist = 'undefined'.split(',');
    var cpage = location.pathname;
    var epage = 'all';
    var flag = 0;
    for (var i = 0; i

  </script>
  <script defer="" src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script>
  <script defer="" data-pjax="" src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script>
  <script data-pjax="" src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script>
  <script data-pjax="">
    function gitcalendar_injector_config()
    {
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 280px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin", item_html)
      console.log('已挂载<hanla></hanla>gitcalendar')
    }
    if (document.getElementById('recent-posts') && (location.pathname === '/' || '/' === 'all'))
    {
      gitcalendar_injector_config()
      GitCalendarInit("https://python-github-calenda-4cx5gxbnc-coderitl.vercel.app/api?coderitl", ['#e4dfd7', '#f9f4dc', '#f7e8aa', '#f7e8aa', '#f8df72', '#fcd217', '#fcc515', '#f28e16', '#fb8b05', '#d85916', '#f43e06'], 'coderitl')
    }

  </script>
  <script async="" src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end -->
  <script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script>
  <script>
    L2Dwidget.init(
    {
      "pluginModelPath": "assets/",
      "model":
      {
        "jsonPath": "/live2dw/assets/shizuku.model.json"
      },
      "display":
      {
        "position": "left",
        "width": 150,
        "height": 300
      },
      "mobile":
      {
        "show": false
      },
      "rect":
      {
        "opacity": 0.7
      },
      "log": false,
      "pluginJsPath": "lib/",
      "pluginRootPath": "live2dw/",
      "tagMode": false
    });

  </script>



</body></html>